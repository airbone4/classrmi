[
["section-8.html", "Chapter 8 基本繪圖 8.1 reference 8.2 basic 8.3 多個圖和疊圖 8.4 分組畫圖 8.5 Add texts within the graph 8.6 函數畫圖 8.7 plot example", " Chapter 8 基本繪圖 8.1 reference Quric R 一般視窗作業系統的繪圖，會有一個抽象物件device在這個device上，有一個抽象物件canvas，和繪圖工具例如，水彩筆之類的抽象物件可以指定顏色，線條粗細等等。 8.2 basic 基本繪圖函數，plot(),hist() ㊙️ 怎樣快速查詢？ ??draw ?plot : 參考其中的plot.default 查看圖形選項 8.2.1 plot 可能最常用的繪圖函數就是plot(),而這個函數比較常用的選項有： * type: 僅分佈點（預設）是否連線等基本模板。 * lty: 線條樣式line style * lwd: 線條寬度line width * col: * pch: mark type description p points l lines o overplotted points and lines b, c points (empty if “c”) joined by lines s, S stair steps h histogram-like vertical lines n does not produce any points or lines 繪製向量 中的資料 x &lt;- c(1,3,4,7,8,9) y &lt;- c(0,3,6,9,7,8) plot(x,y,main=&#39;plot(x,y)&#39;) 繪製data.frame 中的資料 plot(mtcars$wt, mtcars$mpg) abline(lm(mtcars$mpg~mtcars$wt)) title(&quot;Regression of MPG on Weight&quot;) attach(mtcars) plot(wt, mpg) abline(lm(mpg~wt)) title(&quot;Regression of MPG on Weight&quot;) plot()函數，新建視窗然後畫出 weight vs. miles per gallon. abline() 不會開啟新視窗做圖，abline()的語法如下: abline(a = NULL, b = NULL, h = NULL, v = NULL, reg = NULL,coef = NULL, untf = FALSE, …) 代表的意思是畫出一條直線a+bx ，其中a代表截距常數，b則是斜率常數。例如 Y=2X+1，則對應的函數為 abline(a=1,b=2) 。 plot(sin, -pi, 2*pi) 8.2.2 更多 require(stats) # for lowess, rpois, rnorm plot(cars) lines(lowess(cars)) 8.2.3 Histograms 函數hist(x)：其中 x是一個數字向量， 選項freq=FALSE 則是畫出 probability densities 而不是次數 frequencies. 選項：breaks= ## 則是控制分成幾份。 Simple Histogram hist(mtcars$mpg) 分成12份，顏色紅色。 hist(mtcars$mpg, breaks=12, col=&quot;red&quot;) 自行給定分割點 hist(mtcars$mpg, breaks=c(4,5,12,50), col=&quot;red&quot;) 8.2.3.1 Add a Normal Curve x &lt;- mtcars$mpg h&lt;-hist(x, breaks=10, col=&quot;red&quot;, xlab=&quot;Miles Per Gallon&quot;, main=&quot;Histogram with Normal Curve&quot;) xfit&lt;-seq(min(x),max(x),length=40) yfit&lt;-dnorm(xfit,mean=mean(x),sd=sd(x)) yfit &lt;- yfit*diff(h$mids[1:2])*length(x) lines(xfit, yfit, col=&quot;blue&quot;, lwd=2) hint: 因為\\(pdf=\\frac{\\frac{n}{N}}{bin \\quad width}\\) 所以\\(n=pdf\\times N \\times (bin \\quad width)\\) Histograms can be a poor method for determining the shape of a distribution because it is so strongly affected by the number of bins used. h $breaks [1] 10 12 14 16 18 20 22 24 26 28 30 32 34 $counts [1] 2 1 7 3 5 5 2 2 1 0 2 2 $density [1] 0.0312 0.0156 0.1094 0.0469 0.0781 0.0781 0.0312 0.0312 0.0156 0.0000 [11] 0.0312 0.0312 $mids [1] 11 13 15 17 19 21 23 25 27 29 31 33 $xname [1] \"x\" $equidist [1] TRUE attr(,\"class\") [1] \"histogram\" 8.2.4 Kernel Density Plot 核密度畫圖(Kernal density plots) 用來觀察一個變量，比較有有效率，指令如：plot(density(x)) 其中x 是一個數字向量。 d &lt;- density(mtcars$mpg) # returns the density data plot(d) # plots the results 8.2.4.1 Filled Density Plot d &lt;- density(mtcars$mpg) plot(d, main=&quot;Kernel Density of Miles Per Gallon&quot;) polygon(d, col=&quot;red&quot;, border=&quot;blue&quot;) 8.2.5 Saving Graphs 可以利用menu存檔，例如File -&gt; Save As. 也可以利用函數： Function Output to pdf(“mygraph.pdf”) pdf file win.metafile(“mygraph.wmf”) windows metafile png(“mygraph.png”) png file jpeg(“mygraph.jpg”) jpeg file bmp(“mygraph.bmp”) bmp file postscript(“mygraph.ps”) postscript file 8.3 多個圖和疊圖 傻瓜指令例如 (plot, hist, boxplot, etc.)基本上會開啟新視窗，然後畫圖。這裡討論幾種自行控制的方法： 多視窗(multiple windows)、覆圖(combining figure) 和疊圖(overlay)討論。 8.3.1 多視窗 開多視窗的方法根據OS而不同，如下： Function Platform windows() Windows X11() Unix quartz() Mac 要關閉視窗，可以用函數dev.off() 如果要知道目前的視窗是那一個，可以參考 dev.cur()。 Note: 如果目前有多個圖窗，則一直呼叫這個函數dev.off()，會依次關閉視窗，直到函數傳回NULL。 驗證上面的說法可以利用 hist(mtcars$mpg) dev.cur() png 2 hist(mtcars$mpg) dev.cur() png 2 上面的範例，可以看到圖裝置的編號都是2，也就是多個圖在一個device上。。 hist(mtcars$mpg) dev.cur() png 2 hist(mtcars$mpg) dev.cur() png 2 dev.off() null device 1 討論下面的輸出結果，我只看到一個視窗： hint: 無法在rmarkdown 執行？確認，在rscript中執行正常。 X11() hist(mtcars$mpg) dev.cur() X11() hist(mtcars$mpg) dev.cur() 測試 dev.new() plot(1:1) dev.new() plot(2,2) dev.set(dev.prev()) # go back to first title(main=&quot;test dev 1&quot;) dev.set(dev.next()) # go to second title(main=&quot;test dev 2&quot;) 8.3.2 合併 Plots 同時顯示多個plot的結果，可以利用函數par() or layout( )。 函數par( )的選項有： mfrow=c(nrows, ncols) 填plot的方向為橫行。 mfcol=c(nrows, ncols) 填入的方向為直行。 變數&lt;-par() 會把目前的參數拿出存到變數。本來是要在設定完新參數以後，在放回去，但是，有些參數是無法修改的，因此不要紀錄了（直接英翻中，不要唯獨＝確定（T） #### par() about par() ✔️範例: 線條形式type的幾種基本類型 範例 #attach(mtcars) par(mfrow=c(2,2)) plot(wt,mpg, main=&quot;Scatterplot of wt vs. mpg&quot;) plot(wt,disp, main=&quot;Scatterplot of wt vs disp&quot;) hist(wt, main=&quot;Histogram of wt&quot;) boxplot(wt, main=&quot;Boxplot of wt&quot;) 1x3 layout # attach(mtcars) par(mfrow=c(1,3)) hist(wt) hist(mpg) hist(disp) #dev.off() note: par(mar) 列出margin par(mar=c(1,1,1,1)) 更動margin plot.new()常發生的錯誤 : figure margins too large 有兩個原因：1 是畫布過小 2，當前畫布的上下左右距離過大 這裡看看如何解第二個發生原因 默認的畫布上邊款的距離為： 預設為 c(5, 4, 4, 2) + 0.1. 對應 c(bottom, left, top, right)，也就是順時針，由下到右結束一圈。 我們可以將其設置為0，同時將目前的設定紀錄，後面程式的第一行 op &lt;- par(mar = rep(0, 4)) # op 會紀錄之前的margin = 5.1 4.1 4.1 2.1 plot.new() # 畫圖 par(op) # 改回原先的margin 是不是有需要寫個新函數，用來重設裝置參數？ 下面這個函數resetPar()重新設定device: 主要試看這一行:par(no.readonly = TRUE)。 意思是說，不要紀錄 readonly的設定。 resetPar &lt;- function() { dev.new() #重新開始一個裝置 op &lt;- par(no.readonly = TRUE)#因為是新的，所以裡面的設定都是預設值 dev.off()# 只是把之前的新裝置關掉 op # 傳回預設值 } 其他用法 par() # view current settings opar &lt;- par() # make a copy of current settings par(col.lab=“red”) # red x and y labels hist(mtcars$mpg) # create a plot with these new settings par(opar) # restore original settings 更多的圖形控制: 在散佈圖中加入boxplot par(mar=rep(2,4)) # 整個圖的座標，想成左下角(0,0)右上角(1,1) par(fig=c(0,0.8,0,0.8))#左下(0,0)右上(0.8,0.8) #左下(x1,y1)右上(x2,y2) =&gt; c(x1,x2,y1,y2) plot(mtcars$wt, mtcars$mpg, xlab=&quot;Car Weight&quot;, ylab=&quot;Miles Per Gallon&quot;) par(fig=c(0,0.8,0.55,1), new=TRUE) boxplot(mtcars$wt, horizontal=TRUE, axes=FALSE) par(fig=c(0.65,1,0,0.8),new=TRUE) boxplot(mtcars$mpg, axes=FALSE) mtext(&quot;Enhanced Scatterplot&quot;, side=3, outer=TRUE, line=-3) 練習1 讓下面兩個圖不重疊 r boxplot(mtcars$wt, axes=FALSE) par(new=TRUE) boxplot(mtcars$mpg, axes=FALSE) 練習2 讓disp,mpg 的histogram 疊在一起: 練習3 測試這篇文章 8.3.2.1 layout() 函數 layout( ) 的使用方法為 layout(mat) 其中 mat 的元素用來指定圖形號碼。例如分成4個格子,順序為左右上下(byrow=TRUE) 如layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) 對應如下表 | 1 | 1 | |—|—| | 2 | 3 | # One figure in row 1 and two figures in row 2 #attach(mtcars) layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) hist(wt) hist(mpg) hist(disp) #dev.off() 在layout()函數中，也可以更改圖形大小，其參數 為： widths= 數字向量，用來代表column 寬度 heights= 數字向量，用來代表row 高度 note:Relative widths are specified with numeric values. Absolute widths (in centimetres) are specified with the lcm() function. 8.3.3 疊圖 有些繪圖指令的選項，可以利用add=T。 💥 plot指令不支援add=T curve( dnorm(x,0,1), -5 , 5, lwd=1, lty=1) curve( dnorm(x,0,2),add=TRUE, lwd=2, lty=2) curve( dnorm(x,0,3) , add=TRUE, lwd=3, lty=3) # Add the legend legend( &quot;topright&quot;,c(&quot;sigma=1&quot;,&quot;sigma=2&quot;,&quot;sigma=3&quot;) , lwd=1:3, lty=1:3) 8.4 分組畫圖 8.4.1 Comparing Groups VIA Kernal Density The sm.density.compare( ) function in the sm package allows you to superimpose the kernal density plots of two or more groups. The format is sm.density.compare(x, factor) where x is a numeric vector and factor is the grouping variable. 8.4.1.1 Compare MPG distributions for cars with 4,6, or 8 cylinders library(sm) attach(mtcars) #create value labels cyl.f &lt;- factor(cyl, levels= c(4,6,8), labels = c(&quot;4 cylinder&quot;, &quot;6 cylinder&quot;, &quot;8 cylinder&quot;)) #plot densities sm.density.compare(mpg, cyl, xlab=&quot;Miles Per Gallon&quot;) title(main=&quot;MPG Distribution by Car Cylinders&quot;) #add legend via mouse click colfill&lt;-c(2:(2+length(levels(cyl.f)))) legend(locator(1), levels(cyl.f), fill=colfill) 8.5 Add texts within the graph 8.5.1 Add text in the margins of the graph 8.5.2 Add mathematical annotation to a plot 8.6 函數畫圖 8.7 plot example "]
]
