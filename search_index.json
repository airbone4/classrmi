[
["section-8.html", "Chapter 8 åŸºæœ¬ç¹ªåœ– 8.1 reference 8.2 basic 8.3 å¤šå€‹åœ–å’Œç–Šåœ– 8.4 åˆ†çµ„ç•«åœ– 8.5 Add texts within the graph 8.6 å‡½æ•¸ç•«åœ– 8.7 plot example", " Chapter 8 åŸºæœ¬ç¹ªåœ– 8.1 reference Quric R ä¸€èˆ¬è¦–çª—ä½œæ¥­ç³»çµ±çš„ç¹ªåœ–ï¼Œæœƒæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶deviceåœ¨é€™å€‹deviceä¸Šï¼Œæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶canvasï¼Œå’Œç¹ªåœ–å·¥å…·ä¾‹å¦‚ï¼Œæ°´å½©ç­†ä¹‹é¡çš„æŠ½è±¡ç‰©ä»¶å¯ä»¥æŒ‡å®šé¡è‰²ï¼Œç·šæ¢ç²—ç´°ç­‰ç­‰ã€‚ 8.2 basic åŸºæœ¬ç¹ªåœ–å‡½æ•¸ï¼Œplot(),hist() ãŠ™ï¸ æ€æ¨£å¿«é€ŸæŸ¥è©¢ï¼Ÿ ??draw ?plot : åƒè€ƒå…¶ä¸­çš„plot.default æŸ¥çœ‹åœ–å½¢é¸é … 8.2.1 plot å¯èƒ½æœ€å¸¸ç”¨çš„ç¹ªåœ–å‡½æ•¸å°±æ˜¯plot(),è€Œé€™å€‹å‡½æ•¸æ¯”è¼ƒå¸¸ç”¨çš„é¸é …æœ‰ï¼š * type: åƒ…åˆ†ä½ˆé»ï¼ˆé è¨­ï¼‰æ˜¯å¦é€£ç·šç­‰åŸºæœ¬æ¨¡æ¿ã€‚ * lty: ç·šæ¢æ¨£å¼line style * lwd: ç·šæ¢å¯¬åº¦line width * col: * pch: mark type description p points l lines o overplotted points and lines b, c points (empty if â€œcâ€) joined by lines s, S stair steps h histogram-like vertical lines n does not produce any points or lines ç¹ªè£½å‘é‡ ä¸­çš„è³‡æ–™ x &lt;- c(1,3,4,7,8,9) y &lt;- c(0,3,6,9,7,8) plot(x,y,main=&#39;plot(x,y)&#39;) ç¹ªè£½data.frame ä¸­çš„è³‡æ–™ plot(mtcars$wt, mtcars$mpg) abline(lm(mtcars$mpg~mtcars$wt)) title(&quot;Regression of MPG on Weight&quot;) attach(mtcars) plot(wt, mpg) abline(lm(mpg~wt)) title(&quot;Regression of MPG on Weight&quot;) plot()å‡½æ•¸ï¼Œæ–°å»ºè¦–çª—ç„¶å¾Œç•«å‡º weight vs.Â miles per gallon. abline() ä¸æœƒé–‹å•Ÿæ–°è¦–çª—åšåœ–ï¼Œabline()çš„èªæ³•å¦‚ä¸‹: abline(a = NULL, b = NULL, h = NULL, v = NULL, reg = NULL,coef = NULL, untf = FALSE, â€¦) ä»£è¡¨çš„æ„æ€æ˜¯ç•«å‡ºä¸€æ¢ç›´ç·ša+bx ï¼Œå…¶ä¸­aä»£è¡¨æˆªè·å¸¸æ•¸ï¼Œbå‰‡æ˜¯æ–œç‡å¸¸æ•¸ã€‚ä¾‹å¦‚ Y=2X+1ï¼Œå‰‡å°æ‡‰çš„å‡½æ•¸ç‚º abline(a=1,b=2) ã€‚ plot(sin, -pi, 2*pi) 8.2.2 æ›´å¤š require(stats) # for lowess, rpois, rnorm plot(cars) lines(lowess(cars)) 8.2.3 Histograms å‡½æ•¸hist(x)ï¼šå…¶ä¸­ xæ˜¯ä¸€å€‹æ•¸å­—å‘é‡ï¼Œ é¸é …freq=FALSE å‰‡æ˜¯ç•«å‡º probability densities è€Œä¸æ˜¯æ¬¡æ•¸ frequencies. é¸é …ï¼šbreaks= ## å‰‡æ˜¯æ§åˆ¶åˆ†æˆå¹¾ä»½ã€‚ Simple Histogram hist(mtcars$mpg) åˆ†æˆ12ä»½ï¼Œé¡è‰²ç´…è‰²ã€‚ hist(mtcars$mpg, breaks=12, col=&quot;red&quot;) è‡ªè¡Œçµ¦å®šåˆ†å‰²é» hist(mtcars$mpg, breaks=c(4,5,12,50), col=&quot;red&quot;) 8.2.3.1 Add a Normal Curve x &lt;- mtcars$mpg h&lt;-hist(x, breaks=10, col=&quot;red&quot;, xlab=&quot;Miles Per Gallon&quot;, main=&quot;Histogram with Normal Curve&quot;) xfit&lt;-seq(min(x),max(x),length=40) yfit&lt;-dnorm(xfit,mean=mean(x),sd=sd(x)) yfit &lt;- yfit*diff(h$mids[1:2])*length(x) lines(xfit, yfit, col=&quot;blue&quot;, lwd=2) hint: å› ç‚º\\(pdf=\\frac{\\frac{n}{N}}{bin \\quad width}\\) æ‰€ä»¥\\(n=pdf\\times N \\times (bin \\quad width)\\) Histograms can be a poor method for determining the shape of a distribution because it is so strongly affected by the number of bins used. h $breaks [1] 10 12 14 16 18 20 22 24 26 28 30 32 34 $counts [1] 2 1 7 3 5 5 2 2 1 0 2 2 $density [1] 0.0312 0.0156 0.1094 0.0469 0.0781 0.0781 0.0312 0.0312 0.0156 0.0000 [11] 0.0312 0.0312 $mids [1] 11 13 15 17 19 21 23 25 27 29 31 33 $xname [1] \"x\" $equidist [1] TRUE attr(,\"class\") [1] \"histogram\" 8.2.4 Kernel Density Plot æ ¸å¯†åº¦ç•«åœ–(Kernal density plots) ç”¨ä¾†è§€å¯Ÿä¸€å€‹è®Šé‡ï¼Œæ¯”è¼ƒæœ‰æœ‰æ•ˆç‡ï¼ŒæŒ‡ä»¤å¦‚ï¼šplot(density(x)) å…¶ä¸­x æ˜¯ä¸€å€‹æ•¸å­—å‘é‡ã€‚ d &lt;- density(mtcars$mpg) # returns the density data plot(d) # plots the results 8.2.4.1 Filled Density Plot d &lt;- density(mtcars$mpg) plot(d, main=&quot;Kernel Density of Miles Per Gallon&quot;) polygon(d, col=&quot;red&quot;, border=&quot;blue&quot;) 8.2.5 Saving Graphs å¯ä»¥åˆ©ç”¨menuå­˜æª”ï¼Œä¾‹å¦‚File -&gt; Save As. ä¹Ÿå¯ä»¥åˆ©ç”¨å‡½æ•¸ï¼š Function Output to pdf(â€œmygraph.pdfâ€) pdf file win.metafile(â€œmygraph.wmfâ€) windows metafile png(â€œmygraph.pngâ€) png file jpeg(â€œmygraph.jpgâ€) jpeg file bmp(â€œmygraph.bmpâ€) bmp file postscript(â€œmygraph.psâ€) postscript file 8.3 å¤šå€‹åœ–å’Œç–Šåœ– å‚»ç“œæŒ‡ä»¤ä¾‹å¦‚ (plot, hist, boxplot, etc.)åŸºæœ¬ä¸Šæœƒé–‹å•Ÿæ–°è¦–çª—ï¼Œç„¶å¾Œç•«åœ–ã€‚é€™è£¡è¨è«–å¹¾ç¨®è‡ªè¡Œæ§åˆ¶çš„æ–¹æ³•ï¼š å¤šè¦–çª—(multiple windows)ã€è¦†åœ–(combining figure) å’Œç–Šåœ–(overlay)è¨è«–ã€‚ 8.3.1 å¤šè¦–çª— é–‹å¤šè¦–çª—çš„æ–¹æ³•æ ¹æ“šOSè€Œä¸åŒï¼Œå¦‚ä¸‹ï¼š Function Platform windows() Windows X11() Unix quartz() Mac è¦é—œé–‰è¦–çª—ï¼Œå¯ä»¥ç”¨å‡½æ•¸dev.off() å¦‚æœè¦çŸ¥é“ç›®å‰çš„è¦–çª—æ˜¯é‚£ä¸€å€‹ï¼Œå¯ä»¥åƒè€ƒ dev.cur()ã€‚ Note: å¦‚æœç›®å‰æœ‰å¤šå€‹åœ–çª—ï¼Œå‰‡ä¸€ç›´å‘¼å«é€™å€‹å‡½æ•¸dev.off()ï¼Œæœƒä¾æ¬¡é—œé–‰è¦–çª—ï¼Œç›´åˆ°å‡½æ•¸å‚³å›NULLã€‚ é©—è­‰ä¸Šé¢çš„èªªæ³•å¯ä»¥åˆ©ç”¨ hist(mtcars$mpg) dev.cur() png 2 hist(mtcars$mpg) dev.cur() png 2 ä¸Šé¢çš„ç¯„ä¾‹ï¼Œå¯ä»¥çœ‹åˆ°åœ–è£ç½®çš„ç·¨è™Ÿéƒ½æ˜¯2ï¼Œä¹Ÿå°±æ˜¯å¤šå€‹åœ–åœ¨ä¸€å€‹deviceä¸Šã€‚ã€‚ hist(mtcars$mpg) dev.cur() png 2 hist(mtcars$mpg) dev.cur() png 2 dev.off() null device 1 è¨è«–ä¸‹é¢çš„è¼¸å‡ºçµæœï¼Œæˆ‘åªçœ‹åˆ°ä¸€å€‹è¦–çª—ï¼š hint: ç„¡æ³•åœ¨rmarkdown åŸ·è¡Œï¼Ÿç¢ºèªï¼Œåœ¨rscriptä¸­åŸ·è¡Œæ­£å¸¸ã€‚ X11() hist(mtcars$mpg) dev.cur() X11() hist(mtcars$mpg) dev.cur() æ¸¬è©¦ dev.new() plot(1:1) dev.new() plot(2,2) dev.set(dev.prev()) # go back to first title(main=&quot;test dev 1&quot;) dev.set(dev.next()) # go to second title(main=&quot;test dev 2&quot;) 8.3.2 åˆä½µ Plots åŒæ™‚é¡¯ç¤ºå¤šå€‹plotçš„çµæœï¼Œå¯ä»¥åˆ©ç”¨å‡½æ•¸par() or layout( )ã€‚ å‡½æ•¸par( )çš„é¸é …æœ‰ï¼š mfrow=c(nrows, ncols) å¡«plotçš„æ–¹å‘ç‚ºæ©«è¡Œã€‚ mfcol=c(nrows, ncols) å¡«å…¥çš„æ–¹å‘ç‚ºç›´è¡Œã€‚ è®Šæ•¸&lt;-par() æœƒæŠŠç›®å‰çš„åƒæ•¸æ‹¿å‡ºå­˜åˆ°è®Šæ•¸ã€‚æœ¬ä¾†æ˜¯è¦åœ¨è¨­å®šå®Œæ–°åƒæ•¸ä»¥å¾Œï¼Œåœ¨æ”¾å›å»ï¼Œä½†æ˜¯ï¼Œæœ‰äº›åƒæ•¸æ˜¯ç„¡æ³•ä¿®æ”¹çš„ï¼Œå› æ­¤ä¸è¦ç´€éŒ„äº†ï¼ˆç›´æ¥è‹±ç¿»ä¸­ï¼Œä¸è¦å”¯ç¨ï¼ç¢ºå®šï¼ˆTï¼‰ #### par() about par() âœ”ï¸ç¯„ä¾‹: ç·šæ¢å½¢å¼typeçš„å¹¾ç¨®åŸºæœ¬é¡å‹ ç¯„ä¾‹ #attach(mtcars) par(mfrow=c(2,2)) plot(wt,mpg, main=&quot;Scatterplot of wt vs. mpg&quot;) plot(wt,disp, main=&quot;Scatterplot of wt vs disp&quot;) hist(wt, main=&quot;Histogram of wt&quot;) boxplot(wt, main=&quot;Boxplot of wt&quot;) 1x3 layout # attach(mtcars) par(mfrow=c(1,3)) hist(wt) hist(mpg) hist(disp) #dev.off() note: par(mar) åˆ—å‡ºmargin par(mar=c(1,1,1,1)) æ›´å‹•margin plot.new()å¸¸ç™¼ç”Ÿçš„éŒ¯èª¤ : figure margins too large æœ‰å…©å€‹åŸå› ï¼š1 æ˜¯ç•«å¸ƒéå° 2ï¼Œç•¶å‰ç•«å¸ƒçš„ä¸Šä¸‹å·¦å³è·é›¢éå¤§ é€™è£¡çœ‹çœ‹å¦‚ä½•è§£ç¬¬äºŒå€‹ç™¼ç”ŸåŸå›  é»˜èªçš„ç•«å¸ƒä¸Šé‚Šæ¬¾çš„è·é›¢ç‚ºï¼š é è¨­ç‚º c(5, 4, 4, 2) + 0.1. å°æ‡‰ c(bottom, left, top, right)ï¼Œä¹Ÿå°±æ˜¯é †æ™‚é‡ï¼Œç”±ä¸‹åˆ°å³çµæŸä¸€åœˆã€‚ æˆ‘å€‘å¯ä»¥å°‡å…¶è¨­ç½®ç‚º0ï¼ŒåŒæ™‚å°‡ç›®å‰çš„è¨­å®šç´€éŒ„ï¼Œå¾Œé¢ç¨‹å¼çš„ç¬¬ä¸€è¡Œ op &lt;- par(mar = rep(0, 4)) # op æœƒç´€éŒ„ä¹‹å‰çš„margin = 5.1 4.1 4.1 2.1 plot.new() # ç•«åœ– par(op) # æ”¹å›åŸå…ˆçš„margin æ˜¯ä¸æ˜¯æœ‰éœ€è¦å¯«å€‹æ–°å‡½æ•¸ï¼Œç”¨ä¾†é‡è¨­è£ç½®åƒæ•¸ï¼Ÿ ä¸‹é¢é€™å€‹å‡½æ•¸resetPar()é‡æ–°è¨­å®šdevice: ä¸»è¦è©¦çœ‹é€™ä¸€è¡Œ:par(no.readonly = TRUE)ã€‚ æ„æ€æ˜¯èªªï¼Œä¸è¦ç´€éŒ„ readonlyçš„è¨­å®šã€‚ resetPar &lt;- function() { dev.new() #é‡æ–°é–‹å§‹ä¸€å€‹è£ç½® op &lt;- par(no.readonly = TRUE)#å› ç‚ºæ˜¯æ–°çš„ï¼Œæ‰€ä»¥è£¡é¢çš„è¨­å®šéƒ½æ˜¯é è¨­å€¼ dev.off()# åªæ˜¯æŠŠä¹‹å‰çš„æ–°è£ç½®é—œæ‰ op # å‚³å›é è¨­å€¼ } å…¶ä»–ç”¨æ³• par() # view current settings opar &lt;- par() # make a copy of current settings par(col.lab=â€œredâ€) # red x and y labels hist(mtcars$mpg) # create a plot with these new settings par(opar) # restore original settings æ›´å¤šçš„åœ–å½¢æ§åˆ¶: åœ¨æ•£ä½ˆåœ–ä¸­åŠ å…¥boxplot par(mar=rep(2,4)) # æ•´å€‹åœ–çš„åº§æ¨™ï¼Œæƒ³æˆå·¦ä¸‹è§’(0,0)å³ä¸Šè§’(1,1) par(fig=c(0,0.8,0,0.8))#å·¦ä¸‹(0,0)å³ä¸Š(0.8,0.8) #å·¦ä¸‹(x1,y1)å³ä¸Š(x2,y2) =&gt; c(x1,x2,y1,y2) plot(mtcars$wt, mtcars$mpg, xlab=&quot;Car Weight&quot;, ylab=&quot;Miles Per Gallon&quot;) par(fig=c(0,0.8,0.55,1), new=TRUE) boxplot(mtcars$wt, horizontal=TRUE, axes=FALSE) par(fig=c(0.65,1,0,0.8),new=TRUE) boxplot(mtcars$mpg, axes=FALSE) mtext(&quot;Enhanced Scatterplot&quot;, side=3, outer=TRUE, line=-3) ç·´ç¿’1 è®“ä¸‹é¢å…©å€‹åœ–ä¸é‡ç–Š r boxplot(mtcars$wt, axes=FALSE) par(new=TRUE) boxplot(mtcars$mpg, axes=FALSE) ç·´ç¿’2 è®“disp,mpg çš„histogram ç–Šåœ¨ä¸€èµ·: ç·´ç¿’3 æ¸¬è©¦é€™ç¯‡æ–‡ç«  8.3.2.1 layout() å‡½æ•¸ layout( ) çš„ä½¿ç”¨æ–¹æ³•ç‚º layout(mat) å…¶ä¸­ mat çš„å…ƒç´ ç”¨ä¾†æŒ‡å®šåœ–å½¢è™Ÿç¢¼ã€‚ä¾‹å¦‚åˆ†æˆ4å€‹æ ¼å­,é †åºç‚ºå·¦å³ä¸Šä¸‹(byrow=TRUE) å¦‚layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) å°æ‡‰å¦‚ä¸‹è¡¨ | 1 | 1 | |â€”|â€”| | 2 | 3 | # One figure in row 1 and two figures in row 2 #attach(mtcars) layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) hist(wt) hist(mpg) hist(disp) #dev.off() åœ¨layout()å‡½æ•¸ä¸­ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹åœ–å½¢å¤§å°ï¼Œå…¶åƒæ•¸ ç‚ºï¼š widths= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨column å¯¬åº¦ heights= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨row é«˜åº¦ note:Relative widths are specified with numeric values. Absolute widths (in centimetres) are specified with the lcm() function. 8.3.3 ç–Šåœ– æœ‰äº›ç¹ªåœ–æŒ‡ä»¤çš„é¸é …ï¼Œå¯ä»¥åˆ©ç”¨add=Tã€‚ ğŸ’¥ plotæŒ‡ä»¤ä¸æ”¯æ´add=T curve( dnorm(x,0,1), -5 , 5, lwd=1, lty=1) curve( dnorm(x,0,2),add=TRUE, lwd=2, lty=2) curve( dnorm(x,0,3) , add=TRUE, lwd=3, lty=3) # Add the legend legend( &quot;topright&quot;,c(&quot;sigma=1&quot;,&quot;sigma=2&quot;,&quot;sigma=3&quot;) , lwd=1:3, lty=1:3) 8.4 åˆ†çµ„ç•«åœ– 8.4.1 Comparing Groups VIA Kernal Density The sm.density.compare( ) function in the sm package allows you to superimpose the kernal density plots of two or more groups. The format is sm.density.compare(x, factor) where x is a numeric vector and factor is the grouping variable. 8.4.1.1 Compare MPG distributions for cars with 4,6, or 8 cylinders library(sm) attach(mtcars) #create value labels cyl.f &lt;- factor(cyl, levels= c(4,6,8), labels = c(&quot;4 cylinder&quot;, &quot;6 cylinder&quot;, &quot;8 cylinder&quot;)) #plot densities sm.density.compare(mpg, cyl, xlab=&quot;Miles Per Gallon&quot;) title(main=&quot;MPG Distribution by Car Cylinders&quot;) #add legend via mouse click colfill&lt;-c(2:(2+length(levels(cyl.f)))) legend(locator(1), levels(cyl.f), fill=colfill) 8.5 Add texts within the graph 8.5.1 Add text in the margins of the graph 8.5.2 Add mathematical annotation to a plot 8.6 å‡½æ•¸ç•«åœ– 8.7 plot example "]
]
