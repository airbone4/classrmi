[
["index.html", "test for class Chapter 1 ç°¡ä»‹ 1.1 ç¶²è·¯è³‡æº 1.2 å®‰è£è»Ÿé«” 1.3 quick view 1.4 å¹¾å€‹å¸¸ç”¨çš„çµ±è¨ˆé‡: 1.5 è³‡æ–™å‹æ…‹å’Œå…§å®¹ 1.6 assignment", " test for class lend jwj cen 2020-10-08 Chapter 1 ç°¡ä»‹ ç´€éŒ„é€™å€‹å¾ˆé›£è¨˜çš„èªè¨€ ç„¡é—œç´€éŒ„ å…ˆå‰çš„è¨­å®štango æ¸¬è©¦ç´€éŒ„,ç°¡å–®æè¦,å„ç¨®å…¶ä»–æ–‡ç« è¤‡è£½åƒè€ƒ 1.1 ç¶²è·¯è³‡æº å¯ä»¥åƒè€ƒ rmd cheat sheet gitbook pimp my rmd ENDMEMO R Package Primer s3 1.2 å®‰è£è»Ÿé«” éƒ¨ä»½è»Ÿé«”åˆ—è¡¨ å¦å¤–æ–¼linux å®‰è£ tidyverseæ™‚éœ€è¦: sudo apt-get install -y libxml2-dev libcurl4-openssl-dev libssl-dev install.packages() # sudo visudo # ç„¶å¾ŒåŠ å…¥ # username ALL = NOPASSWD: /fullpath/to/command, /fullpath/to/othercommand # ä¸‹é¢é€™å€‹system éœ€è¦ä¸Šé¢å…©è¡Œ system(&#39;sudo apt update;sudo apt upgrade;sudo apt-get install curl&#39;) system(&#39;sudo apt-get install -y libxml2-dev libcurl4-openssl-dev libssl-dev&#39;) install.packages(&#39;devtools&#39;) install.packages(&#39;bookdown&#39;) install.packages(&#39;rlang&#39;) install.packages(&#39;tidyr&#39;) install.packages(&#39;babynames&#39;) install.packages(&#39;ggplot2&#39;) install.packages(&#39;sm&#39;) install.packages(&#39;bindrcpp&#39;) install.packages(&#39;tidyverse&#39;) install.packages(&#39;codetools&#39;) install.packages(&#39;moments&#39;) library(&#39;devtools&#39;) install_github(&quot;Hadley/emo&quot;) ## options(repos = c(CRAN = &quot;https://cran.revolutionanalytics.com&quot;)) 1.2.1 è‡ªå‹•update package update.packages(ask=FALSE) ä¹Ÿå¯ä»¥ï¼Ÿ all.packages &lt;- installed.packages() r.version &lt;- paste(version[[&#39;major&#39;]], &#39;.&#39;, version[[&#39;minor&#39;]], sep = &#39;&#39;) for (i in 1:nrow(all.packages)) { package.name &lt;- all.packages[i, 1] package.version &lt;- all.packages[i, 3] if (package.version != r.version) { print(paste(&#39;Installing&#39;, package.name)) install.packages(package.name) } } ** update all available packages ** update.packages() ** update, without prompts for permission/clarification update.packages(ask = FALSE) 1.2.2 åå®‰è£ åœ¨R consoleä¸­ï¼Œåˆ©ç”¨æŒ‡ä»¤ .libPaths()ï¼Œæˆ–è€…åœ¨shell(terminal)ä¸­åˆ©ç”¨ R -e â€˜.libPaths()â€™ çŸ¥é“å¥—è£è¢«å®‰è£åœ¨å“ªè£¡ï¼Œç„¶å¾Œå¯ä»¥ç§»é™¤æ‰€æœ‰çš„ç›¸é—œå¥—ä»¶ Rtools åœ¨windowsä¸­å®‰è£å®Œä»¥å¾Œï¼ŒåŸ·è¡Œ writeLines(&#39;PATH=&quot;${RTOOLS40_HOME}\\\\usr\\\\bin;${PATH}&quot;&#39;, con = &quot;~/.Renviron&quot;) é‡å•Ÿå‹•ï¼Œç„¶å¾Œæ¸¬è©¦ä¸‹é¢æŒ‡ä»¤ Sys.which(&quot;make&quot;) 1.3 quick view å¿«é€ŸæŒ‡ä»¤ 1.3.0.1 ç›®å‰æœ‰å“ªäº›è³‡æ–™é›†å¯ä»¥æ¸¬è©¦ data() 1.4 å¹¾å€‹å¸¸ç”¨çš„çµ±è¨ˆé‡: x&lt;-c(1,2,3) median(x) mean(x) min(x) sd(x) range(x) diff(x) 1.5 è³‡æ–™å‹æ…‹å’Œå…§å®¹ å¯ä»¥å…ˆçœ‹çœ‹è³‡æ–™æè¿° ?mtcars mtcars mpg cyl disp hp drat wt qsec vs am gear carb Mazda RX4 21.0 6 160.0 110 3.90 2.62 16.5 0 1 4 4 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.88 17.0 0 1 4 4 Datsun 710 22.8 4 108.0 93 3.85 2.32 18.6 1 1 4 1 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.21 19.4 1 0 3 1 Hornet Sportabout 18.7 8 360.0 175 3.15 3.44 17.0 0 0 3 2 Valiant 18.1 6 225.0 105 2.76 3.46 20.2 1 0 3 1 Duster 360 14.3 8 360.0 245 3.21 3.57 15.8 0 0 3 4 Merc 240D 24.4 4 146.7 62 3.69 3.19 20.0 1 0 4 2 Merc 230 22.8 4 140.8 95 3.92 3.15 22.9 1 0 4 2 Merc 280 19.2 6 167.6 123 3.92 3.44 18.3 1 0 4 4 Merc 280C 17.8 6 167.6 123 3.92 3.44 18.9 1 0 4 4 Merc 450SE 16.4 8 275.8 180 3.07 4.07 17.4 0 0 3 3 Merc 450SL 17.3 8 275.8 180 3.07 3.73 17.6 0 0 3 3 Merc 450SLC 15.2 8 275.8 180 3.07 3.78 18.0 0 0 3 3 Cadillac Fleetwood 10.4 8 472.0 205 2.93 5.25 18.0 0 0 3 4 Lincoln Continental 10.4 8 460.0 215 3.00 5.42 17.8 0 0 3 4 Chrysler Imperial 14.7 8 440.0 230 3.23 5.34 17.4 0 0 3 4 Fiat 128 32.4 4 78.7 66 4.08 2.20 19.5 1 1 4 1 Honda Civic 30.4 4 75.7 52 4.93 1.61 18.5 1 1 4 2 Toyota Corolla 33.9 4 71.1 65 4.22 1.83 19.9 1 1 4 1 Toyota Corona 21.5 4 120.1 97 3.70 2.46 20.0 1 0 3 1 Dodge Challenger 15.5 8 318.0 150 2.76 3.52 16.9 0 0 3 2 AMC Javelin 15.2 8 304.0 150 3.15 3.44 17.3 0 0 3 2 Camaro Z28 13.3 8 350.0 245 3.73 3.84 15.4 0 0 3 4 Pontiac Firebird 19.2 8 400.0 175 3.08 3.85 17.1 0 0 3 2 Fiat X1-9 27.3 4 79.0 66 4.08 1.94 18.9 1 1 4 1 Porsche 914-2 26.0 4 120.3 91 4.43 2.14 16.7 0 1 5 2 Lotus Europa 30.4 4 95.1 113 3.77 1.51 16.9 1 1 5 2 Ford Pantera L 15.8 8 351.0 264 4.22 3.17 14.5 0 1 5 4 Ferrari Dino 19.7 6 145.0 175 3.62 2.77 15.5 0 1 5 6 Maserati Bora 15.0 8 301.0 335 3.54 3.57 14.6 0 1 5 8 Volvo 142E 21.4 4 121.0 109 4.11 2.78 18.6 1 1 4 2 head(mtcars) mpg cyl disp hp drat wt qsec vs am gear carb Mazda RX4 21.0 6 160 110 3.90 2.62 16.5 0 1 4 4 Mazda RX4 Wag 21.0 6 160 110 3.90 2.88 17.0 0 1 4 4 Datsun 710 22.8 4 108 93 3.85 2.32 18.6 1 1 4 1 Hornet 4 Drive 21.4 6 258 110 3.08 3.21 19.4 1 0 3 1 Hornet Sportabout 18.7 8 360 175 3.15 3.44 17.0 0 0 3 2 Valiant 18.1 6 225 105 2.76 3.46 20.2 1 0 3 1 tail(mtcars) mpg cyl disp hp drat wt qsec vs am gear carb Porsche 914-2 26.0 4 120.3 91 4.43 2.14 16.7 0 1 5 2 Lotus Europa 30.4 4 95.1 113 3.77 1.51 16.9 1 1 5 2 Ford Pantera L 15.8 8 351.0 264 4.22 3.17 14.5 0 1 5 4 Ferrari Dino 19.7 6 145.0 175 3.62 2.77 15.5 0 1 5 6 Maserati Bora 15.0 8 301.0 335 3.54 3.57 14.6 0 1 5 8 Volvo 142E 21.4 4 121.0 109 4.11 2.78 18.6 1 1 4 2 head å‰å¹¾ç­†è³‡æ–™ tail å¾Œå¹¾ç­†è³‡æ–™ 1.5.1 ç·¨è¼¯/ç€è¦½è³‡æ–™ edit(mtcars) data.entry(mtcars) View(mtcars) 1.5.2 å€‹åˆ¥æ¬„ä½ å¦‚æœè¦é¡¯ç¤ºå€‹åˆ¥æ¬„ä½,ä¸€èˆ¬å¯ä»¥æ˜¯mtcars$mpg,ä½†æ˜¯å¦‚æœè¦ç›´æ¥ä½¿ç”¨mpgæ¬„ä½,å¯ä»¥åˆ©ç”¨attach() attach(mtcars) mpg [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4 [16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7 [31] 15.0 21.4 1.5.3 è³ªæ€§æ•¸æ“šçš„åˆ†æ æ¬„ä½cylç‚ºè³ªæ€§è®Šæ•¸,å¯ä»¥åˆ©ç”¨tableåˆ†æ table(mtcars$cyl) 4 6 8 11 7 14 é »ç‡åœ– barplot(table(mtcars$cyl)) è§£é‡‹ä¸‹é¢å…©å€‹åœ–ç‚ºç”šéº¼ä¸ä¸€æ¨£? v&lt;-as.vector(table(mtcars$cyl)) barplot(v) m&lt;-as.matrix(table(mtcars$cyl)) barplot(m) ä¸Šé¢å…©å€‹åœ–ä¸ä¸€æ¨£,å› ç‚ºtable()çš„å®šç¾©,æ‰€ä»¥è½‰æˆçŸ©é™£ä»¥å¾Œæ˜¯2x3ã€‚ x&lt;-table(mtcars$cyl) x barplot(c(11,7,4)) barplot(mtcars$mpg) barplot(mtcars$cyl) 1.6 assignment &lt;-å’Œ -&gt; æ˜¯ä¸€å° ï¼Œå¯ä»¥å‘å·¦å’Œå‘å³è³¦å€¼ = æ˜¯å–®å‘çš„ ï¼Œä½œç”¨å’Œ&lt;-åŸºæœ¬ç›¸åŒï¼Œä½†å°å‡½æ•¸ä¸­çš„è®Šæ•¸é€šå¸¸ä½¿ç”¨= &lt;&lt;- é€™å€‹æ˜¯å…¨åŸŸè³¦å€¼ ï¼Œè·Ÿè®Šæ•¸çš„ä½œç”¨åŸŸæœ‰é—œï¼Œé–‹ç™¼è‡ªå·±çš„å¥—ä»¶(package)çš„æ™‚å€™,å¸¸ç”¨ã€‚ ##Delete x (if it exists) rm(x) Warning in rm(x): æ‰¾ä¸åˆ°ç‰©ä»¶ 'x' mean(x = 1:10) #[1] 5.5 [1] 5.5 x #Error: object &#39;x&#39; not found Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'x' è§€å¯Ÿä¸Šé¢çš„x,ç¬¬ä¸€è¡ŒæŒ‡ä»¤å¾ç’°å¢ƒä¸­å»æ‰è®Šæ•¸xçš„å®šç¾©ã€‚ ç¬¬2è¡Œä¸­çš„xæ˜¯åœ¨block ä¸­å®šç¾©ï¼Œå› æ­¤åŸ·è¡Œå®Œä»¥å¾Œ,æœƒè¢«æ®ºæ‰ã€‚å› æ­¤ç¬¬ä¸‰è¡ŒæŒ‡ä»¤,å‡ºç¾æ‰¾ä¸åˆ°xçš„æç¤ºã€‚ å¾Œé¢æ¸¬è©¦&lt;- operator: mean(x &lt;- 1:10) # [1] 5.5 [1] 5.5 x [1] 1 2 3 4 5 6 7 8 9 10 x # [1] 1 2 3 4 5 6 7 8 9 10 This time the x variable is declared within the user workspace. When does the assignment take place ? In the code above, you may be tempted to thin that we â€œassign 1:10 to x, then calculate the mean.â€ This would be true for #languages such as C, but it isn â€™t true in R. Consider the following function: a &lt;- 1 f &lt;- function(a) return(TRUE) f &lt;- f(a &lt;- a + 1); # è¼¸å‡º:TRUE a # çµæœ=1 [1] 1 æ³¨æ„ä¸Šé¢açš„å€¼,ä»ç„¶æ˜¯1ã€‚åŸå› æ˜¯å› ç‚ºRçš„ç·¨è­¯å™¨,åœ¨æœ€ä½³åŒ–çš„æ™‚å€™,çŸ¥é“å‡½æ•¸ä¸­æ²’ç”¨åˆ°åƒæ•¸,å› æ­¤æ ¹æœ¬æ²’æœ‰å­˜å–åˆ°è®Šæ•¸a,å› æ­¤ï¼ŒåŸä¾†çš„aæ˜¯ç”šéº¼,aä»ç„¶æ˜¯ç”šéº¼ã€‚ ç°¡å–®è¬›å°±æ˜¯f(a&lt;-a+1)ä¸­çš„a&lt;-a+1 è¢«å»æ‰ä¸æœƒè¢«åŸ·è¡Œ f(a&lt;-a+1) =&gt; f() rewrite f &lt;- function(a) { if (runif(1) &gt; 0.5) TRUE else a } f(a &lt;- a + 1); a # result 2 [1] 2 é€™å€‹å‡½æ•¸fç”¨åˆ°äº†åƒæ•¸a,ä½†æ˜¯ç·¨è­¯å™¨é€™æ¬¡æ²’é‚£éº¼è°æ˜,çŸ¥é“ä½¿ç”¨è€…ç”¨aä¾†åšç”šéº¼,é›–ç„¶é€™å€‹å‡½æ•¸çš„bodyä»ç„¶æ²’æœ‰å‹•åˆ°a,ä½†æ˜¯é€™æ¬¡f(a&lt;-a+1)ä¸­çš„a&lt;-a+1 æœƒè¢«åŸ·è¡Œã€‚ ç·´ç¿’ å…ˆå»æ‰ç’°å¢ƒä¸­çš„è®Šæ•¸a,ç„¶å¾Œåœ¨åŸ·è¡Œä¸Šé¢çš„chunk. hint: rm(a) f(a &lt;- a + 1); [1] TRUE # TRUE a # 2 [1] 2 f(a &lt;- a + 1); [1] TRUE a #3 [1] 2 a&lt;-1; f &lt;- function(a) return(a); invisible(f(a=a+1)) a [1] 1 invisible(f(a&lt;-a+1)) a [1] 2 ä¸Šé¢ç¨‹å¼ä¸­,invisibleå‡½æ•¸åœ¨é€™è£¡çš„èªªæ˜ä¸é‡è¦,åªæ˜¯ç”¨ä¾†éš±è—è¨ˆç®—çµæœã€‚ a&lt;-1; f &lt;- function(a) return(3); invisible(f(a=a+1)) a [1] 1 invisible(f(a&lt;-a+1)) a [1] 1 =ç”¨åœ¨åƒæ•¸æŒ‡æ´¾ ä¾‹å¦‚ matrix(1:20, ncol = 4) [,1] [,2] [,3] [,4] [1,] 1 6 11 16 [2,] 2 7 12 17 [3,] 3 8 13 18 [4,] 4 9 14 19 [5,] 5 10 15 20 ncol function (x) dim(x)[2L] ç”¢ç”Ÿ5X4çŸ©é™£ã€‚å¦‚æœ matrix(1:20, ncol &lt;- 4) [,1] [,2] [,3] [,4] [,5] [1,] 1 5 9 13 17 [2,] 2 6 10 14 18 [3,] 3 7 11 15 19 [4,] 4 8 12 16 20 ncol [1] 4 æœƒç”¢ç”Ÿä¸€å€‹è®Šæ•¸ ncolï¼Œé€™è£¡ç”¢ç”Ÿçš„ç‚º4x5çš„çŸ©é™£ã€‚ç‚ºç”šéº¼?å› ç‚ºé€™è£¡çš„ç¬¬2å€‹åƒæ•¸ncol&lt;-4,æŒ‡æ´¾çµ¦è®Šæ•¸ncol,ç„¶å¾Œé€™å€‹expressionæœƒreturn 4,è€Œ4å°±è¢«ç•¶æˆç¬¬2å€‹åƒæ•¸,ä¹Ÿå°±æ˜¯matrix(1:20, ncol &lt;- 4)ç­‰åŒæ–¼matrix(1:20, 4),ä¹Ÿå°±æ˜¯æŒ‡å®šROWçš„ç¶­åº¦ã€‚ çµè«–:x&lt;-3 &lt;-æœƒåœ¨å…¨å±€ç”¢ç”Ÿè®Šæ•¸xç„¶å¾ŒæŒ‡æ´¾3 (x &lt;- 3) [1] 3 #rm(list = ls()) rm(x) ls() [1] \"a\" \"f\" \"m\" \"ncol\" \"v\" (x = 3) [1] 3 ls() [1] \"a\" \"f\" \"m\" \"ncol\" \"v\" \"x\" å› ç‚ºxæ˜¯åƒæ•¸åç¨±ä¸æ˜¯è®Šæ•¸,çœ‹mean help "],
["data-type.html", "Chapter 2 data type 2.1 åŸºæœ¬æ“ä½œ 2.2 é‹ç®— 2.3 ä»‹ç´¹ 2.4 å¯¦æ•¸çš„æ¯”è¼ƒ 2.5 å­—ä¸² 2.6 å‹æ…‹æ“ä½œis family 2.7 vector 2.8 å­—ä¸²å’Œvector 2.9 List 2.10 data set build in 2.11 primer to access element 2.12 vector å‡½æ•¸ç¯„ä¾‹ 2.13 ç·´ç¿’: åˆªé™¤å‘é‡ä¸­çš„ä¸€å€‹å…ƒç´  2.14 matrix 2.15 å­—ä¸²å‡½æ•¸ 2.16 Factors 2.17 Data Frames 2.18 Tables 2.19 OOP 2.20 operator %&gt;% 2.21 apply family 2.22 ç›¸é—œæ“ä½œ 2.23 å¸¸è¦‹éŒ¯èª¤", " Chapter 2 data type 2.1 åŸºæœ¬æ“ä½œ 2.1.1 æŒ‡æ´¾ é›–ç„¶ä¹Ÿå¯ä»¥ç”¨=ä½†æ˜¯ï¼ŒRçš„è¨­è¨ˆæ˜¯ä½¿ç”¨&lt;-ã€‚ a &lt;- 3 a&lt;-3æ˜¯ä¸€å€‹æŒ‡æ´¾çš„æ•˜è¿°å¥,ä¸æœƒå›é¥‹è³‡è¨Šåˆ°è¢å¹•ä¸Šã€‚å¦‚æœè¦çŸ¥é“açš„å…§å®¹æ˜¯ç”šéº¼,å°±æ‰“å…¥a æˆ–è€…(a&lt;-3) a [1] 3 (a&lt;-3) [1] 3 b &lt;- sqrt(a * a + 5) b [1] 3.74 åœ¨sessionä¸­çš„å¦‚æœè¦åˆ—å‡ºå·²ç¶“å®šç¾©éçš„è®Šæ•¸,å¯ä»¥åˆ©ç”¨ls ls() [1] \"a\" \"b\" æŒ‰ç…§Rçš„èªªæ˜,ç­‰è™Ÿåªèƒ½ç”¨åœ¨top level,æˆ–æ˜¯å‡½æ•¸åƒæ•¸çš„æŒ‡å®šã€‚ åƒè€ƒ â€¹function_nameâ€º(â€¹argnameâ€º = â€¹valueâ€º, â€¦) â€¹function_nameâ€º(â€¹argsâ€º, â€¹argnameâ€º = â€¹valueâ€º, â€¦) 2.2 é‹ç®— 2.2.1 å››å‰‡é‹ç®— 2.2.2 Logical Another important data type is the logical type. There are two predefined variables, TRUE and FALSE: a = TRUE typeof(a) [1] \"logical\" b = FALSE typeof(b) [1] \"logical\" 2.2.3 Rèªè¨€å¸¸ç”¨é‚è¼¯é‹ç®—å­ operator èªªæ˜ &lt; less than &gt; great than &lt;= less than or equal &gt;= greater than or equal == equal to != not equal to | entry wise or || or ! not &amp; entry wise and &amp;&amp; and xor(a,b) exclusive or ç¯„ä¾‹ï¼šä¸åŒçš„é‹ç®—å­ï¼Œåœ¨å€‹åˆ¥å…ƒç´ å’Œæ•´å€‹å‘é‡çš„é‹ç®—çµæœä¸ä¸€æ¨£ï¼š a = c(TRUE, FALSE) b = c(FALSE, FALSE) a | b [1] TRUE FALSE a || b [1] TRUE xor(a, b) [1] TRUE FALSE a||b åªæ¯”å°a,bä¸­çš„ç¬¬ä¸€å€‹å…ƒç´ ã€‚ 2.2.4 é‚è¼¯å‡½æ•¸ is.family å‡½æ•¸ï¼Œå¯ä»¥ç”¨ä¾†åˆ¤å®šè®Šæ•¸æ˜¯ä»€éº¼å‹æ…‹ï¼Œå‚³å›çœŸå‡å€¼ï¼Œä¾‹å¦‚ a = c(1, 2, 3) is.numeric(a) [1] TRUE is.factor(a) [1] FALSE å‡½æ•¸identical(a,b) a,b æ˜¯å¦ç›¸ç­‰ A &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;) B &lt;- A C &lt;- c(&quot;A&quot;, &quot;C&quot;, &quot;C&quot;, &quot;E&quot;) identical(A,C) [1] FALSE å‡½æ•¸which()å“ªäº›å…ƒç´ ä¸ä¸€è‡´ which(A != C) [1] 2 4 å‡½æ•¸all() all(A==B) [1] TRUE all(A==C) [1] FALSE which(),all()è£¡é¢çš„åƒæ•¸å…¶å¯¦éƒ½æ˜¯é‚è¼¯å‘é‡ã€‚ è¨»è§£ï¼šä½†æ˜¯Rèªè¨€çš„å‘é‡é‹ç®—ï¼Œæ¶‰åŠè‡ªå‹•å¡«å……å¾ªç’°ï¼Œå› æ­¤æ³¨æ„ä¸‹é¢çš„è¨ˆç®—çµæœ D &lt;- c(&quot;A&quot;,&quot;B&quot;,&quot;A&quot;,&quot;B&quot;) E &lt;- c(&quot;A&quot;,&quot;B&quot;) all(D==E) [1] TRUE all(length(D)==length(E)) &amp;&amp; all(D==E) [1] FALSE ç·´ç¿’ï¼š å°‡ä¸Šé¢å¯èƒ½é€ æˆèª¤åˆ¤çš„æƒ…æ³ï¼Œå¯«æˆå‡½æ•¸å…ˆåˆ¤æ–·æ˜¯å¦é•·åº¦ç›¸ç­‰ï¼Œç„¶å¾Œåˆ¤æ–·å…ƒç´ ç›¸ç­‰ï¼Œå¯ä»¥å’Œidentical()æ¯”è¼ƒã€‚ 2.2.5 è³‡æº è³‡æ–™çµæ§‹ 2.3 ä»‹ç´¹ åœ¨Rèªè¨€ä¸­,å‹æ…‹ä¸é ˆç¶“éå®£å‘Š(declared)ã€‚ ä¸€å€‹è®Šæ•¸çš„å‹æ…‹ç¶“ç”±assignmentçš„éç¨‹æ±ºå®š,å³&lt;-å³é‚Šçš„R-Objectsã€‚ä¹Ÿå°±æ˜¯åœ¨æŒ‡æ´¾è®Šæ•¸å€¼çš„æ™‚å€™,åŒæ™‚æ±ºå®šäº†å‹æ…‹ã€‚åŸºæœ¬çš„ R-objectæœ‰ âˆ’ Vectors Lists Matrices Arrays Factors Data Frames æœ€ç°¡å–®çš„æ˜¯vectorç‰©ä»¶,atomic vector æœ‰6ç¨®data types(æœ‰æ™‚ä¹Ÿå«åš 6 å€‹classes) Data Type Example | Logical | TRUE, TRUE, FALSE | Numeric |1.3, 5 1.3, 5, 99 | Integer |3L, 24 3L, 24L, 0L | Complex |5 + 4i 5 + 4i Character â€˜bâ€™ , â€œgoodâ€, â€œTRUEâ€, â€˜23.4â€™ Raw |\"H â€œHelloâ€ is stored as 48 65 6c 6c 6f | æ•¸å­—(3ç¨®),é‚è¼¯,å­—å…ƒ(2ç¨®) v &lt;- TRUE print(class(v)) [1] \"logical\" v &lt;- 23.5 print(class(v)) [1] \"numeric\" v &lt;- 2L print(class(v)) [1] \"integer\" v &lt;- 2+5i print(class(v)) [1] \"complex\" v &lt;- &quot;TRUE&quot; print(class(v)) [1] \"character\" v &lt;- charToRaw(&quot;Hello&quot;) print(class(v)) [1] \"raw\" 2.4 å¯¦æ•¸çš„æ¯”è¼ƒ x &lt;- seq(0, 1, by = 0.2) y &lt;- seq(0, 1, by = 0.2) y[4] [1] 0.6 x[3] [1] 0.4 1 - x[3] [1] 0.6 y[4] == 1 - x[3] [1] FALSE y[4] &gt; 1 - x[3] [1] TRUE ## note: all.equal(y[4], 1 - x[3]) [1] TRUE ## Q: what is the result of : 1-0.4 ==0.6 0.1+0.2 == 0.3 [1] FALSE all.equal(0.1+0.2,0.3) [1] TRUE nx1&lt;-numeric(0) nx2&lt;-3 is.null(nx1) # F,å› ç‚ºnx1æ˜¯ç©ºå‘é‡(é•·åº¦ç‚º0çš„æ•¸å­—å‘é‡) [1] FALSE is.na(nx1) # logical(0),æ¯å€‹å…ƒç´ æª¢æŸ¥æ˜¯ä¸æ˜¯NA,ä½†æ˜¯ç¾åœ¨æ˜¯ç©ºå‘é‡,æ‰€ä»¥çµæœæ˜¯logical(0) logical(0) typeof(nx1) # double [1] \"double\" typeof(nx2) # double [1] \"double\" length(nx1) # 0 [1] 0 length(nx2) # 1 [1] 1 ç”šéº¼æ™‚å€™ç”¨åˆ°is.null config &lt;- list() is.null(config$name) [1] TRUE 2.5 å­—ä¸² åƒè€ƒ 2.5.1 å»ºç«‹å­—ä¸² å¯ä»¥æ˜¯ é›™å¼•è™Ÿä¸­\"\" æˆ– å–®å¼•è™Ÿä¸­â€™â€™ã€‚ å­—ä¸²ä¸­å¦‚æœæœ‰é›™å¼•è™Ÿ,æˆ–å–®å¼•è™Ÿï¼Œå‰‡å¦‚ä¸‹è¡¨ç¤º: â€œâ€˜é€™å€‹â€™ä¾†è‡ªâ€™é‚£å€‹â€™â€ a &lt;- &quot;hello&quot; a [1] \"hello\" typeof(a) #[1] &quot;character&quot; [1] \"character\" is.vector(a) #[1] TRUE [1] TRUE åˆ©ç”¨å‡½æ•¸:character() é€™å€‹å‡½æ•¸çš„åƒæ•¸,ç‚ºæ•´æ•¸,å»ºç«‹ä¸€å€‹vector(ä¸æ˜¯list),è£¡é¢çš„å…ƒç´ éƒ½æ˜¯ç©ºå­—ä¸² # è®Šæ•¸exåˆå§‹åŒ–ç‚ºcharacter vector,åƒçœ‹å¾Œé¢çš„è¨è«– (ex &lt;- character(0)) character(0) length(ex) [1] 0 class(ex) [1] \"character\" # å¦‚æœå‰›å‰›æ²’æœ‰è¨­å®šex &lt;- character(0),é€™è£¡æœƒç™¼ç”ŸéŒ¯èª¤ (ex[1] &lt;- &quot;first&quot;) [1] \"first\" # check its length again length(ex) [1] 1 ç´¢å¼•å¯ä»¥ç”¨è·³çš„: (ex[4] &lt;- &quot;fourth&quot;) [1] \"fourth\" length(ex) [1] 4 typeof(ex) [1] \"character\" ex [1] \"first\" NA NA \"fourth\" è·³éçš„ç´¢å¼•,å…§å®¹è‡ªå‹•ç‚ºNA. 2.5.2 ç©ºå­—ä¸² å¼•è™Ÿå…§é€£ç©ºç™½éƒ½æ²’æœ‰çš„å­—ä¸²: (æ¯”è¼ƒä¸Šé¢åˆ©ç”¨character(5)å¯ä»¥å»ºç«‹5å€‹å…ƒç´ ç‚ºç©ºå­—ä¸²çš„vectorã€‚) # empty string empty_str &lt;- &quot;&quot; empty_str [1] \"\" # class class(empty_str) [1] \"character\" 2.5.2.1 è¨è«–character(0) å‰é¢èªªcharacter(2),å¯ä»¥å‚³å›é•·åº¦2,æ¯å€‹å…ƒç´ éƒ½æ˜¯ç©ºç™½å­—ä¸²\"\"çš„å‘é‡,é‚£éº¼character(0)æ˜¯ç”šéº¼? é™¤äº†å‰é¢æåˆ°çš„è®Šæ•¸åˆå§‹åŒ–ç‚ºå‘é‡(ä¹Ÿè¨±å¯ä»¥èªªæ˜¯å‘é‡å®£å‘Š) ä¾‹å¦‚,æ•´æ•¸ä¹Ÿæ˜¯é€™æ¨£ zz&lt;-integer(0) zz[4]=6 zz [1] NA NA NA 6 é€™è£¡å°character(0)åšä¸€äº›æ¸¬è©¦: ex1&lt;-character(0) ex2&lt;-&quot;&quot; typeof(ex1) [1] \"character\" typeof(ex2) [1] \"character\" å‡½æ•¸str()ç”¨ä¾†é¡¯ç¤ºRç‰©ä»¶çš„çµæ§‹: str(ex1) chr(0) str(ex2) chr \"\" class(ex1) [1] \"character\" class(ex2) [1] \"character\" is.list(ex1) [1] FALSE is.list(ex2) [1] FALSE surprise: ä¸€å€‹å­—å…ƒä¹Ÿæ˜¯å‘é‡ã€‚ is.vector(ex1) [1] TRUE is.vector(ex2) [1] TRUE length(ex1) [1] 0 length(ex2) [1] 1 is.null(ex1) [1] FALSE is.null(ex2) [1] FALSE is.na(ex1) logical(0) is.na(ex2) [1] FALSE æœ€å¾Œ,é€™å…©å€‹æ˜¯ä¸æ˜¯ç›¸ç­‰ ex1==ex2 logical(0) 2.6 å‹æ…‹æ“ä½œis family is.numeric(), is.integer(), and is.double() ## å‹æ…‹è½‰æ› as family a&lt;-c(TRUE,FALSE) as.numeric(a) [1] 1 0 an&lt;-as.logical(a) an [1] TRUE FALSE 2.7 vector åˆ©ç”¨cå‡½æ•¸ï¼Œå¯ä»¥ä½¿ç”¨vectorå­˜æ”¾ä¸€å€‹ä»¥ä¸Šçš„æ•¸å­—ã€‚ a = c(1, 2, 3, 4, 5) a1 = 1:5 æœ‰é—œlistçš„é‹ç®—:åŠ æ¸›ä¹˜é™¤ç­‰ç­‰ a = c(1, 2, 3, 4, 5) a+1 [1] 2 3 4 5 6 mean(a) [1] 3 var(a) [1] 2.5 summary(a) Min. 1st Qu. Median Mean 3rd Qu. Max. 1 2 3 3 4 5 note: å°æ¯”stata sum a æŒ‡ä»¤,summary(a) è¿”å›çš„æ˜¯ä¸€å€‹tableç‰©ä»¶ã€‚å¯ä»¥æŒ‡æ´¾çµ¦è®Šæ•¸,å› æ­¤è¨ˆç®—çµæœå¯ä»¥ç¶“ç”±è®Šæ•¸(é¡åˆ¥ç‚ºtable)å­˜å–ã€‚ listçš„å…ƒç´ ,åˆ©ç”¨ä¸­æ‹¬è™Ÿ a = 2:6 a[1] [1] 2 a[2] [1] 3 a[0] integer(0) a[6] [1] NA åœ¨Rä¸­,çš„æœ€å°çš„ç´¢å¼•å€¼ç‚º1base.å¦‚æœçµ¦ç´¢å¼•ç‚º0,å¯ä»¥çŸ¥é“è³‡æ–™æ˜¯å¦è¢«æ’åºã€‚ è¶…å‡ºç´¢å¼•ç¯„åœå¾—åˆ°\"NAã€‚ a=2:6 x = a[6] å¦‚ä½•åˆ¤æ–·æ˜¯å¦NA x == NA [1] NA ä¸Šé¢çš„æ¯”è¼ƒæ²’æœ‰æ„ç¾©,å’ŒNAçš„ä»»ä½•é‹ç®—éƒ½æ˜¯NA r = x == NA r [1] NA çµè«–:ä»»ä½•è®Šæ•¸å’ŒNAé‹ç®—,çµæœé‚„æ˜¯NA å¦ä¸€ç¨®æ–¹æ³• print(x == NA) [1] NA å¦‚ä½•åˆ¤æ–·NA ? is.na() is.na(a[6]) [1] TRUE åˆå§‹åŒ–å‘é‡,å¯ä»¥åˆ©ç”¨a&lt;-10 æˆ–æŒ‡å®šnumeric(double)å‹æ…‹ a &lt;- numeric(10) a [1] 0 0 0 0 0 0 0 0 0 0 å¦‚æœæƒ³è¦çŸ¥åˆ°è®Šæ•¸çš„è³‡æ–™å‹åˆ¥,åˆ©ç”¨å‡½æ•¸typeof() typeof()å‡½æ•¸å›å‚³çš„çµæœæ˜¯â€œå­—ä¸²â€ typeof(a) # çµæœæ˜¯&quot;double&quot; [1] \"double\" s = typeof(a) s [1] \"double\" typeof(s) #çµæœæ˜¯ &quot;character&quot; [1] \"character\" 2.7.1 ç·´ç¿’ç¯„ä¾‹ Q1. a,a1,a2 å±¬æ–¼ç”šéº¼å‹æ…‹ a = 1:4 a1 = c(1, 2, 3, 4) a2 = numeric(4) A1 Q2:a3çš„é•·åº¦æ˜¯ç”šéº¼?2,æˆ–6 a1&lt;-c(1,2,3) a2&lt;-c(2,3,4) a3&lt;-c(a1,a2) HINT: a1 a2 a3;length(a3) 2.8 å­—ä¸²å’Œvector åœ¨EXCELä¸­ï¼Œvector ä¸€èˆ¬æŒ‡çš„æ˜¯åªæ”¾å…ƒç´ ç‚ºæ•¸å­—çš„é™£åˆ—(array);è€Œé™£åˆ—æ˜¯å¯ä»¥å­˜æ•¸å­—å’Œæ–‡å­—çš„å€åŸŸã€‚tableæ˜¯æœ‰æ¬„ä½çš„é™£åˆ—ã€‚ ä½†æ˜¯åœ¨Rèªè¨€ä¸­,vector åªæ˜¯å…ƒç´ å‹æ…‹ç›¸åŒå³å¯ã€‚ a &lt;- &quot;hello&quot; a [1] \"hello\" typeof(a) [1] \"character\" b &lt;- c(&quot;hello&quot;, &quot;there&quot;) b [1] \"hello\" \"there\" b[1] [1] \"hello\" typeof(b) [1] \"character\" (a = character(5)) # ç”¢ç”Ÿ5å€‹ç©ºå­—ä¸² [1] \"\" \"\" \"\" \"\" \"\" (b = letters[1:4]) # æ³¨æ„,lettersä¸æ˜¯å‡½æ•¸ [1] \"a\" \"b\" \"c\" \"d\" letters [1] \"a\" \"b\" \"c\" \"d\" \"e\" \"f\" \"g\" \"h\" \"i\" \"j\" \"k\" \"l\" \"m\" \"n\" \"o\" \"p\" \"q\" \"r\" \"s\" [20] \"t\" \"u\" \"v\" \"w\" \"x\" \"y\" \"z\" typeof(letters) [1] \"character\" class(letters) [1] \"character\" å› ç‚ºcå‡½æ•¸çš„é‹ç®—çµæœç‚ºvector,å› æ­¤ä¸‹ä¾‹ä¸­,å…¶å…ƒç´ éƒ½æ˜¯å­—ä¸² (a&lt;-c(&quot;d&quot;,4,TRUE)) [1] \"d\" \"4\" \"TRUE\" å•é¡Œ: æ€æ¨£çŸ¥é“ræ˜¯ç©ºé›†åˆ? y &lt;- letters[1:3] z &lt;- letters[4:6] r&lt;-intersect(y,z) r character(0) is.na(r) logical(0) length(r) [1] 0 å¦å¤–,ç•¶vectoræœ‰å¤šå€‹å­—ä¸²,è€Œä½¿ç”¨ç´¢å¼•0çš„æ™‚å€™,ä¹Ÿæœƒå‡ºç¾ character(0),ä¾‹å¦‚: string &lt;- c(&#39;sun&#39;, &#39;sky&#39;, &#39;clouds&#39;) string[0] character(0) 2.8.1 vector ç›¸é—œçš„é‹ç®— é€£çºŒæ•¸å­—å¯ä»¥åˆ©ç”¨æ“ä½œå…ƒ:,ä¾‹å¦‚: x &lt;- 1:7; x y &lt;- 2:-2; y æ¯”è¼ƒè¤‡é›œçš„åºåˆ—å¯ä»¥åˆ©ç”¨å‡½æ•¸ seq() ,ä¾‹å¦‚ seq(1, 3, by=0.2) # specify step size [1] 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0 seq(1, 5, length.out=4) # specify length of the vector [1] 1.00 2.33 3.67 5.00 2.8.2 å¦‚ä½•å­˜å–vectorä¸­çš„å…ƒç´  å…ƒç´ ç´¢å¼•å¯ä»¥åˆ©ç”¨ logical, integer or character vector. å¦‚æœåˆ©ç”¨æ•´æ•¸ç´¢å¼•,å‰‡å¾1é–‹å§‹.ä½†æ˜¯,å¦‚æœç´¢å¼•å€¼çµ¦çš„æ˜¯è² æ•¸(ä¾‹å¦‚-2),å‰‡é™¤äº†2è™Ÿå…ƒç´ ä»¥å¤–,éƒ½æœƒè¢«å‚³å›ã€‚ä½†æ˜¯ä¸èƒ½åŒæ™‚æœ‰æ­£è² ã€‚åŒæ™‚,æµ®é»æ•¸æœƒè¢«truncatedã€‚ &gt; x [1] 0 2 4 6 8 10 &gt; x[3] # access 3rd element [1] 4 &gt; x[c(2, 4)] # access 2nd and 4th element [1] 2 6 &gt; x[-1] # access all but 1st element [1] 2 4 6 8 10 &gt; x[c(2, -4)] # ä¸èƒ½æ··åˆæ­£è²  Error in x[c(2, -4)] : only 0&#39;s may be mixed with negative subscripts &gt; x[c(2.4, 3.54)] # real numbers are truncated to integers [1] 2 4 2.8.3 é‚è¼¯åšç‚ºç´¢å¼• èªªæ˜¯ç´¢å¼•æœ‰é»èª¤å°,å¯ä»¥èªç‚ºæ˜¯å…ƒç´ ç¯©é¸ã€‚ä¾‹å¦‚ &gt; x[c(TRUE, FALSE, FALSE, TRUE)] [1] -3 3 &gt; x[x &lt; 0] # filtering vectors based on conditions [1] -3 -1 &gt; x[x &gt; 0] [1] 3 In the above example, the expression x&gt;0 will yield a logical vector (FALSE, FALSE, FALSE, TRUE) which is then used for indexing. 2.8.4 åˆ©ç”¨å­—ä¸²( character vector) ä½œç‚ºç´¢å¼• æ¯å€‹å…ƒç´ å¯ä»¥æœ‰åç¨±: &gt; x &lt;- c(&quot;first&quot;=3, &quot;second&quot;=0, &quot;third&quot;=9) &gt; x first second third 3 0 9 &gt; class(x) # æ³¨æ„:ä¸æ˜¯list [1] &quot;numeric&quot; &gt; names(x) [1] &quot;first&quot; &quot;second&quot; &quot;third&quot; &gt; x[&quot;second&quot;] second 0 &gt; x[c(&quot;first&quot;, &quot;third&quot;)] first third 3 9 a&lt;-c(x=1:2,y=3:4) a[&quot;x1&quot;] # ä¸æ˜¯a[x1] x1 1 ? a[â€œx1â€]å“ªè£¡ä¾†çš„x1? hint names(a) [] å’Œ[[]]çš„å·®åˆ¥: åŸä¾†çš„typeæ˜¯ç”šéº¼(ä¾‹å¦‚,list æˆ–vector),[]åªæ˜¯è¿”å›å­é›†åˆ(ä»ç„¶æ˜¯listæˆ–vector),ä½†æ˜¯[[]]å‰‡æ˜¯è¿”å›å…§å®¹. &gt; x &lt;- c(a = 1, b = 2, c = 3) &gt; x[&quot;a&quot;] a 1 &gt; x[[&quot;a&quot;]] [1] 1 &gt; x[1] a 1 &gt; x[[1]] [1] 1 å’Œlistçš„å€åˆ¥æ˜¯ 1. $ 1. ä¸å¿…æœ‰\"\" a1&lt;-list(x=1:2,y=3:4) a1$x [1] 1 2 2.8.5 How to modify a vector in R? We can modify a vector using the assignment operator. We can use the techniques discussed above to access specific elements and modify them. If we want to truncate the elements, we can use reassignments. &gt; x [1] -3 -2 -1 0 1 2 &gt; x[2] &lt;- 0; x # modify 2nd element [1] -3 0 -1 0 1 2 &gt; x[x&lt;0] &lt;- 5; x # modify elements less than 0 [1] 5 0 5 0 1 2 &gt; x &lt;- x[1:4]; x # truncate x to first 4 elements [1] 5 0 5 0 2.8.6 How to delete a Vector? We can delete a vector by simply assigning a NULL to it. &gt; x [1] -3 -2 -1 0 1 2 &gt; x &lt;- NULL &gt; x NULL &gt; x[4] NULL 2.9 List Lists æ˜¯ä¸€å€‹Rç‰©ä»¶ã€‚å…¶å…ƒç´ å…§å®¹å¯ä»¥æ˜¯ä¸åŒå‹æ…‹,ä¾‹å¦‚ numbers, strings, vectors,matrix æˆ–è€…æ˜¯å¦ä¸€å€‹ listï¼Œç”šè‡³æ˜¯å‡½æ•¸ã€‚ã€‚ 2.9.1 å»ºç«‹ List å‡½æ•¸list() å¯ä»¥å»ºç«‹list. åŒ…å«å¤šç¨®typeçš„List: strings, numbers, vectors and a logical values. list_data &lt;- list(&quot;Red&quot;, &quot;Green&quot;, c(21,32,11), TRUE, 51.23, 119.1) print(list_data) [[1]] [1] \"Red\" [[2]] [1] \"Green\" [[3]] [1] 21 32 11 [[4]] [1] TRUE [[5]] [1] 51.2 [[6]] [1] 119 ### Naming List Elements The list elements can be given names and they can be accessed using these names. #Create a list containing a vector, a matrix and a list. list_data &lt;- list(c(&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;), matrix(c(3,9,5,1,-2,8), nrow = 2), list(&quot;green&quot;,12.3)) #Give names to the elements in the list. names(list_data) &lt;- c(&quot;1st Quarter&quot;, &quot;A_Matrix&quot;, &quot;A Inner list&quot;) #Show the list. print(list_data) $`1st Quarter` [1] \"Jan\" \"Feb\" \"Mar\" $A_Matrix [,1] [,2] [,3] [1,] 3 5 -2 [2,] 9 1 8 $`A Inner list` $`A Inner list`[[1]] [1] \"green\" $`A Inner list`[[2]] [1] 12.3 é€™è£¡è¨è«–ä¸€ä¸‹ç‚ºç”šéº¼åœ¨Rèªè¨€å …æŒ&lt;-è€Œä¸æ˜¯=çš„ä¸€å€‹åŸå›  å¸¶åçš„vectorå’Œlist ,ç™½è©±æ–‡æ„æ€å°±æ˜¯å°‡æ¯å€‹å…ƒç´ å‘½åã€‚ x=c(1,2,3) names(x)&lt;-c(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) x a b c 1 2 3 ä¸€èˆ¬çš„ç¨‹å¼èªè¨€,ä¸æœƒç”¨åˆ°é€™ç¨®æ–‡æ³•,ä¾‹å¦‚,åœ¨å…¶ä»–ç¨‹å¼èªè¨€ä¸­,ç›´è¦ºä¸Šæ‡‰è©²æ˜¯æœ‰ä¸€å€‹names(),ç„¶å¾Œç”¨æ³•å¦‚ä¸‹: names(x,c(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) ) ä½†å¦‚æœæ˜¯matrix,è¢«å‘½åçš„å°±æ˜¯æ¬„ä½?ç­”æ¡ˆæ˜¯:NOã€‚è€Œæ˜¯ç´€éŒ„åç¨±?ç­”æ¡ˆä¹Ÿæ˜¯NO.è€Œæ˜¯çµ¦æ¯å€‹å…ƒç´ å‘½åã€‚ x&lt;-matrix(runif(9),nrow=3) names(x)&lt;-c(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) x [,1] [,2] [,3] [1,] 0.0808 0.1572 0.498 [2,] 0.8343 0.0074 0.290 [3,] 0.6008 0.4664 0.733 attr(,\"names\") [1] \"a\" \"b\" \"c\" NA NA NA NA NA NA rownames(x)&lt;-c(&#39;x&#39;,&#39;y&#39;,&#39;z&#39;) print(x,row.names=T) [,1] [,2] [,3] x 0.0808 0.1572 0.498 y 0.8343 0.0074 0.290 z 0.6008 0.4664 0.733 attr(,\"names\") [1] \"a\" \"b\" \"c\" NA NA NA NA NA NA å•:åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­xæ˜¯ä¸€å€‹çŸ©é™£,x[â€œaâ€]æœƒå‚³å›ç”šéº¼? ä½†æ˜¯åœ¨data.frameçš„çµæ§‹ä¸­,names()&lt;- çµ¦å®šçš„æ˜¯æ¬„ä½åç¨± xd&lt;-data.frame(x) names(xd)&lt;-c(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) xd a b c x 0.0808 0.1572 0.498 y 0.8343 0.0074 0.290 z 0.6008 0.4664 0.733 2.9.2 å­˜å– List å…ƒç´  # 3å€‹å…ƒç´ ,åˆ†åˆ¥æ˜¯list, matrix, list list_data &lt;- list(c(&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;), matrix(c(3,9,5,1,-2,8), nrow = 2), list(&quot;green&quot;,12.3)) # çµ¦åç¨± names(list_data) &lt;- c(&quot;1st Quarter&quot;, &quot;A_Matrix&quot;, &quot;A Inner list&quot;) # Access the first element of the list. print(list_data[1]) $`1st Quarter` [1] \"Jan\" \"Feb\" \"Mar\" # Access the thrid element. As it is also a list, all its elements will be printed. print(list_data[3]) $`A Inner list` $`A Inner list`[[1]] [1] \"green\" $`A Inner list`[[2]] [1] 12.3 # Access the list element using the name of the element. print(list_data$A_Matrix) [,1] [,2] [,3] [1,] 3 5 -2 [2,] 9 1 8 2.9.3 Manipulating List Elements We can add, delete and update list elements as shown below. We can add and delete elements only at the end of a list. But we can update any element. # Create a list containing a vector, a matrix and a list. list_data &lt;- list(c(&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;), matrix(c(3,9,5,1,-2,8), nrow = 2), list(&quot;green&quot;,12.3)) # Give names to the elements in the list. names(list_data) &lt;- c(&quot;1st Quarter&quot;, &quot;A_Matrix&quot;, &quot;A Inner list&quot;) # Add element at the end of the list. list_data[4] &lt;- &quot;New element&quot; print(list_data[4]) [[1]] [1] \"New element\" # Remove the last element. list_data[4] &lt;- NULL # Print the 4th Element. print(list_data[4]) $ NULL # Update the 3rd Element. list_data[3] &lt;- &quot;updated element&quot; print(list_data[3]) $`A Inner list` [1] \"updated element\" 2.9.4 Merging Lists You can merge many lists into one list by placing all the lists inside one list() function. # Create two lists. list1 &lt;- list(1,2,3) list2 &lt;- list(&quot;Sun&quot;,&quot;Mon&quot;,&quot;Tue&quot;) # Merge the two lists. merged.list &lt;- c(list1,list2) # Print the merged list. print(merged.list) [[1]] [1] 1 [[2]] [1] 2 [[3]] [1] 3 [[4]] [1] \"Sun\" [[5]] [1] \"Mon\" [[6]] [1] \"Tue\" â“ æˆ‘å€‘èªª åœ¨Rèªè¨€ä¸­,å‘é‡çš„æ„æ€,åªè¦å…ƒç´ åŒå‹æ…‹å°±è¡Œã€‚ä¸Šé¢çš„ç¨‹å¼ç¢¼ä¸­,åˆ©ç”¨cå°‡å…©å€‹list åˆä½µæˆå‘é‡,å…ƒç´ éƒ½æ˜¯ç›¸åŒå‹æ…‹(éƒ½æ˜¯list),é‚£å°±æ˜¯2å€‹å…ƒç´ ï¼Œä½†æ˜¯ç¾åœ¨æ˜¯6å€‹,ç‚ºç”šéº¼? ğŸ‘ æˆ‘å€‘èªªå‡½æ•¸c()æ˜¯ä¸€å€‹è™•ç†å‘é‡çš„å‡½æ•¸,åƒæ•¸ä¸­å…©å€‹å…ƒç´ éƒ½æ˜¯list,æœƒå…ˆè¢«è½‰æˆå‘é‡,æ‰€ä»¥3+3,ä½†æ˜¯ä½†æ˜¯é€™è£¡çš„listè£¡é¢æœ‰å¤šå€‹å‹æ…‹,æ‰€ä»¥ç¾å€‹å…ƒç´ éƒ½æ˜¯list(è­‰æ˜:list),æ‰€ä»¥æ˜¯6å€‹ã€‚ å¦‚æœè¦2å€‹,é‚£å°±æ˜¯merged.list2&lt;-list(list1,list2)ã€‚ â“ merge.list&lt;-c(x,y) ä¸­çš„mergeæ˜¯ä¸æ˜¯ç‰©ä»¶çš„æ„æ€? ğŸ‘ ä¸æ˜¯ã€‚åªæ˜¯å€‹åˆæ³•çš„è®Šæ•¸ã€‚ â“ å¯«ä¸€å€‹å‡½æ•¸,åˆä½µå…©å€‹list,ä½†æ˜¯è¦æ±‚å…©å€‹listä¸­æœ‰åŒåçš„å…ƒç´ å¿…é ˆæ˜¯ç¬¬2å€‹ä¸­çš„åç¨±ã€‚ä¾‹å¦‚ list(a=1,b=2,c=3), list(b=4) åˆä½µå¾Œè®Šæˆ a=1,b=4,c=3ã€‚ ğŸ‘ merge_list = function(x, y) { x[names(y)] = y x } 2.9.5 List è½‰ Vector å‡½æ•¸ unlist() # Create lists. list1 &lt;- list(1:5) print(list1) [[1]] [1] 1 2 3 4 5 list2 &lt;-list(10:14) print(list2) [[1]] [1] 10 11 12 13 14 # Convert the lists to vectors. v1 &lt;- unlist(list1) v2 &lt;- unlist(list2) print(v1) [1] 1 2 3 4 5 print(v2) [1] 10 11 12 13 14 # Now add the vectors result &lt;- v1+v2 print(result) [1] 11 13 15 17 19 2.9.6 æ¯”è¼ƒvector, listä¸­,å­—ä¸²çš„å•é¡Œ Q length()å‡½æ•¸å¯ä»¥çŸ¥é“vector,list çš„é•·åº¦,ä½†æ˜¯ç‚ºç”šéº¼length(â€œhelloâ€)çš„é•·åº¦æ˜¯1? a&lt;-c(&quot;hello&quot;,&quot;r&quot;) length(a) [1] 2 length(a[1]) [1] 1 length(a[[1]]) [1] 1 nchar(a[1]) [1] 5 length(&quot;hello&quot;) [1] 1 Q a&lt;-list(&quot;hello&quot;,&quot;r&quot;) length(a) [1] 2 length(a[1]) [1] 1 length(a[[1]]) [1] 1 ä¸Šé¢å…©å€‹ç­”æ¡ˆçš„å•é¡Œ,å’ŒRæ€æ¨£å»ºç«‹å­—ä¸²æœ‰é—œ æˆ‘çŒœæ˜¯ â€œhelloâ€ çš„è¨˜æ†¶é«”çµæ§‹æ˜¯ list(ptr) ,ptr-&gt;â€œhelloâ€ ä¹Ÿå°±æ˜¯èªªç´€éŒ„åœ¨listä¸­,ç•¶æˆ‘å•èªªlength(â€œhelloâ€)çš„æ™‚å€™,listçš„é•·åº¦éƒ½æ˜¯1ã€‚ ç¸½ä¹‹,å­—ä¸²é•·åº¦å‡½æ•¸nchar()ã€‚ 2.10 data set build in 2.10.1 List of pre-loaded data data() Loading a built-in R data data(mtcars) nrow(mtcars) [1] 32 ncol(mtcars) [1] 11 2.11 primer to access element ?â€œ[â€ pretty much covers the various ways of accessing elements of things. Under usage it lists these: x[i] x[i, j, ... , drop = TRUE] x[[i, exact = TRUE]] x[[i, j, ..., exact = TRUE]] x$name getElement(object, name) x[i] &lt;- value x[i, j, ...] &lt;- value x[[i]] &lt;- value x$i &lt;- value The second item is sufficient for your purpose Under Arguments it points out that with [ the arguments i and j can be numeric, character or logical So these work: data[1,1] data[1,&quot;V1&quot;] As does this: data$V1[1] and keeping in mind a data frame is a list of vectors: data[[1]][1] data[[&quot;V1&quot;]][1] will also both work. So thatâ€™s a few things to be going on with. I suggest you type in the examples at the bottom of the help page one line at a time (yes, actually type the whole thing in one line at a time and see what they all do, youâ€™ll pick up stuff very quickly and the typing rather than copypasting is an important part of helping to commit it to memory.) 2.12 vector å‡½æ•¸ç¯„ä¾‹ 2.12.1 cbind,rbind x&lt;-runif(5) y&lt;-runif(6) cbind(x,y) Warning in cbind(x, y): number of rows of result is not a multiple of vector length (arg 1) x y [1,] 0.0808 0.466 [2,] 0.8343 0.498 [3,] 0.6008 0.290 [4,] 0.1572 0.733 [5,] 0.0074 0.773 [6,] 0.0808 0.875 2.12.2 å‡½æ•¸diff Arguments * x: a numeric vector or matrix containing the values to be differenced. * lag: an integer indicating which lag to use. * differences: an integer indicating the order of the difference. ä¾‹å¦‚ diff(x,lag=d,differences=n) x[(1+d):n] - x[1:(n-d)] 2.13 ç·´ç¿’: åˆªé™¤å‘é‡ä¸­çš„ä¸€å€‹å…ƒç´  x&lt;-c(1,2,3) å¦‚ä½•åˆªé™¤xä¸­çš„ç¬¬2å€‹å…ƒç´  ? hint: æ•¸å­—å‘é‡å…ƒç´ çš„åˆªé™¤ ï¼Œä¸èƒ½åƒæ˜¯list[2]&lt;-NULL ï¼Œè«‹å•ä½ çš„è§£æ³•ï¼Ÿ ä¸¦èªªæ˜ ç‰©ä»¶å…ƒç´ çš„åˆªé™¤ï¼Œç°¡å–®ä¸€é»çš„åƒæ˜¯listï¼Œ x&lt;-list(1,2,3) x[2]&lt;-NULL x ä½†æ˜¯å‘é‡å…ƒç´ çš„åˆªé™¤æ²’æœ‰æ·å¾‘ x&lt;-c(1,2,3) x[2]&lt;-NULL Error in x[2] å› æ­¤ï¼Œéœ€è¦è®Šé€šçš„è¾¦æ³• æ–¹æ³•1ï¼š x&lt;-c(1,2,3) t&lt;-as.list(x) # note: ä½¿ç”¨list(x)è€Œä¸æ˜¯as.list(x)æœƒæœ‰ä»€éº¼ä¸åŒ t[2]&lt;-NULL x&lt;-unlist(t) x [1] 1 3 æ–¹æ³•2ï¼š x&lt;-c(1,2,3) y&lt;-x[-2] x&lt;-y ç·´ç¿’ï¼šæ”¹ç‚ºå‡½æ•¸ delElement&lt;-function(x,idx){ if (is.vector(x)){ t&lt;-as.list(x) t[idx]&lt;-NULL t&lt;-unlist(t) return(t) } else { stop(&#39;must be vector&#39;) } } x&lt;-c(1,2,3) x&lt;-delElement(x,2) x [1] 1 3 2.13.1 Adding Attributes to Vectors The attributes that you can add to vectors includes names and comments. If we continue with our vector v1 we can see that the vector currently has no attributes: v1 &lt;- 8:17 attributes(v1) NULL We can add names to vectors using two approaches. The first uses names() to assign names to each element of the vector. The second approach is to assign names when creating the vector. # assigning names to a pre-existing vector names(v1) &lt;- letters[1:length(v1)] v1 a b c d e f g h i j 8 9 10 11 12 13 14 15 16 17 attributes(v1) $names [1] \"a\" \"b\" \"c\" \"d\" \"e\" \"f\" \"g\" \"h\" \"i\" \"j\" é‚£ï¼Œä»€éº¼æ˜¯names(v1) names(v1) [1] \"a\" \"b\" \"c\" \"d\" \"e\" \"f\" \"g\" \"h\" \"i\" \"j\" ä¹Ÿå°±æ˜¯èªªnames()å‡½æ•¸è¿”å›æ¯å€‹å…ƒç´ çš„åå­ï¼Œè€Œattributes()è¿”å›çš„æ˜¯æœ‰ä»€éº¼å±¬æ€§ï¼Œä¹Ÿæ˜¯å‡½æ•¸åç¨±å­—é¢ä¸Šçš„æ„æ€ã€‚ä½†æ˜¯å†ä»”ç´°çœ‹çœ‹ï¼Œå¯ä»¥ç™¼ç¾æŒ‡æ´¾attribute çµ¦ attributes(v1)&lt;-list(x=&#39;&#39;,y=&#39;&#39;,z=&#39;&#39;) v1 [1] 8 9 10 11 12 13 14 15 16 17 attr(,\"x\") [1] \"\" attr(,\"y\") [1] \"\" attr(,\"z\") [1] \"\" æ¸¬è©¦æ˜¯å¦å¯ä»¥è‡ªè¡ŒåŠ å…¥attributesï¼Œç„¶å¾Œè®“names()å¯ä»¥é‹ä½œï¼Œå¦‚ä¸‹ï¼š attributes(v1)&lt;-list(names=letters[1:10]) v1 a b c d e f g h i j 8 9 10 11 12 13 14 15 16 17 attributes(v1) $names [1] \"a\" \"b\" \"c\" \"d\" \"e\" \"f\" \"g\" \"h\" \"i\" \"j\" names(v1) [1] \"a\" \"b\" \"c\" \"d\" \"e\" \"f\" \"g\" \"h\" \"i\" \"j\" ä¸Šé¢é€™å€‹ç¨‹å¼æš—ç¤ºäº†ä»€éº¼ï¼Ÿ &gt;å‡½æ•¸names()åªæ˜¯attributes()&lt;-çš„ä¸€å€‹ç‰¹ä¾‹ï¼Œæˆ‘å€‘ç¸½æ˜¯å¯ä»¥è‡ªè¡ŒåŠ å…¥ä¸€å€‹å±¬æ€§ï¼Œåç¨±ç‚ºnamesè®“å‡½æ•¸names()å¯ä»¥æŠŠæ¯å€‹å…ƒç´ çš„åç¨±åˆ—å°å‡ºä¾†ã€‚ å¾Œé¢é€™æ®µç¨‹å¼ç¢¼åªæ˜¯å°ç…§ä¸€ä¸‹ä¹‹å‰æ¯å€‹å…ƒç´ åŠ å…¥åç¨±çš„ä½œæ³•ï¼Œæœ¬èº«æ²’æ„ç¾©ï¼š # adding names when creating vectors v2 &lt;- c(name1 = 1, name2 = 2, name3 = 3) v2 name1 name2 name3 1 2 3 attributes(v2) $names [1] \"name1\" \"name2\" \"name3\" ä¹Ÿå¯ä»¥åŠ å…¥è¨»è§£ï¼š comment(v1) &lt;- &quot;This is a comment on a vector&quot; v1 a b c d e f g h i j 8 9 10 11 12 13 14 15 16 17 attributes(v1) $names [1] \"a\" \"b\" \"c\" \"d\" \"e\" \"f\" \"g\" \"h\" \"i\" \"j\" $comment [1] \"This is a comment on a vector\" 2.14 matrix çŸ©é™£çš„å»ºç«‹æœ‰å¤šç¨®æ–¹å¼,å…¶ä¸­ä¸€ç¨®æ˜¯åˆ©ç”¨å‘é‡è½‰å¡«çŸ©é™£ï¼Œå¡«å…¥çš„æ–¹å¼é è¨­æ˜¯ä»¥coumnç‚ºä¸»è¦æ–¹å‘ã€‚ matrix(c(1,2,3,4,5,6),2,3) [,1] [,2] [,3] [1,] 1 3 5 [2,] 2 4 6 å•é¡Œ: æ€æ¨£ç”¢ç”Ÿ 1 2 3 4 5 6 çš„çŸ©é™£ diag(1, nrow = 5) [,1] [,2] [,3] [,4] [,5] [1,] 1 0 0 0 0 [2,] 0 1 0 0 0 [3,] 0 0 1 0 0 [4,] 0 0 0 1 0 [5,] 0 0 0 0 1 matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow = 3, byrow = TRUE, dimnames = list(c(&quot;r1&quot;, &quot;r2&quot;, &quot;r3&quot;), c(&quot;c1&quot;, &quot;c2&quot;, &quot;c3&quot;))) c1 c2 c3 r1 1 2 3 r2 4 5 6 r3 7 8 9 m1 &lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), ncol = 3) rownames(m1) &lt;- c(&quot;r1&quot;, &quot;r2&quot;, &quot;r3&quot;) colnames(m1) &lt;- c(&quot;c1&quot;, &quot;c2&quot;, &quot;c3&quot;) m1 c1 c2 c3 r1 1 4 7 r2 2 5 8 r3 3 6 9 B = matrix( c(2, 4, 3, 1, 5, 7), nrow=3, ncol=2) B [,1] [,2] [1,] 2 1 [2,] 4 5 [3,] 3 7 2.14.1 Transpose t(B) [,1] [,2] [,3] [1,] 2 4 3 [2,] 1 5 7 2.14.2 åˆä½µçŸ©é™£ åˆ©ç”¨å‡½æ•¸cbind() å¯ä»¥åˆä½µåŒæ¨£æ©«è¡Œæ•¸ç›®çš„å…©å€‹çŸ©é™£,ä¾‹å¦‚é€™è£¡Cä¹Ÿæ˜¯3å€‹æ©«è¡Œ: C = matrix( c(7, 4, 2), nrow=3, ncol=1) C [,1] [1,] 7 [2,] 4 [3,] 2 å’ŒBåˆä½µ cbind(B, C) [,1] [,2] [,3] [1,] 2 1 7 [2,] 4 5 4 [3,] 3 7 2 åŒæ¨£çš„,rbind() ä¹Ÿå¯ä»¥åˆä½µç›´è¡Œæ•¸ç›®ç›¸åŒçš„å…©å€‹çŸ©é™£: D = matrix( c(6, 2), nrow=1, ncol=2) D [,1] [,2] [1,] 6 2 rbind(B, D) [,1] [,2] [1,] 2 1 [2,] 4 5 [3,] 3 7 [4,] 6 2 å°‡çŸ©é™£è§£æ§‹å›å‘é‡: å¯ä»¥åˆ©ç”¨c() æœƒæŠŠçŸ©é™£æ‰€æœ‰çš„ç›´è¡Œéƒ½åˆä½µæˆä¸€å€‹ç›´è¡Œ. c(B) [1] 2 4 3 1 5 7 unlist ? ç·´ç¿’:åˆ©ç”¨ä¸Šé¢çš„m1 å›ç­”ä¸‹é¢çš„å•é¡Œ: m1[1, 2] m1[1:2, 2:3] m1[1,] m1[,2] m1[1:2,] m1[, 2:3] m1[-1,] m1[,-2] m1[c(â€œr1â€, â€œr3â€), c(â€œc1â€, â€œc3â€)] m1[1] m1[9] m1[3:7] m1 &gt; 3 m1[m1 &gt; 3] m1 + m1 m1 - 2m1 m1 m1 m1 / m1 m1 ^ 2 m1 %*% m1 t(m1) 2.15 å­—ä¸²å‡½æ•¸ 2.15.0.1 asic character string functions provided by R: nchar: string length paste: concatenate strings substr: substring toupper: convert entire string to uppercase tolower: convert entire string to lowercase chartr: character map replacement (like â€œtrâ€) strtrimï¼štrunates string nchar, substr, toupper, tolower will accept string vectors as arguments and return vector results. strtrim accepts both a vector of strings and a vector of truncation positions. \\': ç­‰åŒæ–¼ \"'\" . \\\": ç­‰åŒæ–¼ '\"'. \\n: newline. \\r: carriage return. \\t: tab character. Note: cat() and print() è™•ç†é€ƒé€¸å­—å…ƒçš„æ–¹å¼ä¸ä¸€æ¨£å¦‚æœè¦åœ¨è¢å¹•ä¸Šè§£è®€ä¸Šé¢çš„å­—ä¸²,éœ€è¦çš„æ˜¯ cat(). print(&quot;a\\nb&quot;) [1] \"a\\nb\" cat(&quot;a\\nb&quot;) a b å•é¡Œ: 1. è§£é‡‹paste0(c(1,2),c(3,4),collapse=â€™â€™) 2. æ€æ¨£å¾—åˆ°â€œ1234â€ 2.15.1 æ‡‰ç”¨ç¯„ä¾‹macro version 1 x&lt;- &quot;${1} is good&quot; gsub(&quot;\\\\$\\\\{1\\\\}&quot;,&quot;dog&quot;,x) [1] \"dog is good\" ** version 2 to function** mstr&lt;-function (src,mto) { return (gsub(&quot;\\\\$\\\\{1\\\\}&quot;,mto,src)) } x&lt;- &quot;${1} is good&quot; mstr(x,&quot;dog&quot;) [1] \"dog is good\" 2.15.2 paste paste0(&quot;x&quot;,&quot;y&quot;,&quot;z&quot;) [1] \"xyz\" 2.15.3 misc . The get() and assign() functions allow you to reference objects by character strings, and as.name() will convert a string into a reference (you would then probably need to use substitute() to create an expression and eval()) to evaluate it. eg assign(&quot;a&quot;,get(&quot;b&quot;)) does a&lt;-b Often there is a better way: the objects can be stored in a list, making it possible to use character strings directly to reference them If obj&lt;-list(a=1,b=2) then obj[[â€œaâ€]] is a reference to the â€œaâ€ element and you can do eg obj[[â€œaâ€]]&lt;-otherobj[[â€œbâ€]] 2.16 Factors Rä¹Ÿèƒ½æŠŠè³‡æ–™å­˜ç‚ºfactor(store data is as a factor)ã€‚ åœ¨å¤§éƒ¨åˆ†å¯¦é©—ä¸­,æŸäº›è§£é‡‹è®Šæ•¸ç¶“å¸¸æœ‰ä¸åŒç¨‹åº¦çš„æ¸¬è©¦ã€‚ å¤§æ„å¦‚ä¸‹ï¼š &gt;â€¦ includes trials for different levels of some explanatory variable. &gt;The different levels are also called factors. 2.16.1 æ¢ç´¢ä¸€ä¸‹factors fert = c(10,20,20,50,10,20,10,50,20) fert = factor(fert,levels=c(10,20,50),ordered=TRUE) levels()å¯ä»¥é¡¯ç¤ºfactorçš„æ¨™ç±¤ levels(fert) [1] \"10\" \"20\" \"50\" fert çš„å…§å®¹ï¼Œå¦‚æœå¿½ç•¥æ¨™ç±¤æœ¬èº«ï¼Œå…¶å¯¦å·²ç¶“æ˜¯æ•¸å­—ã€‚ fert [1] 10 20 20 50 10 20 10 50 20 Levels: 10 è¨ˆç®—å¹³å‡ mean(fert) Warning in mean.default(fert): argument is not numeric or logical: returning NA [1] NA mean(as.numeric(levels(fert)[fert])) [1] 23.3 è§£é‡‹ï¼š levels(fert) ç”¢ç”Ÿä¸€å€‹ã€Œå­—ä¸²å‘é‡ã€ï¼Œå…§å®¹ç‚º10, 20, 50ï¼Œå¦‚ä¸‹å¯è­‰ï¼š str(levels(fert)) chr [1:3] \"10\" \"20\" \"50\" ç„¶å¾Œå¦‚æœæŠŠfertæƒ³ç¨‹å¼æ•¸å­—å…§å®¹ï¼Œä¾‹å¦‚(1,2,1) å‰‡ï¼Œé€™æ˜¯ç´¢å¼•ã€‚å°±åƒé€™æ¨£ c(â€œaâ€,â€œbâ€,â€œcâ€)[c(1,1,2,3,2)] ==&gt; a,a,b,c,b ã€‚ ä¸Šé¢çš„å•é¡Œï¼Œå¯ä»¥ç°¡åŒ–ç‚ºï¼šæ‰¾å›åŸä¾†é‚„æ²’è¢«factorçš„å‘é‡ã€‚ x&lt;-c(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;) x&lt;-factor(x) # ç¾åœ¨xæ˜¯ä¸€å€‹factor x&lt;-levels(x)[x] #ç¾åœ¨åˆè¢«è½‰å›åŸä¾†çš„x 2.16.2 æ¢ç´¢ä¸€ä¸‹factor a &lt;- factor(c(&quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;B&quot;, &quot;B&quot;, &quot;C&quot;, &quot;A&quot;, &quot;C&quot;)) é æœŸç­”æ¡ˆæ˜¯factor,okã€‚ class(a) [1] \"factor\" å› ç‚ºaå·²ç¶“è¢«ç·¨ç¢¼ï¼Œé æœŸæ˜¯numericï¼Œé€™è£¡ç­”æ¡ˆç›´æ¥çµ¦å®šinteger: typeof(a) [1] \"integer\" aæ˜¯ä¸€å€‹factor,æ‰€ä»¥a[]ä»£è¡¨açš„ä¸€å€‹å­é›†åˆï¼Œå› æ­¤çµæœçœ‹èµ·ä¾†ä¹Ÿæ˜¯é¡ä¼¼åŸä¾†açš„å‹æ…‹ï¼š a[1] [1] A Levels: A B C é©—è­‰æ˜¯ä¸æ˜¯å’Œä¸Šé¢çš„è¡¨ç¤ºæ–¹å¼ä¸€æ¨£ï¼š a [1] A A B A B B C A C Levels: A B C æ‰€ä»¥ï¼Œa,a[]éƒ½æ˜¯é¡å‹ç‚ºfactorçš„è®Šæ•¸ã€‚ æŒ‰ç…§ä¹‹é–“[]å’Œ[[]]çš„è¦å‰‡ï¼Œé€™è£¡æœƒå‡ºç¾ä»€éº¼ï¼Ÿ a[[1]] [1] A Levels: A B C å‡ºç¾çš„çµæœå’Œa[1]ä¸€æ¨£ï¼Œé€™èªªæ˜äº†ï¼Œaçš„çµæ§‹ä¸æ˜¯list,åˆ©ç”¨str()å‡½æ•¸çœ‹ä¸€ä¸‹ç¢ºèªï¼š str(a) Factor w/ 3 levels \"A\",\"B\",\"C\": 1 1 2 1 2 2 3 1 3 ç¸½ä¹‹ï¼Œa[1] a[[1]] éƒ½æ˜¯Factor æ²’æœ‰[ å’Œ [[ çš„åˆ†åˆ¥ã€‚é€™å¾ˆå¥½è¨˜ï¼Œå› ç‚ºé€™å€‹factorä¹Ÿæ˜¯rçš„å…§å»ºè³‡æ–™å‹æ…‹ã€‚ å…¶ä»–é©—è­‰å¦‚ä¸‹ï¼Œè‡ªè¡Œæ¨æ•²ï¼š > typeof(a[[1]]) [1] \"integer\" > typeof(a[1]) [1] \"integer\" > class(a[[1]]) [1] \"factor\" > class(a[1]) [1] \"factor\" åˆæœ‰æ–°çš„å•é¡Œäº†ï¼Œåˆ°åº•table(a),summary(a)çš„è³‡æ–™çµæ§‹æ˜¯ä»€éº¼ï¼Ÿ str(table(a)) 'table' int [1:3(1d)] 4 3 2 - attr(*, \"dimnames\")=List of 1 ..$ a: chr [1:3] \"A\" \"B\" \"C\" str(summary(a)) Named int [1:3] 4 3 2 - attr(*, \"names\")= chr [1:3] \"A\" \"B\" \"C\" class(table(a)) [1] \"table\" class(summary(a)) [1] \"integer\" åˆä¾†ä¸€å€‹è®“äººç„¡è¨€çš„åœ°æ–¹ï¼Œè¼¸å‡ºæ¨£å­çœ‹èµ·ä¾†å¾ˆåƒï¼Œä½†æ˜¯çµæ§‹ä¸€å€‹æ˜¯é¡åˆ¥tableä¸€å€‹æ˜¯ã€Œæ•´æ•¸å‘é‡ã€ï¼Œç„¶å¾Œæ¯å€‹å…ƒç´ éƒ½æ˜¯å› å­çš„ç™¼ç”Ÿæ¬¡æ•¸ï¼Œå¸¶æœ‰å› å­åå­—ï¼Œé€™è£¡æ˜¯â€œAâ€,â€œBâ€,â€œCâ€ã€‚ 2.16.3 factor å’Œå‡½æ•¸read.csv() read.csv() é€šå¸¸ç”¢ç”Ÿä¸€å€‹data.frameçš„é¡åˆ¥ã€‚ä½†æ˜¯åœ¨è®€æª”çš„æ™‚å€™ï¼Œå¦‚æœé‡åˆ°å­—ä¸²æ¬„ä½ï¼Œæœƒå°‡å­—ä¸²æ¬„ä½é è¨­è½‰ç‚ºfactoræ¬„ä½ã€‚ è§€å¯Ÿcarbon dioxide å°æ¨¹æœ¨çš„ç”Ÿé•·é€Ÿç‡ trees91.csv 1^: tree = read.csv(&quot;./resources/trees91.csv&quot;, header = TRUE, sep = &quot;,&quot;); attributes(tree) $names [1] \"C\" \"N\" \"CHBR\" \"REP\" \"LFBM\" \"STBM\" \"RTBM\" \"LFNCC\" [9] \"STNCC\" \"RTNCC\" \"LFBCC\" \"STBCC\" \"RTBCC\" \"LFCACC\" \"STCACC\" \"RTCACC\" [17] \"LFKCC\" \"STKCC\" \"RTKCC\" \"LFMGCC\" \"STMGCC\" \"RTMGCC\" \"LFPCC\" \"STPCC\" [25] \"RTPCC\" \"LFSCC\" \"STSCC\" \"RTSCC\" $class [1] \"data.frame\" $row.names [1] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 [51] 51 52 53 54 names(tree) [1] \"C\" \"N\" \"CHBR\" \"REP\" \"LFBM\" \"STBM\" \"RTBM\" \"LFNCC\" [9] \"STNCC\" \"RTNCC\" \"LFBCC\" \"STBCC\" \"RTBCC\" \"LFCACC\" \"STCACC\" \"RTCACC\" [17] \"LFKCC\" \"STKCC\" \"RTKCC\" \"LFMGCC\" \"STMGCC\" \"RTMGCC\" \"LFPCC\" \"STPCC\" [25] \"RTPCC\" \"LFSCC\" \"STSCC\" \"RTSCC\" A description of the data file is located at http://cdiac.ornl.gov/ftp/ndp061a/ndp061a.txt . 2.16.4 factor å’Œå‡½æ•¸summary() summary(tree$CHBR) Length Class Mode 54 character character åœ¨CHBRé€™å€‹æ¬„ä½ä¸­,å› ç‚ºä¸å…¨éƒ½æ˜¯æ•¸å­—,å› æ­¤Rè‡ªå‹•å‡å®šé€™æ˜¯ä¸€å€‹factorã€‚ å› æ­¤é‡å°é€™å€‹æ¬„ä½summary()å‡½æ•¸ä¸æœƒåˆ—å‡º5å€‹çµ±è¨ˆé‡,è€Œæ˜¯åˆ—å‡ºæ¬¡æ•¸è¡¨ã€‚å› ç‚ºï¼Œä¸€æ—¦å‘é‡è½‰ç‚ºä¸€çµ„factors, 5å€‹åŸºæœ¬çµ±è¨ˆé‡ä¸å†æœ‰æ„ç¾©ã€‚ ä½†æœ‰äº›æ¬„ä½ä¾‹å¦‚C,ä¹Ÿæ˜¯ä¸€å€‹factorã€‚ä½†æ˜¯,Rèªå®šç‚ºæ•¸å­—,é€™æ™‚å¿…é ˆæ‰‹å‹•è™•ç†ã€‚ ä»¥ä¸‹å°‡ tree$C è½‰ç‚º factor: tree$C [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 summary(tree$C) Min. 1st Qu. Median Mean 3rd Qu. Max. 1.00 2.00 2.00 2.52 3.00 4.00 tree$C &lt;- factor(tree$C) tree$C [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 Levels: 1 2 3 4 summary(tree$C) 1 2 3 4 8 23 10 13 levels(tree$C) [1] \"1\" \"2\" \"3\" \"4\" node: summary() å‡½æ•¸ï¼Œåƒè€ƒtableä¸€ç¯€ã€‚ 2.17 Data Frames 2.17.1 ç°¡å–®ä»‹ç´¹ä¸€ä¸‹æ‰‹å‹•å»ºç«‹data.frame 3å€‹æ¬„ä½ï¼Œåˆ†åˆ¥æ˜¯a,b,f a &lt;- c(1, 2, 3, 4) b &lt;- c(2, 4, 6, 8) levels &lt;- factor(c(&quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;B&quot;)) bubba &lt;- data.frame(first = a, second = b, f = levels) bubba first second f 1 1 2 A 2 2 4 B 3 3 6 A 4 4 8 B summary(bubba) first second f Min. :1.00 Min. :2.0 A:2 1st Qu.:1.75 1st Qu.:3.5 B:2 Median :2.50 Median :5.0 Mean :2.50 Mean :5.0 3rd Qu.:3.25 3rd Qu.:6.5 Max. :4.00 Max. :8.0 bubba$first [1] 1 2 3 4 bubba$second [1] 2 4 6 8 bubba$f [1] A B A B Levels: A B 2.17.2 data frame çš„å¸¸ç”¨å‡½æ•¸ï¼š head() - shows first 6 rows tail() - shows last 6 rows dim() - returns the dimensions of data frame (i.e. number of rows and number of columns) nrow() - number of rows ncol() - number of columns str() - structure of data frame - name, type and preview of data in each column names() - shows the names attribute for a data frame, which gives the column names. sapply(dataframe, class) - shows the class of each column in the data frame å›åˆ°ä¹‹å‰åˆ©ç”¨read.csvè®€å…¥çš„data.frame : tree # é †ä¾¿çœ‹çœ‹çµæ§‹ typeof(tree) [1] \"list\" class(tree) [1] \"data.frame\" is.data.frame(tree) [1] TRUE æ—¢ç„¶treeæ˜¯ä¸€å€‹list,é‚£éº¼[]å’Œ[[]]çš„æ‡‰ç”¨å°±å’Œä¹‹å‰è¨è«–çš„ä¸€æ¨£ï¼š tree[1] C 1 1 2 1 3 1 4 1 5 1 6 1 7 1 8 1 9 2 10 2 11 2 12 2 13 2 14 2 15 2 16 2 17 2 18 2 19 2 20 2 21 2 22 2 23 2 24 2 25 2 26 2 27 2 28 2 29 2 30 2 31 2 32 3 33 3 34 3 35 3 36 3 37 3 38 3 39 3 40 3 41 3 42 4 43 4 44 4 45 4 46 4 47 4 48 4 49 4 50 4 51 4 52 4 53 4 54 4 tree[[1]] [1] 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 [39] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 Levels: 1 2 3 4 class(tree[1]) # data.frame [1] \"data.frame\" class(tree[[1]]) # integer [1] \"factor\" typeof(tree[1]) # list [1] \"list\" typeof(tree$C) # integer [1] \"integer\" typeof(tree[[1]]) # integer [1] \"integer\" tree[1] æ˜¯ä¸€å€‹list tree[[1]] å¤–åœçš„tree[]é¦–å…ˆè¢«è§£è®€ç‚ºlisté¡åˆ¥,ç„¶å¾Œ[1]å‚³åˆ°é¡åˆ¥ [[ vs [ ç”±typeof,classçœ‹èµ·ä¾† [[æŠ½å–listä¸­çš„å…ƒç´  [åªæ˜¯åˆ†å‰²list,ä¸­çš„subset 2.18 Tables é™¤äº†data frame ä»¥å¤–,é‚„æœ‰table å¯ä»¥ç”¨ä¾†çµ„ç¹”è³‡æ–™ã€‚ é€™è£¡åªçœ‹æ€æ¨£å»ºç«‹table,åˆ†æçœ‹å…¶ä»–ç« ç¯€ã€‚ 2.18.1 One Way Tables table()æŒ‡ä»¤: é€™å€‹æŒ‡ä»¤é€šå¸¸ç”¨ä¾†å»ºç«‹å› å­ä¹‹é–“çš„é—œè¯è¡¨(contingency table)ã€‚åƒæ•¸é€šå¸¸æ˜¯ä¸€å€‹ã€Œå› å­å‘é‡ã€(factor vector)ã€‚ ä¾‹å¦‚å»ºç«‹ä¸€å€‹å–®å› å­é—œè¯è¡¨ï¼ˆone way tableï¼‰: a &lt;- factor(c(&quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;B&quot;, &quot;B&quot;, &quot;C&quot;, &quot;A&quot;, &quot;C&quot;)) table_a &lt;- table(a) table_aï¼š table_a a A B C 4 3 2 attributeså¯ä»¥çœ‹å‡ºtable_aè£¡é¢æœ‰å“ªäº›å¸¶åå…ƒç´  attributes(table_a) $dim [1] 3 $dimnames $dimnames$a [1] \"A\" \"B\" \"C\" $class [1] \"table\" summary(table_a) Number of cases in table: 9 Number of factors: 1 å°ç…§table(a)ï¼Œç›´æ¥æŠŠfactor è®Šæ•¸ï¼Œä»£å…¥summary()çœ‹ä¸€ä¸‹ï¼Œçµæœæ˜¯æ¬¡æ•¸åˆ†é…è¡¨ï¼ˆå¦‚ä¸‹ï¼‰ table(a) a A B C 4 3 2 summary(a) A B C 4 3 2 å•é¡Œï¼šå¦‚æœæˆ‘å€‘çŸ¥é“Aæœ‰4,å€‹,Bæœ‰3å€‹,Cæœ‰2å€‹,èƒ½ä¸èƒ½ç›´æ¥å»ºç«‹table? 1. å…ˆå»ºç«‹matrix 2. å†åŠ å…¥æ¬„ä½åç¨± 3. åˆ©ç”¨å‡½æ•¸as.table() # step 1 occur &lt;- matrix(c(4, 3, 2), ncol = 3, byrow = TRUE) occur [,1] [,2] [,3] [1,] 4 3 2 #step 2 colnames(occur) &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;) occur A B C [1,] 4 3 2 #step 3 occur &lt;- as.table(occur) occur A B C A 4 3 2 attributes(occur) $dim [1] 1 3 $dimnames $dimnames[[1]] [1] \"A\" $dimnames[[2]] [1] \"A\" \"B\" \"C\" $class [1] \"table\" 2.18.2 Two Way Tables é€™å€‹ä¾‹å­ä¸­æœ‰å…©å€‹å•é¡Œ:ç¬¬1å€‹å•é¡Œçš„ç­”æ¡ˆæœ‰â€œNever,â€ â€œSometimes,â€ or â€œAlways.â€ ç¬¬2å€‹å•é¡Œçš„ç­”æ¡ˆæœ‰ â€œYes,â€ â€œNo,â€ or â€œMaybe.â€ å…©å€‹å•é¡Œåˆ†åˆ¥ä»¥å‘é‡a,bå­˜æ”¾( The set of vectors â€œa,â€ and â€œb,â€ contain the response for each measurement.) a &lt;- c(&quot;Sometimes&quot;, &quot;Sometimes&quot;, &quot;Never&quot;, &quot;Always&quot;, &quot;Always&quot;, &quot;Sometimes&quot;, &quot;Sometimes&quot;, &quot;Never&quot;) b &lt;- c(&quot;Maybe&quot;, &quot;Maybe&quot;, &quot;Yes&quot;, &quot;Maybe&quot;, &quot;Maybe&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;) results &lt;- table(a, b) results b a Maybe No Yes Always 2 0 0 Never 0 1 1 Sometimes 2 1 1 åœ¨è¡¨æ ¼ä¸­,å¯ä»¥çœ‹åˆ°åŒæ™‚å›ç­” â€œMaybeâ€ â€œSometimesâ€ çš„å€‹æ•¸æœ‰å¹¾å€‹ã€‚ é€™è£¡æ˜¯å¦ä¸€å€‹ç›´æ¥ç”±æˆ‘å€‘çŸ¥é“çš„æ•¸æ“šå»ºç«‹tableçš„ä¾‹å­ sexsmoke &lt;- matrix(c(70, 120, 65, 140), ncol = 2, byrow = TRUE) rownames(sexsmoke) &lt;- c(&quot;male&quot;, &quot;female&quot;) colnames(sexsmoke) &lt;- c(&quot;smoke&quot;, &quot;nosmoke&quot;) sexsmoke &lt;- as.table(sexsmoke) sexsmoke smoke nosmoke male 70 120 female 65 140 2.19 OOP advance R ### Base objects vs OO objects è¾¨åˆ¥è®Šæ•¸æ˜¯åŸºç¤å‹åˆ¥æˆ–æ˜¯ç‰©ä»¶å‹åˆ¥ï¼Œå¯ä»¥ç°¡å–®åˆ©ç”¨å‡½æ•¸ï¼š is.object(): åŸºç¤ç‰©ä»¶base object: is.object(1:10) [1] FALSE [1] FALSE ç‰©ä»¶å°å‘ç‰©ä»¶ OO object is.object(mtcars) [1] TRUE [1] TRUE ä¸»è¦çš„å€åˆ¥åœ¨æ–¼åŸºæœ¬ç‰©ä»¶æ²’æœ‰class é€™å€‹attribute attr(1:10, &quot;class&quot;) # NULL NULL attr(mtcars, &quot;class&quot;) # [1] &quot;data.frame&quot; [1] \"data.frame\" class()é€™å€‹å‡½æ•¸,ä¸è¦‹å¾—ç¸½æ˜¯æœƒå’Œattr()çš„çµæœä¸€è‡´,å› ç‚ºï¼Œå°åŸºæœ¬ç‰©ä»¶è€Œè¨€,å‚³å›çš„æ˜¯å¾Œé¢è¨è«–,è€Œä¸æ˜¯ NULLã€‚ 2.19.1 è®Šæ•¸å±¬æ€§æŸ¥è©¢å‡½æ•¸ names() dimnames() length() dim(): å„ç¶­åº¦é•·åº¦ class() : è®Šæ•¸é¡åˆ¥ table()ï¼šå„é¡è³‡æ–™è¨ˆæ•¸ str()ï¼šè®Šæ•¸çš„è³‡æ–™çµæ§‹(å…¶å¯¦æ˜¯ä¸€å€‹list) é€énames()å‡½æ•¸ï¼Œå¯å–å¾—å„ç¨®listå…ƒç´ çš„åç¨±,ä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡æ˜¯é¡¯ç¤ºæ¬„ä½åç¨± islandsæ˜¯å…§å»ºè³‡æ–™ str(islands) Named num [1:48] 11506 5500 16988 2968 16 ... - attr(*, \"names\")= chr [1:48] \"Africa\" \"Antarctica\" \"Asia\" \"Australia\" ... head(names(islands)) [1] \"Africa\" \"Antarctica\" \"Asia\" \"Australia\" \"Axel Heiberg\" [6] \"Baffin\" æ–¹å½¢è³‡æ–™ï¼ˆä¾‹å¦‚ï¼ŒçŸ©é™£ï¼Œtable, data.frame)ï¼Œå¯ä»¥é€édimnames()å‡½æ•¸å¯é¡¯ç¤ºdata.frame æ©«è¡Œå’Œç›´è¡Œçš„åç¨± å…ˆæ©«è¡Œï¼Œç„¶å¾Œç›´è¡Œã€‚ dimnames(USArrests) [[1]] [1] \"Alabama\" \"Alaska\" \"Arizona\" \"Arkansas\" [5] \"California\" \"Colorado\" \"Connecticut\" \"Delaware\" [9] \"Florida\" \"Georgia\" \"Hawaii\" \"Idaho\" [13] \"Illinois\" \"Indiana\" \"Iowa\" \"Kansas\" [17] \"Kentucky\" \"Louisiana\" \"Maine\" \"Maryland\" [21] \"Massachusetts\" \"Michigan\" \"Minnesota\" \"Mississippi\" [25] \"Missouri\" \"Montana\" \"Nebraska\" \"Nevada\" [29] \"New Hampshire\" \"New Jersey\" \"New Mexico\" \"New York\" [33] \"North Carolina\" \"North Dakota\" \"Ohio\" \"Oklahoma\" [37] \"Oregon\" \"Pennsylvania\" \"Rhode Island\" \"South Carolina\" [41] \"South Dakota\" \"Tennessee\" \"Texas\" \"Utah\" [45] \"Vermont\" \"Virginia\" \"Washington\" \"West Virginia\" [49] \"Wisconsin\" \"Wyoming\" [[2]] [1] \"Murder\" \"Assault\" \"UrbanPop\" \"Rape\" æ–¹å½¢è³‡æ–™ï¼Œå¯ä»¥é€élength()å‡½æ•¸å¯é¡¯ç¤ºè³‡æ–™é•·åº¦ï¼Œä½†æ˜¯å¦‚æœæ˜¯data.frameå‰‡é¡¯ç¤ºæ¬„ä½æ•¸ã€‚ length(islands) [1] 48 é€édim() é¡¯ç¤ºæ–¹å½¢è³‡æ–™çš„ã€Œè³‡æ–™ç­†æ•¸ã€å’Œã€Œæ¬„ä½æ•¸ç›®ã€ï¼Œå…ˆã€Œæ©«è¡Œã€ï¼Œå¾Œã€Œç›´è¡Œã€ dim(USArrests) [1] 50 4 ä½¿ç”¨class()å‡½æ•¸å¯çŸ¥é“è®Šæ•¸é¡åˆ¥ class(pi) [1] \"numeric\" class(Sys.Date()) [1] \"Date\" ä½¿ç”¨table()å‡½æ•¸å¯çŸ¥é“å‘é‡ä¸­æ¯å€‹å€¼å‡ºç¾å¹¾æ¬¡ table(iris$Species) ##çµ±è¨ˆçµæœ setosa versicolor virginica 50 50 50 2.20 operator %&gt;% %&gt;% ä¸æ˜¯RåŸºç¤å¥—ä»¶ è€Œæ˜¯å®šç¾©å†å¥—ä»¶ magrittr (CRAN) ä¸”å¸¸è·Ÿ dplyr (CRAN)æ­é…ã€‚ æ„æ€æ˜¯æŠŠå·¦é‚Š(LHS)ç•¶æˆå³é‚Š(RHS)çš„åƒæ•¸ã€‚ ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­: è³‡æ–™æ¡†iris ç”¨ä¾†ç•¶ head()çš„åƒæ•¸: ä¹Ÿå°±æ˜¯èªª iris %&gt;% head() ç›¸ç•¶æ–¼ head(iris). library(magrittr) iris %&gt;% head() Sepal.Length Sepal.Width Petal.Length Petal.Width Species 1 5.1 3.5 1.4 0.2 setosa 2 4.9 3.0 1.4 0.2 setosa 3 4.7 3.2 1.3 0.2 setosa 4 4.6 3.1 1.5 0.2 setosa 5 5.0 3.6 1.4 0.2 setosa 6 5.4 3.9 1.7 0.4 setosa ç‚ºç”šéº¼éœ€è¦é€™æ¨£ç”¨,ä¸‹é¢æ˜¯ä¸€å€‹ä¾‹å­ iris %&gt;% head() %&gt;% summary() é¡ä¼¼çš„è§€å¿µ, iris %&gt;% head() %&gt;% summary() ç­‰åŒæ–¼summary(head(iris)). ä¹Ÿå°±æ˜¯èªª,é¿å…äº†ä½¿ç”¨å·¢ç‹€å‘¼å«ã€‚ 2.21 apply family å…¶ä»–åƒè€ƒ 2.21.1 apply å¯ä»¥è™•ç†çš„å°è±¡åŒ…æ‹¬ çŸ©é™£ã€è³‡æ–™é›†ã€é™£åˆ—(äºŒç¶­ã€å¤šç¶­)ï¼Œå¯ä»¥æŒ‡å®šç›´è¡Œã€æ©«è¡Œã€‚ å‡½æ•¸å®šç¾©ï¼š apply(X, MARGIN, FUN, ...) åƒæ•¸åˆ—è¡¨ï¼š - X : çŸ©é™£matrixã€è³‡æ–™é›†dataframe ã€é™£åˆ— array - MARGIN : 1è¡¨ç¤ºæ©«è¡Œï¼Œ2è¡¨ç¤ºç›´è¡Œ - FUN : the function to be applied - â€¦ : optional arguments to FUN ç¯„ä¾‹1 x&lt;-matrix(1,ncol=4,nrow=3);x [,1] [,2] [,3] [,4] [1,] 1 1 1 1 [2,] 1 1 1 1 [3,] 1 1 1 1 apply(x,1,sum) [1] 4 4 4 ç¯„ä¾‹ï¼š æœ‰ä¸€å€‹list,è£¡é¢æœ‰2å€‹æ¬„ä½ï¼Œåˆ†åˆ¥æ˜¯x1,x2,æƒ³è¦åˆ†åˆ¥ç®—å‡ºæ¯å€‹æ¬„ä½çš„æœ€å°å’Œæœ€å¤§ x &lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£ f1&lt;- function(col) { c(min(col),max(col)) } apply(x,2,f1) x1 x2 [1,] 3 1 [2,] 3 6 ç·´ç¿’ï¼šå¦‚æœç”¨for loop? ç·´ç¿’ï¼šå“ªç¨®æ–¹å¼æ¯”è¼ƒå¿«ï¼Ÿhint:åˆ©ç”¨ system.time(a function) 2.21.2 lapplyå‡½æ•¸ å’Œapplyä¸åŒçš„åœ°æ–¹æ˜¯,æ²’è¾¦æ³•æŒ‡å®šæ©«è¡Œæˆ–æ˜¯ç›´è¡Œçš„å€åˆ¥,åªèƒ½æ˜¯é€å€‹å…ƒç´ é‹ç®—ã€‚ å¤§ç¶±ï¼šlapply(),sapply(),vapply() éƒ½åƒæ•¸éƒ½åƒlist æˆ–è€…vectorã€‚ * lapply(), sapply()å·®åˆ¥æ˜¯ å‰è€…è¿”å›list,å¾Œè€…è¿”å›matrix; * sapply(), vapply() å·®åˆ¥æ˜¯ï¼Œå¾Œè€…å¯ä»¥åŠ å…¥row namesã€‚ lapply çš„åƒæ•¸æ˜¯ listã€data.frameï¼Œç„¶å¾Œè¿”å›å’ŒXé•·åº¦åŒæ¨£çš„listçµæ§‹ä½œç‚ºçµæœã€‚ å‡½æ•¸å®šç¾©ï¼š lapply(X, FUN, ...) åƒæ•¸åˆ—è¡¨ï¼š X: listã€vectorã€data.frame FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸ è¼¸å…¥ è¼¸å‡º vector list list list data.frame list æ¯”å¦‚ï¼Œè¨ˆç®—listä¸­çš„æ¯å€‹KEYå°æ‡‰ çš„5å€‹Tukeyåˆ†ä½æ•¸ (minimum, lower-hinge, median, upper-hinge, maximum) ã€‚åˆ©ç”¨fivenum() x &lt;- list(a = 1:6, b = rnorm(2,6,8));x $a [1] 1 2 3 4 5 6 $b [1] -5.20 8.04 lapply(x,fivenum) $a [1] 1.0 2.0 3.5 5.0 6.0 $b [1] -5.20 -5.20 1.42 8.04 8.04 å¦‚æœå‚³å…¥çš„åƒæ•¸æ˜¯data.frame(),å¦‚ä¸‹ï¼Œå°è³‡æ–™é›†çš„æ¯å€‹æ¬„ä½æ±‚å’Œã€‚ lapply(data.frame(x), sum) $a [1] 21 $b [1] 8.53 note: å¦‚æœå‚³å…¥çš„åƒæ•¸æ˜¯çŸ©é™£ï¼Œå‰‡æœƒå°æ¯å€‹å…ƒç´ æ±‚å‡½æ•¸å€¼ã€‚ x &lt;- matrix(rnorm(4,5,10),nrow=2);x [,1] [,2] [1,] -19.37 11.2 [2,] 4.94 16.5 lapply(x, sum) [[1]] [1] -19.4 [[2]] [1] 4.94 [[3]] [1] 11.2 [[4]] [1] 16.5 2.21.3 sapplyå‡½æ•¸ sapplyå‡½æ•¸åŒ…è£¹äº†ä¸€ä¸Šé¢æåˆ°çš„lapply()ï¼Œè¿”å›å€¼ç‚ºå‘é‡ï¼Œè€Œä¸æ˜¯listå°è±¡ã€‚sapplyå¢åŠ äº†2å€‹åƒæ•¸simplifyå’ŒUSE.NAMESï¼Œ å‡½æ•¸å®šç¾©ï¼š sapply(X, FUN, ..., simplify=TRUE, USE.NAMES = TRUE) åƒæ•¸åˆ—è¡¨ï¼š X: listã€matrixã€data.frame FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸ simplify: é è¨­ç‚ºT,è¿”ç‚ºå€¼ç‚ºå‘é‡ï¼›å¦‚æœæ˜¯Fæˆlistã€‚? è¨­å®šç‚ºâ€œarrayâ€æ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„ USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½® è¼¸å…¥ è¼¸å‡º vector vector,matrix,array,list list vector,matrix,array,list data.frame vector,matrix,array,list note: å¦‚æœæˆ‘å€‘åˆ©ç”¨å‡½æ•¸unlist é…åˆ lapply çš„è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°å‘é‡ï¼Œä¾‹å¦‚ï¼š unlist(lapply(1:3, function(x) x^2)) x &lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£ x x1 x2 [1,] 3 1 [2,] 3 2 [3,] 3 3 [4,] 3 4 [5,] 3 5 [6,] 3 6 sapply(x, sum) #çµæœé¡ä¼¼lapply() [1] 3 3 3 3 3 3 1 2 3 4 5 6 # data.frame sapply(data.frame(x), sum) x1 x2 18 21 # ç¢ºèªè¿”å›é¡åˆ¥ class(lapply(x, sum)) [1] \"list\" class(sapply(x, sum)) [1] \"numeric\" class(sapply(x, sum, simplify=FALSE, USE.NAMES=FALSE)) [1] \"list\" èªªæ˜æ›¸æåˆ°ï¼šsimplify=FALSEå’ŒUSE.NAMES=FALSEï¼Œå‰‡ sapplyå‡½æ•¸ ï¼lapplyå‡½æ•¸ã€‚ ç·´ç¿’ï¼šè§£é‡‹ä¸‹é¢çš„è¼¸å‡ºçµæœã€‚ x &lt;- cbind(x1 = 3, x2 = c(1:6)) sapply(x, quantile) [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] 0% 3 3 3 3 3 3 1 2 3 4 5 6 25% 3 3 3 3 3 3 1 2 3 4 5 6 50% 3 3 3 3 3 3 1 2 3 4 5 6 75% 3 3 3 3 3 3 1 2 3 4 5 6 100% 3 3 3 3 3 3 1 2 3 4 5 6 sapply(2:4, seq) [[1]] [1] 1 2 [[2]] [1] 1 2 3 [[3]] [1] 1 2 3 4 hint: sapplyçš„èª¿ç”¨å‡½æ•¸lapply()ï¼Œè€Œå·²ç¶“çŸ¥é“lapply()çš„åƒæ•¸æ˜¯çŸ©é™£çš„æ™‚å€™ï¼Œæ¯å€‹å…ƒç´ éƒ½æœƒè¢«å‚³åˆ°å‡½æ•¸ã€‚å› æ­¤æ¬„ä½æœ‰12å€‹ï¼›åˆï¼Œæ¯å€‹quantile()å‚³å›5å€‹å…ƒç´ ï¼Œå› æ­¤ï¼Œæ©«è¡Œæœ‰5å€‹ã€‚ æ­£ç¢ºçš„ä½œæ³•æ˜¯ï¼š x &lt;- list(x1 = 3, x2 = c(1:6)) sapply(x, quantile) x1 x2 0% 3 1.00 25% 3 2.25 50% 3 3.50 75% 3 4.75 100% 3 6.00 ç¯„ä¾‹ï¼šUSE.NAMES=TRUE alist&lt;-list(a=c(1,1,1),b=c(2,2,2),c=c(3,3,3)) f2&lt;-function(x) { mean(alist[[x]]) } sapply(c(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;),f2,USE.NAMES = T) a b c 1 2 3 å°æ–¼simplifyç‚ºarrayæ™‚ï¼Œæˆ‘å€‘å¯ä»¥åƒè€ƒä¸‹é¢çš„ä¾‹å­ï¼Œæ§‹å»ºä¸€å€‹ä¸‰ç¶­æ•¸çµ„ï¼Œå…¶ä¸­äºŒå€‹ç¶­åº¦ç‚ºæ–¹é™£ã€‚ a&lt;-1:2 # æŒ‰æ•¸çµ„åˆ†çµ„ sapply(a,function(x) matrix(x,2,2), simplify=&#39;array&#39;) , , 1 [,1] [,2] [1,] 1 1 [2,] 1 1 , , 2 [,1] [,2] [1,] 2 2 [2,] 2 2 # é»˜èªæƒ…æ³ï¼Œå‰‡è‡ªå‹•åˆä½µåˆ†çµ„ sapply(a,function(x) matrix(x,2,2)) [,1] [,2] [1,] 1 2 [2,] 1 2 [3,] 1 2 [4,] 1 2 2.21.4 æ¯”è¼ƒ Function Arguments Objective Input Output apply apply(x, MARGIN, FUN) Apply a function to the rows or columns or both Data frame or matrix vector, list, array lapply lapply(X, FUN) Apply a function to all the elements of the input List, vector or data frame list sapply sappy(X FUN) Apply a function to all the elements of the input List, vector or data frame vector or matrix m&lt;-matrix(1:4,4,3);m [,1] [,2] [,3] [1,] 1 1 1 [2,] 2 2 2 [3,] 3 3 3 [4,] 4 4 4 sapply(1:3, function(x) mean(m[,x])) [1] 2.5 2.5 2.5 m&lt;-matrix(1:4,4,3); lapply(1:3, function(x) mean(m[,x])) [[1]] [1] 2.5 [[2]] [1] 2.5 [[3]] [1] 2.5 2.21.5 vapplyå‡½æ•¸ vapplyé¡ä¼¼æ–¼sapplyï¼Œæä¾›äº†FUN.VALUEåƒæ•¸ï¼Œç”¨ä¾†æ§åˆ¶è¿”å›å€¼çš„è¡Œåã€‚ note: sapply() é…ä¸Šrownames&lt;- å¯ä»¥é”åˆ°ä¸€æ¨£çš„æ•ˆæœã€‚ å‡½æ•¸å®šç¾©ï¼š vapply(X, FUN, FUN.VALUE, ..., USE.NAMES = TRUE) åƒæ•¸åˆ—è¡¨ï¼š X:æ•¸çµ„ã€çŸ©é™£ã€æ•¸æ“šæ¡† FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ FUN.VALUE: å¯ä»¥è¨˜ç‚ºå°æ¯ä¸€ç´€éŒ„çµ¦åç¨±(e.g. row.names) â€¦: æ›´å¤šåƒæ•¸ï¼Œå¯é¸ USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½® x &lt;- cbind(x1 = 3, x2 = c(1:6)); # x æ˜¯çŸ©é™£ x&lt;-data.frame(x) # ä¸èƒ½æ˜¯çŸ©é™£ f1&lt;- function(col) { c(min(col),max(col)) } vapply(x,f1,FUN.VALUE = c(&quot;min&quot;=0,&quot;max&quot;=0)) # FUN.VALUE æ˜¯ä¸€å€‹named vector x1 x2 min 3 1 max 3 6 # vapply(x,f1,FUN.VALUE = c(&quot;min&quot;,&quot;max&quot;)) # éŒ¯èª¤ 2.21.6 mapplyå‡½æ•¸ å‡½æ•¸å®šç¾©ï¼š mapply(FUN, ..., MoreArgs = NULL, SIMPLIFY = TRUE,USE.NAMES = TRUE) åƒæ•¸åˆ—è¡¨ï¼š FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ â€¦: æ¥æ”¶å¤šå€‹æ•¸æ“š MoreArgs: åƒæ•¸åˆ—è¡¨ SIMPLIFY: æ˜¯å¦è½‰çŸ©é™£ï¼Œç•¶å€¼arrayæ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„ USE.NAMES: å¦‚æœXç‚ºå­—ç¬¦ä¸²ï¼ŒTRUEè¨­ç½®å­—ç¬¦ä¸²ç‚ºæ•¸æ“šåï¼ŒFALSEä¸è¨­ç½® å¦‚æœFun=f(x)ï¼Œå‰‡ mapply(f,a1,a2)çš„åŸ·è¡Œæ˜¯ï¼š f(a1), f(a2) å¦‚æœFun=f(x,y)ï¼Œå‰‡ mapply(f,a1,a2)çš„åŸ·è¡Œæ˜¯ï¼š f(a1, a2) æ¯”å¦‚ï¼Œæ¯”è¼ƒ3å€‹å‘é‡å¤§å°ï¼ŒæŒ‰ç´¢å¼•é †åºå–è¼ƒå¤§çš„å€¼ã€‚ set.seed(1) # å®šç¾©3å€‹å‘é‡ x&lt;-1:10 y&lt;-5:-4 z&lt;-round(runif(10,-5,5)) # æŒ‰ç´¢å¼•é †åºå–è¼ƒå¤§çš„å€¼ã€‚ mapply(max,x,y,z) [1] 5 4 3 4 5 6 7 8 9 10 å†çœ‹ä¸€å€‹ä¾‹å­ï¼Œç”Ÿæˆ4å€‹ç¬¦åˆæ­£æ…‹åˆ†ä½ˆçš„æ•¸æ“šé›†ï¼Œåˆ†åˆ¥å°æ‡‰çš„å‡å€¼å’Œæ–¹å·®ç‚ºc(1,10,100,1000)ã€‚ set.seed(1) # é•·åº¦ç‚º4 n&lt;-rep(4,4) # mç‚ºå‡å€¼ï¼Œvç‚ºæ–¹å·® m&lt;-v&lt;-c(1,10,100,1000) # ç”Ÿæˆ4çµ„æ•¸æ“šï¼ŒæŒ‰åˆ—åˆ†çµ„ mapply(rnorm,n,m,v) [,1] [,2] [,3] [,4] [1,] 0.374 13.3 157.6 379 [2,] 1.184 1.8 69.5 -1215 [3,] 0.164 14.9 251.2 2125 [4,] 2.595 17.4 139.0 955 2.21.7 tapplyå‡½æ•¸ tapplyç”¨æ–¼åˆ†çµ„çš„å¾ªç’°è¨ˆç®—ï¼Œé€šéINDEXåƒæ•¸å¯ä»¥æŠŠæ•¸æ“šé›†Xé€²è¡Œåˆ†çµ„ï¼Œç›¸ç•¶æ–¼group byçš„æ“ä½œã€‚ å‡½æ•¸å®šç¾©ï¼š tapply(X, INDEX, FUN = NULL, ..., simplify = TRUE) åƒæ•¸åˆ—è¡¨ï¼š X: å‘é‡ INDEX: ç”¨æ–¼åˆ†çµ„çš„ç´¢å¼• FUN: è‡ªå®šç¾©çš„èª¿ç”¨å‡½æ•¸ â€¦: æ¥æ”¶å¤šå€‹æ•¸æ“š simplify : æ˜¯å¦æ•¸çµ„åŒ–ï¼Œç•¶å€¼arrayæ™‚ï¼Œè¼¸å‡ºçµæœæŒ‰æ•¸çµ„é€²è¡Œåˆ†çµ„ æ¯”å¦‚ï¼Œè¨ˆç®—ä¸åŒå“ç¨®çš„é³¶å°¾èŠ±çš„èŠ±ç“£(iris)é•·åº¦çš„å‡å€¼ã€‚ # é€šéiris$Specieså“ç¨®é€²è¡Œåˆ†çµ„ tapply(iris$Petal.Length,iris$Species,mean) setosa versicolor virginica 1.46 4.26 5.55 åˆ†çµ„æ±‚å’Œçš„ç¯„ä¾‹ã€‚ set.seed(1) x&lt;-1:10 # äº‚è¡“åˆ†æˆ3çµ„ï¼Œåˆ†åˆ¥æ˜¯0,1,2 t&lt;-round(runif(10,1,100)%%2);t [1] 1 2 2 1 1 2 1 0 1 1 # å°xé€²è¡Œåˆ†çµ„æ±‚å’Œ tapply(x,t,sum) 0 1 2 8 36 11 2.21.8 rapplyå‡½æ•¸ 2.21.9 eapplyå‡½æ•¸ å‡½æ•¸å®šç¾©ï¼š eapply(env, FUN, ..., all.names = FALSE, USE.NAMES = TRUE) ç·´ç¿’ï¼š 1 æŠŠiris æ¯å€‹æ¬„ä½çš„åŠ ç¸½åˆ—å‡º iris æœ‰ä¸€å€‹æ¬„ä½æ˜¯factor 2.21.10 ç¯„ä¾‹ 2.21.10.1 å°‡æ¯å€‹rmdæª”æ¡ˆä¸­éœ€è¦çš„å‡½æ•¸åº«åˆ—è¡¨ #setwd(~/directory1/) libs = lapply(list.files(pattern = &quot;\\\\.Rmd$&quot;), function(x){ d = readLines(x) d = d[grepl(&quot;library\\\\(.*\\\\)&quot;, d)] gsub(&quot;library\\\\((.*)\\\\)&quot;, &quot;\\\\1&quot;, d) }) unique(unlist(libs)) note: grepl : é‚è¼¯å€¼ gsub : åªæ‹¿å–library(â€œå‡½æ•¸åº«åç¨±â€)ä¸­çš„â€œå‡½æ•¸åº«åç¨±â€ã€‚ 2.22 ç›¸é—œæ“ä½œ practice1.R 2.22.1 å•é¡Œ:æƒ³è¦çŸ¥é“æœ‰ç”šéº¼è³‡æ–™åº«å¯ä»¥ç”¨? ä¾‹å¦‚ï¼Œ æƒ³è¦çŸ¥é“è³‡æ–™åº«è£é¢æœ‰æ²’æœ‰â€™mtcarsâ€™ hint: grep(â€˜patternâ€™,target) l&lt;-list(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) grep(&#39;a&#39;,l) [1] 1 åˆ©ç”¨æŒ‡ä»¤data()å¯ä»¥åˆ—å‡ºå…§å»ºè³‡æ–™ï¼š xx&lt;-data() xx æ˜¯ç”šéº¼?ç›´æ¥æ‰“å…¥xxä¸¦æ²’æœ‰åƒå…¶ä»–è®Šæ•¸ä¸€æ¨£ï¼Œåœ¨consoleé¡¯ç¤ºå…§å®¹ï¼š xx str(xx) List of 4 $ title : chr \"Data sets\" $ header : NULL $ results: chr [1:167, 1:4] \"forcats\" \"stringr\" \"stringr\" \"stringr\" ... ..- attr(*, \"dimnames\")=List of 2 .. ..$ : NULL .. ..$ : chr [1:4] \"Package\" \"LibPath\" \"Item\" \"Title\" $ footer : chr \"Use 'data(package = .packages(all.available = TRUE))'\\nto list the data sets in all *available* packages.\" - attr(*, \"class\")= chr \"packageIQR\" is.data.frame(xx) [1] FALSE is.list(xx) [1] TRUE is.table(xx) [1] FALSE class(xx) [1] \"packageIQR\" class()å‡½æ•¸èªªæ˜xxæ˜¯ä¸€å€‹packageIQRç‰©ä»¶ã€‚str()å¯ä»¥çœ‹å‡ºæ˜¯ä¸€å€‹é•·åº¦ç‚º4çš„listï¼Œå…¶ä¸­resultsæ¨™ç±¤ï¼Œæ˜¯ä¸€å€‹å­—ä¸²çŸ©é™£ï¼Œå¤§å°ç‚º104 x 4ã€‚å…¶ä¸­4å€‹æ¬„ä½çš„åç¨±ç‚ºï¼šâ€œPackageâ€ â€œLibPathâ€ â€œItemâ€ â€œTitleâ€ï¼ˆå¦‚ä¸‹ï¼‰ï¼š head(xx$results) Package LibPath Item [1,] \"forcats\" \"C:/Program Files/R/R-4.0.2/library\" \"gss_cat\" [2,] \"stringr\" \"C:/Program Files/R/R-4.0.2/library\" \"fruit\" [3,] \"stringr\" \"C:/Program Files/R/R-4.0.2/library\" \"sentences\" [4,] \"stringr\" \"C:/Program Files/R/R-4.0.2/library\" \"words\" [5,] \"tidyr\" \"C:/Program Files/R/R-4.0.2/library\" \"billboard\" [6,] \"tidyr\" \"C:/Program Files/R/R-4.0.2/library\" \"construction\" Title [1,] \"A sample of categorical variables from the General Social survey\" [2,] \"Sample character vectors for practicing string manipulations.\" [3,] \"Sample character vectors for practicing string manipulations.\" [4,] \"Sample character vectors for practicing string manipulations.\" [5,] \"Song rankings for billboard top 100 in the year 2000\" [6,] \"Completed construction in the US in 2018\" å¦‚æœè¦ºå¾—æ··äº‚,å¯ä»¥åˆ©ç”¨ View(xx$results) å› ç‚ºæ˜¯çŸ©é™£,æ‰€ä»¥ä¸èƒ½ä»¥ã€Œ$ã€å¾—åˆ°Itemçš„å…§å®¹? xx$results$Item Error in xx$results$Item: $ operator is invalid for atomic vectors head(xx$results[,&#39;item&#39;]) Error in xx$results[, \"item\"]: ä¸‹æ¨™è¶…å‡ºé‚Šç•Œ ç‚ºç”šéº¼éŒ¯èª¤? å› ç‚ºå¤§å°å¯«,æ‰€ä»¥æ­£ç¢ºå¯«æ³•ç‚ºï¼š head(xx$results[,&#39;Item&#39;]) [1] \"gss_cat\" \"fruit\" \"sentences\" \"words\" \"billboard\" [6] \"construction\" åˆ©ç”¨grep()å¯ä»¥æ‹¿åˆ°mtcarsçš„ä½ç½®ï¼š idx&lt;-grep(&#39;mtcars&#39;,xx$results[,&#39;Item&#39;]) idx [1] 135 ç¢ºèª xx$results[idx,&#39;Item&#39;] Item \"mtcars\" 2.23 å¸¸è¦‹éŒ¯èª¤ 2.23.1 error l0 &lt;- list(1, c(TRUE, FALSE), c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)) l0 éŒ¯èª¤å¿µæ³• l0ç­‰æ–¼ä¸€å€‹åˆ—è¡¨listï¼Œè£¡é¢æœ‰ä¸‰å€‹å…ƒç´ ï¼Œç¬¬ä¸€å€‹å…ƒç´ æ˜¯1ï¼Œç¬¬äºŒå€‹å…ƒç´ æ˜¯c(TRUE, FALSE)ï¼Œç¬¬ä¸‰å€‹å…ƒç´ æ˜¯c(â€œaâ€, â€œbâ€, â€œcâ€) æ­£ç¢ºå¿µæ³•ï¼š æ­£ç¢ºå¿µæ³• æŒ‡æ´¾ä¸€å€‹listçµ¦è®Šæ•¸l0ï¼Œè£¡é¢æœ‰ä¸‰å€‹å…ƒç´ ï¼Œç¬¬ä¸€å€‹å…ƒç´ æ˜¯ç´”é‡1ï¼Œç¬¬äºŒå€‹å…ƒç´ æ˜¯é‚è¼¯å‘é‡ï¼Œé•·åº¦ç‚º2ï¼Œå…§å®¹åˆ†åˆ¥æ˜¯TRUE, FALSEï¼Œç¬¬ä¸‰å€‹å…ƒç´ æ˜¯å­—å…ƒå‘é‡ï¼Œé•·åº¦ç‚º3ï¼Œå…§å®¹åˆ†åˆ¥æ˜¯â€œaâ€, â€œbâ€, â€œcâ€ names(l1) &lt;- c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;) éŒ¯èª¤å¿µæ³• è¨­å®šnames(li)ç­‰æ–¼é›†åˆ(â€œAâ€,â€œBâ€,â€œCâ€) æ­£ç¢ºå¿µæ³•ï¼š å°‡l1 é€™å€‹list çš„å‰3å€‹å…ƒç´ åç¨±ï¼Œåˆ†åˆ¥æŒ‡å®šç‚º A,B,C 2.23.2 error l1$x &lt;- NULL æ­£ç¢ºå¿µæ³•ï¼š åˆªé™¤å…ƒç´ åç‚ºxçš„å…ƒç´ ã€‚ 2.23.3 error l0 &lt;- list(1, c(TRUE, FALSE), c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)) l1 &lt;- list(x = 1, y = c(TRUE, FALSE), z = c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)) l1$x l1$y l1$z l1$m æ›´æ­£å¿µæ³• å»ºç«‹listè®Šæ•¸l1,åç¨±åˆ†åˆ¥æ˜¯x,y,z,å…§å®¹åˆ†åˆ¥æ˜¯â€¦â€¦. l1\\(y ç‚ºé‚è¼¯å‘é‡ l1\\)z ç‚ºå­—å…ƒå‘é‡ å°¤å…¶æ˜¯é€™å¥ â€”-&gt; ?? l1 yç”¢ç”Ÿå…©æ¬¡é‚è¼¯é‹ç®—ã€‚?? &lt;â€”- é‚è¼¯é‹ç®—æŒ‡çš„æ˜¯ and, or å› æ­¤ï¼Œæ‡‰è©²èªª l1$y æ˜¯é‚è¼¯å‘é‡ï¼Œå…ƒç´ æœ‰2å€‹ã€‚ "],
["regular-expression-syntax.html", "Chapter 3 Regular expression syntax", " Chapter 3 Regular expression syntax åˆ©ç”¨ä¸€äº›ç‰¹æ®Šå­—å…ƒï¼Œä¾‹å¦‚ $ * + . ? [ ] ^ { } | ( ) \\æ§‹æˆRegular expressionsï¼Œç”¨ä¾†åœ¨æ–‡å­—ä¸­è¡¨é”æŸäº›æœå°‹æ¨£å¼çš„èªæ³•ã€‚ é€™è£¡åªæ˜¯ç°¡çŸ­çš„ä»‹ç´¹ 3.0.0.1 Functions which work with regular expression patterns strsplit: split string into substrings at occurances of regexp grep: search for a regular expression within a string sub: search and then replace an occurance of a regular expression in a strng gsub: global search and replace all occurances of a regular expression in a string 3.0.1 Escape sequences æ­£è¦è¡¨é”å¼ä¸­.ä»£è¡¨ä»»æ„å­—å…ƒ,ä½†æ˜¯å¦‚æœæˆ‘å€‘è¦åœ¨å­—ä¸²ä¸­æŸ¥æ‰¾â€œ.â€(ä¾‹å¦‚,æª”æ¡ˆåç¨±ä¸­çš„é») çš„æ™‚å€™è¦æ€æ¨£è¡¨ç¤º?ç­”æ¡ˆæ˜¯ä½¿ç”¨é€ƒé€¸å­—å…ƒ\\ã€‚ä½†æ˜¯åœ¨Rèªè¨€ä¸­,æ­£è¦è¡¨é”å¼ï¼Œä¹Ÿæ˜¯ä½¿ç”¨å­—ä¸²ï¼Œå¯æ˜¯åœ¨å­—ä¸²ä¸­,\\æœ¬èº«å°±é€ƒé€¸å­—å…ƒï¼Œå› æ­¤éœ€è¦\\\\.ã€‚ dot &lt;- &quot;\\\\.&quot; writeLines(dot) \\. x &lt;- &quot;a\\\\b&quot; writeLines(x) a\\b 3.0.1.1 grep, grepl grep,greplçš„å·®åˆ¥æ˜¯å¾Œè€…ä¸æ”¯æ´åƒæ•¸valueï¼Œä¸”æ¯”å°çš„çµæœå’Œæœå°‹å…§å®¹çš„å€‹æ•¸ç›¸åŒã€‚ grep(&quot;a\\\\.c&quot;, c(&quot;abc&quot;, &quot;a.c&quot;, &quot;bef&quot;)) [1] 2 grep(&quot;a\\\\.c&quot;, c(&quot;abc&quot;, &quot;a.c&quot;, &quot;bef&quot;),value=TRUE) [1] \"a.c\" grepl(&quot;a\\\\.c&quot;, c(&quot;abc&quot;, &quot;a.c&quot;, &quot;bef&quot;)) [1] FALSE TRUE FALSE åˆå¦ä¸€å€‹ä¾‹å­,æ˜¯åœ¨å­—ä¸²ä¸­å°‹æ‰¾å–®å¼•è™Ÿ,å‡å®šè¦åœ¨åœ‹å®¶ä¸­æ‰¾å°‹æ˜¯å¦æœ‰åç¨±åŒ…å«å–®å¼•è™Ÿçš„åå­—,å¯ä»¥ä½¿ç”¨'\\'' å•é¡Œ:ç‚ºç”šéº¼ä¸æ˜¯'\\\\'' hint: é€™è£¡çš„é€ƒé€¸å­—å…ƒåªæ˜¯å­—ä¸²çš„æ¨™æº–ç”¨æ³•,'ä¸æ˜¯æ­£è¦è¡¨é”å¼çš„ç‰¹æ®Šå­—å…ƒã€‚ country&lt;-read.delim(&#39;resources/country.txt&#39;,header=FALSE) names(country)&lt;-&quot;Name&quot; cname &lt;-levels(country$Name) grep(&#39;\\&#39;&#39;, cname, value = TRUE) character(0) note: * ä¸æ˜¯country.names&lt;-â€œNameâ€ å•é¡Œ:ä¸‹é¢å…©è¡Œæœ‰ç”šéº¼å·®åˆ¥? grep(&#39;\\&#39;&#39;, country$Name, value = TRUE) grep(&#39;\\&#39;&#39;, levels(country$Name), value = TRUE) Hint: levels å‚³å›å”¯ä¸€å€¼ levels(factor(c(&quot;a&quot;,&quot;b&quot;,&quot;a&quot;))) [1] \"a\" \"b\" factor(c(&quot;a&quot;,&quot;b&quot;,&quot;a&quot;)) [1] a b a Levels: a b 3.0.1.2 regexpr, gregexpr regexpr å‡½æ•¸çš„ä½¿ç”¨æ–¹å¼é¡ä¼¼greplã€‚å‚³å›æ•´æ•¸å‘é‡(è¡¨ç¤ºç¬¦åˆä½ç½®ï¼Œå¦‚æœæ‰¾ä¸åˆ°,å‰‡å‚³å›-1),å€‹æ•¸å’Œæ¯”å°å­—ä¸²ä¸²åˆ—ç›¸åŒã€‚é€™å€‹å‘é‡åŒæ™‚æœ‰å±¬æ€§match.length(åƒè€ƒç¯„ä¾‹) . s&lt;-&quot;a.b.c.9&quot; regexpr(&#39;b&#39;,s ) [1] 3 attr(,\"match.length\") [1] 1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE regexpr(&#39;.&#39;,s ) # è¦å®šä½ç¬¦è™Ÿã€Œ.ã€,é€™æ˜¯éŒ¯çš„,\\.ä¹ŸéŒ¯ [1] 1 attr(,\"match.length\") [1] 1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE regexpr(&#39;\\\\.&#39;,s ) # æ­£ç¢º [1] 2 attr(,\"match.length\") [1] 1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE regexpr(&#39;[.]&#39;,s ) # æ­£ç¢º ,ä¸éœ€è¦regexpr(&#39;[\\\\.]&#39;,s ) [1] 2 attr(,\"match.length\") [1] 1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE regexpr(&#39;\\\\d&#39;,s ) # æ­£ç¢º [1] 7 attr(,\"match.length\") [1] 1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE x&lt;-regexpr(&#39;[0-9]&#39;,s ) # æ­£ç¢º attr(x,&quot;match.length&quot;) [1] 1 s&lt;-&quot;a.b.c.9 6 8&quot; x&lt;-regexpr(&#39;[0-9]&#39;,s ) x [1] 7 attr(,\"match.length\") [1] 1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE attr(x,&quot;match.length&quot;) [1] 1 gregexpr() å’Œ regexpr()ä¸€æ¨£,ä¸åŒçš„æ˜¯æœƒåœ¨ç›®æ¨™å­—ä¸²ä¸­æœå°‹æ‰€æœ‰ç¬¦åˆçš„ä½ç½®è€Œä¸æ˜¯åªæ‰¾ç¬¬ä¸€å€‹(g:å…¨å±€)ã€‚ å› æ­¤å‚³å›çš„çµæœå€‹æ•¸é›–ç„¶å’ŒæŸ¥æ‰¾çš„ä¸²åˆ—å…ƒç´ å€‹æ•¸ä¸€æ¨£,ä½†æ˜¯æ¯å€‹å…ƒç´ éƒ½æ˜¯ä¸€å€‹å‘é‡ã€‚å¦‚æœéƒ½æ²’æ‰¾åˆ°,åªæœ‰ä¸€å€‹-1ã€‚ s&lt;-&quot;a.b.c.9 6 8&quot; gregexpr(&#39;[0-9]&#39;,s ) [[1]] [1] 7 9 11 attr(,\"match.length\") [1] 1 1 1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE 3.0.2 æ‡‰ç”¨ ç”¢ç”Ÿ3å€‹æª”æ¡ˆ,æª”æ¡ˆåç¨±å«æœ‰cat file.create(c(&quot;xcat1.rmd&quot;, &quot;ycat2.txt&quot;, &quot;zcat3.rmd&quot;)) [1] TRUE TRUE TRUE files&lt;-list.files(&quot;.&quot;) grep(&quot;cat&quot;, files, value = TRUE) [1] \"xcat1.rmd\" \"ycat2.txt\" \"zcat3.rmd\" grep(&quot;cat&quot;, files, value = FALSE) [1] 69 71 72 grepl(&quot;cat&quot;, files) [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE TRUE TRUE 3.0.3 æ•¸é‡ä¿®é£¾è©Quantifiers æŒ‡å®šé‡è¤‡æ¬¡æ•¸. *: è‡³å°‘0å€‹ã€‚ +: è‡³å°‘ä¸€å€‹. ?: æœ€å¤šä¸€å€‹. {n}: å‰›å¥½nå€‹. {n,}: è‡³å°‘nå€‹. {n,m}: æ¬¡æ•¸åœ¨ n åˆ° m ä¹‹é–“(åŒ…æ‹¬n,m). (strings &lt;- c(&quot;a&quot;, &quot;ab&quot;, &quot;acb&quot;, &quot;accb&quot;, &quot;acccb&quot;, &quot;accccb&quot;)) [1] \"a\" \"ab\" \"acb\" \"accb\" \"acccb\" \"accccb\" grep(&quot;ac*b&quot;, strings, value = TRUE) [1] \"ab\" \"acb\" \"accb\" \"acccb\" \"accccb\" grep(&quot;ac+b&quot;, strings, value = TRUE) [1] \"acb\" \"accb\" \"acccb\" \"accccb\" grep(&quot;ac?b&quot;, strings, value = TRUE) [1] \"ab\" \"acb\" grep(&quot;ac{2}b&quot;, strings, value = TRUE) [1] \"accb\" grep(&quot;ac{2,}b&quot;, strings, value = TRUE) [1] \"accb\" \"acccb\" \"accccb\" grep(&quot;ac{2,3}b&quot;, strings, value = TRUE) [1] \"accb\" \"acccb\" 3.0.3.1 Exercise Find all countries with ee in Gapminder using quantifiers. character(0) 3.0.4 Position of pattern within the string ^: å­—ä¸²é–‹é ­. $: å­—ä¸²çµå°¾. \\b: å·¦å³éƒ½ç©ºç™½çš„ word. \\B: å·¦å³ä¸æ˜¯ç©ºç™½ word. (strings &lt;- c(&quot;abcd&quot;, &quot;cdab&quot;, &quot;cabd&quot;, &quot;c abd&quot;)) [1] \"abcd\" \"cdab\" \"cabd\" \"c abd\" grep(&quot;ab&quot;, strings, value = TRUE) [1] \"abcd\" \"cdab\" \"cabd\" \"c abd\" grep(&quot;^ab&quot;, strings, value = TRUE) [1] \"abcd\" grep(&quot;ab$&quot;, strings, value = TRUE) [1] \"cdab\" grep(&quot;\\\\bab&quot;, strings, value = TRUE) [1] \"abcd\" \"c abd\" regexpr(&quot;\\\\bab&quot;, strings) [1] 1 -1 -1 3 attr(,\"match.length\") [1] 2 -1 -1 2 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE regexpr(&quot;\\\\Bab&quot;, strings) [1] -1 3 2 -1 attr(,\"match.length\") [1] -1 2 2 -1 attr(,\"index.type\") [1] \"chars\" attr(,\"useBytes\") [1] TRUE 3.0.4.1 Exercise Find all .txt files in the repository. [1] \"ycat2.txt\" [1] \"ycat2.txt\" 3.0.5 Operators .: ä»»æ„å­—å…ƒã€‚ [...]: ä¾‹å¦‚,[ade] 3å€‹å­—å…ƒå…¶ä¸­ä¸€å€‹ã€‚[a-e],aåˆ°e. [^...]: é™¤äº†[]æŒ‡å®šçš„å­—å…ƒï¼Œé[â€¦]çš„æ„æ€ã€‚. \\: æŠ‘åˆ¶ä¸‹åˆ—å­—å…ƒåœ¨å­—ä¸²,\"\",ä¸­çš„ç‰¹æ®Šæ„æ€ $ * + . ? [ ] ^ { } | ( ) \\, åªæ˜¯åœ¨Rä¸­,å› ç‚º\\åˆæœ‰ç‰¹æ®Šæ„ç¾© ,å› æ­¤å¿…é ˆé›™\\ä¾‹å¦‚ \\\\$ã€‚ |: æˆ–. (...): å­—å…ƒçµ„,æ ¹æ“šå‡ºç¾çš„é †åº,å¯ä»¥ç”¨ \\\\Nè­˜åˆ¥( backreference). (strings &lt;- c(&quot;^ab&quot;, &quot;ab&quot;, &quot;abc&quot;, &quot;abd&quot;, &quot;abe&quot;, &quot;ab 12&quot;)) [1] \"^ab\" \"ab\" \"abc\" \"abd\" \"abe\" \"ab 12\" grep(&quot;ab.&quot;, strings, value = TRUE) [1] \"abc\" \"abd\" \"abe\" \"ab 12\" grep(&quot;ab[c-e]&quot;, strings, value = TRUE) [1] \"abc\" \"abd\" \"abe\" grep(&quot;ab[^c]&quot;, strings, value = TRUE) [1] \"abd\" \"abe\" \"ab 12\" grep(&quot;^ab&quot;, strings, value = TRUE) [1] \"ab\" \"abc\" \"abd\" \"abe\" \"ab 12\" grep(&quot;\\\\^ab&quot;, strings, value = TRUE) [1] \"^ab\" grep(&quot;abc|abd&quot;, strings, value = TRUE) [1] \"abc\" \"abd\" gsub(&quot;(ab) 12&quot;, &quot;\\\\1 34&quot;, strings) [1] \"^ab\" \"ab\" \"abc\" \"abd\" \"abe\" \"ab 34\" note: è¦è®“.å¤±æ•ˆï¼Œå¯ä»¥[.]æˆ– \\\\. è¡¨ç¤ºã€‚ 3.0.5.1 Excercise æ‰¾å‡ºåœ‹åä¸­é–“æœ‰å­—å…ƒi t ä¸¦ä¸”å°‡landçµå°¾çš„å­—ä¸²æ”¹ç‚ºå¤§å¯«ã€‚ä¾‹å¦‚,Finland-&gt;FinLAND character(0) 3.0.6 Character classes é è¨­å­—å…ƒåˆ†é¡ä¾‹å¦‚ numbers, letters, åˆ†é¡ã€‚ é–‹é ­[: çµå°¾ :] ï¼Œå¦ä¸€ç¨®ç°¡å¯«æ–¹å¼ç‚ºåˆ©ç”¨ \\ ã€‚ [:digit:] or \\d: æ•¸å­—,ç­‰åŒ [0-9]. \\D: éæ•¸å­—,ç­‰åŒ [^0-9]. [:lower:]: å°å¯«,ç­‰åŒ [a-z]. [:upper:]: å¤§å¯«,ç­‰åŒ [A-Z]. [:alpha:]: å­—æ¯,ç­‰åŒ [[:lower:][:upper:]] or [A-z]. [:alnum:]: ç­‰åŒ [[:alpha:][:digit:]] æˆ– [A-z0-9]. \\w: word characters, equivalent to [[:alnum:]_] or [A-z0-9_]. \\W: not word, equivalent to [^A-z0-9_]. [:xdigit:]: hexadecimal digits (base 16), 0 1 2 3 4 5 6 7 8 9 A B C D E F a b c d e f, equivalent to [0-9A-Fa-f]. [:blank:]: blank characters, i.e. space and tab. [:space:]: space characters: tab, newline, vertical tab, form feed, carriage return, space. \\s: space, . \\S: not space. [:punct:]: punctuation characters, ! \" # $ % &amp; â€™ ( ) * + , - . / : ; &lt; = &gt; ? @ [ ] ^ _ ` { | } ~. [:graph:]: graphical (human readable) characters: equivalent to [[:alnum:][:punct:]]. [:print:]: printable characters, equivalent to [[:alnum:][:punct:]\\\\s]. [:cntrl:]: control characters, like \\n or \\r, [\\x00-\\x1F\\x7F]. Note: [:...:] å¿…é ˆå¯«åœ¨ä¸­æ‹¬è™Ÿä¸­, ä¾‹å¦‚ [[:digit:]]. \\ æ³¨æ„ \\\\d. å’Œ \\tçš„å€åˆ¥ã€‚ "],
["ç‰©ä»¶.html", "Chapter 4 ç‰©ä»¶ 4.1 attribute 4.2 attr, attributes &amp; structure Functions in R | 4 Examples (get, remove &amp; set)", " Chapter 4 ç‰©ä»¶ 4.1 attribute oth the names and the dimensions of matrices and arrays are stored in R as attributes of the object. These attributes can be seen as labeled values you can attach to any object. They form one of the mechanisms R uses to define specific object types like dates, time series, and so on. They can include any kind of information, and you can use them yourself to add information to any object. To see all the attributes of an object, you can use the attributes() function. You can see all the attributes of my.array like this: attributes(my.array) $dim [1] 3 4 2 This function returns a named list, where each item in the list is an attribute. Each attribute can, on itself, be a list again. For example, the attribute dimnames is actually a list containing the row and column names of a matrix. You can check that for yourself by checking the output of attributes(baskets.team). You can set all attributes as a named list as well. You find examples of that in the Help file ?attributes. To get or set a single attribute, you can use the attr() function. This function takes two important arguments. The first argument is the object you want to examine, and the second argument is the name of the attribute you want to see or change. If the attribute you ask for doesnâ€™t exist, R simply returns NULL. Imagine you want to add which season Granny and Geraldine scored the baskets mentioned in baskets.team. You can do this with the following code: attr(baskets.team,â€˜seasonâ€™) &lt;- â€˜2010-2011â€™ To get the value of this attribute returned, you can then use following code: attr(baskets.team,â€˜seasonâ€™) [1] â€œ2010-2011â€ You can delete attributes again by setting their value to NULL, like this: attr(baskets.team,â€˜seasonâ€™) &lt;- NULL 4.2 attr, attributes &amp; structure Functions in R | 4 Examples (get, remove &amp; set) ä¸‰å€‹å‡½æ•¸çš„åŸºæœ¬å¯«æ³•: attributes(data) attr(x = data, which = &quot;attribute_name&quot;) structure(data, dim = c(2, 6)) Definitions: å‡½æ•¸ attributes è¨­å®šæˆ–åˆ—å‡ºç‰©ä»¶çš„æ‰€æœ‰attributesã€‚ å‡½æ•¸ attr ç‰©ä»¶ä¸­æŸå€‹æŒ‡å®šçš„attribute. å‡½æ•¸structure è¨­å®šè³‡æ–™ç‰©ä»¶ä¸­å…¶ä»–é¡å¤–çš„ attributesã€‚ ä½¿ç”¨æ–¹æ³• 4.2.1 Basic Application of attr() &amp; attributes() è¼‰å…¥è³‡æ–™é›†ç„¶å¾Œåˆ©ç”¨å‡½æ•¸çœ‹çœ‹data.frameæœ‰ç”šéº¼attributeã€‚ data(cars) # Load head(cars) attributes(cars) attr(x = cars, which = &quot;names&quot;) [1] \"speed\" \"dist\" ä¹Ÿå¯ä»¥å¯«æˆ attr(cars,&quot;names&quot;) [1] \"speed\" \"dist\" æ¯”è¼ƒä¸€ä¸‹names,å¯ä»¥ç™¼ç¾,names åªæ˜¯ä¸€å€‹data.frameä¸­çš„attribute class(cars) [1] \"data.frame\" str(cars) 'data.frame': 50 obs. of 2 variables: $ speed: num 4 4 7 7 8 9 10 10 10 11 ... $ dist : num 2 10 4 22 16 10 18 26 34 17 ... names(cars) [1] \"speed\" \"dist\" 4.2.2 Assign New Attributes with the attributes() R Function attributes_list &lt;- list(names = c(&quot;col1&quot;, &quot;col2&quot;), #è¨­å®šä¸åŒçš„æ¬„ä½åç¨± class = &quot;data.frame&quot;, # ä¿ç•™é¡åˆ¥ row.names = nrow(cars):1) # åå‘ ç„¶å¾Œå¯ä»¥åˆ©ç”¨attributesè¨­å®šæ‰€æœ‰attributesã€‚ attributes(cars) &lt;- attributes_list # Set all attributes of data attributes(cars) # Apply attributes function $names [1] \"col1\" \"col2\" $class [1] \"data.frame\" $row.names [1] 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 [26] 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 4.2.3 åˆ©ç”¨attr() æ”¹è®Šå…¶ä¸­ä¸€å€‹Attribute attr(x = cars, which = &quot;names&quot;) &lt;- c(&quot;aaa&quot;, &quot;bbb&quot;) # Set only names attribute æª¢æŸ¥çœ‹çœ‹çµæœ attributes(cars) # Apply attributes function $names [1] \"aaa\" \"bbb\" $class [1] \"data.frame\" $row.names [1] 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 [26] 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 4.2.4 The R structure Function å’Œattributes() attr() ç›¸é—œçš„å‘½ä»¤æ˜¯ structure() ã€‚ set.seed(12345) vec &lt;- round(runif(15, 0, 10)) # 1D å‘é‡ vec [1] 7 9 8 9 5 2 3 5 7 10 0 2 7 0 4 æ”¹è®ŠæˆçŸ©é™£: vec_dim &lt;- structure(vec, dim = c(3, 5)) # Change dimension of vector vec_dim # Print updated vector [,1] [,2] [,3] [,4] [,5] [1,] 7 9 3 10 7 [2,] 9 5 5 0 0 [3,] 8 2 7 2 4 æ¯”è¼ƒä¹‹å‰çš„å¯«æ³•: matrix(vec,nrow=3) 4.2.4.1 Example: dd &lt;- structure(list( year = c(2001, 2002, 2004, 2006) ,length_days = c(366.3240, 365.4124, 366.5323423, 364.9573234)) ,.Names = c(&quot;year&quot;, &quot;length of days&quot;) ,row.names = c(NA, -4L) ,class = &quot;data.frame&quot;) dd year length of days 1 2001 366 2 2002 365 3 2004 367 4 2006 365 str(dd) 'data.frame': 4 obs. of 2 variables: $ year : num 2001 2002 2004 2006 $ length of days: num 366 365 367 365 ddçš„meta data: attributes(dd) $names [1] \"year\" \"length of days\" $row.names [1] 1 2 3 4 $class [1] \"data.frame\" åˆ©ç”¨structure()å»ºç«‹çš„ç‰©ä»¶,ä¸ç®¡æ˜¯åŒè³ª(vector,matrix)é‚„æ˜¯ç•°è³ª(data.frame,list) éƒ½æœƒåˆ©ç”¨attributeså„²å­˜meta dataã€‚ä¾‹å¦‚, just_vector &lt;- structure(1:10, comment = &quot;This is my simple vector with info&quot;) just_vector [1] 1 2 3 4 5 6 7 8 9 10 str(just_vector) int [1:10] 1 2 3 4 5 6 7 8 9 10 - attr(*, \"comment\")= chr \"This is my simple vector with info\" ç„¶å¾Œåˆ©ç”¨å‡½æ•¸ï¼Œå¯ä»¥æ‹¿åˆ°æˆ‘å€‘ä¹‹å‰çš„è³‡è¨Š: attributes(just_vector) çµæœå¦‚ä¸‹: $comment [1] â€œThis is my simple vector with infoâ€ æ³¨æ„:attributes()çš„å‚³å›çµæœç‚ºlist,å› æ­¤æœ‰$comment str(attributes(just_vector)) List of 1 $ comment: chr \"This is my simple vector with info\" attributes(attributes(just_vector)) $names [1] \"comment\" 4.2.4.2 In one go é€™æ˜¯å¦ä¸€å€‹åˆ©ç”¨å‡½æ•¸structure()çš„ä¾‹å­ã€‚å…ˆçœ‹ä¸€ä¸‹ä¸€èˆ¬å»ºç«‹data.frameç‰©ä»¶çš„æ–¹æ³•: year = c(1999, 2002, 2005, 2008) pollution = c(346.82,134.308821199349, 130.430379885892, 88.275457392443) dd2 &lt;- data.frame(year,pollution) dd2$year &lt;- as.factor(dd2$year) åˆ©ç”¨ structure, ä¸€æ­¥å°±å¯ä»¥å®Œæˆ: dd &lt;- structure(list( year = as.factor(c(2001, 2002, 2004, 2006)) ,length_days = c(366.3240, 365.4124, 366.5323423, 364.9573234)) ,.Names = c(&quot;year&quot;, &quot;length of days&quot;) ,row.names = c(NA, -4L) ,class = &quot;data.frame&quot;) Constructing data-frame with additional attributes and comments. dd3 &lt;- structure(list( v1 = as.factor(c(2001, 2002, 2004, 2006)) ,v2 = I(c(2001, 2002, 2004, 2006)) ,v3 = ordered(c(2001, 2002, 2004, 2006)) ,v4 = as.double(c(366.3240, 365.4124, 366.5323423, 364.9573234))) ,.Names = c(&quot;year&quot;, &quot;AsIs Year&quot;,&quot;yearO&quot;, &quot;length of days&quot;) ,.typeOf = c(&quot;factor&quot;, &quot;numeric&quot;, &quot;ordered&quot;,&quot;numeric&quot;) ,row.names = c(NA, -4L) ,class = &quot;data.frame&quot; ,comment = &quot;Ordered YearO for categorical analysis and other variables&quot;) dd3 year AsIs Year yearO length of days 1 2001 2001 2001 366 2 2002 2002 2002 365 3 2004 2004 2004 367 4 2006 2006 2006 365 And checking comments can be done as: attributes(dd3)$comment [1] \"Ordered YearO for categorical analysis and other variables\" attr(dd3, which=&quot;comment&quot;) [1] \"Ordered YearO for categorical analysis and other variables\" "],
["file-system.html", "Chapter 5 File System 5.1 Exploring file system 5.2 Creating of a directory 5.3 Rç³»çµ±æª”æ¡ˆåˆ—è¡¨ 5.4 åœ¨Rä¸­å»ºç«‹æª”æ¡ˆåç¨± 5.5 è®€æª” 5.6 write csv 5.7 Rèªè¨€çš„æª”æ¡ˆæ ¼å¼", " Chapter 5 File System æš«æ™‚å­ç›®éŒ„ å‡½æ•¸ tempfile() ä¸æ˜¯å»ºç«‹æ–°æª”æ¡ˆ,è€Œæ˜¯åœ¨ç›®å‰çš„r sessionä¸­éš¨æ©Ÿç”¢ç”Ÿå”¯ä¸€æª”æ¡ˆåç¨±ï¼Œæª”æ¡ˆä½ç½®é è¨­æ˜¯åœ¨æš«æ™‚å­ç›®éŒ„ä¸­ã€‚ mydirname &lt;- tempfile(pattern = &quot;mydir&quot;) mydirname [1] \"C:\\Users\\linchao\\AppData\\Local\\Temp\\RtmpIp3ZiD 5.1 Exploring file system function file.exists() å¯ä»¥ç”¨ä¾†çŸ¥é“æª”æ¡ˆæ˜¯å¦å­˜åœ¨, function dir() ç”¨ä¾†çŸ¥é“ç›®å‰æª”æ¡ˆä½ç½®çš„å…§å®¹. file.exists(mydirname) dir(tempdir()) character(0) # Empty character vector ::: sidebar a &lt;- character(0) identical(a, character(0)) # returns TRUE identical(a, \"\") # returns FALSE identical(a, numeric(0)) # returns also FALSE hint: åˆ©ç”¨length ::: 5.2 Creating of a directory dir.create å»ºç«‹å­ç›®éŒ„ dir.create(mydirname) file.exists(mydirname) # ä¸Šé¢æŒ‡ä»¤å»ºç«‹çš„å­ç›®éŒ„æ˜¯å¦å­˜åœ¨ dir(tempdir(), full.names = TRUE) #åˆ—å‡ºç›®å‰å­ç›®éŒ„å…§å®¹(å…¨å) file.mtime(mydirname) #å­ç›®éŒ„å»ºç«‹æ™‚é–“,make time [1] TRUE [1] â€œC:\\Users\\linchao\\AppData\\Local\\Temp\\RtmpIp3ZiD/file87e8755a1876â€ [2] â€œC:\\Users\\linchao\\AppData\\Local\\Temp\\RtmpIp3ZiD/mydir87e86b51384dâ€ [3] â€œC:\\Users\\linchao\\AppData\\Local\\Temp\\RtmpIp3ZiD/rs-graphics-0f3f81af-32b7-49c4-a272-ad1a859f222fâ€ [1] â€œ2018-10-25 23:42:51 CSTâ€ 5.3 Rç³»çµ±æª”æ¡ˆåˆ—è¡¨ å¦‚æœè¦è§€å¯Ÿå®‰è£å¥—ä»¶çš„æª”æ¡ˆä½ç½®,å¯ä»¥ä½¿ç”¨æŒ‡ä»¤ system.file(),é€™å€‹æŒ‡ä»¤å¯ä»¥åˆ—å‡ºå¥—å»ºçš„å…¨è·¯å¾‘ã€‚ä¾‹å¦‚, system.file(package = &quot;stats&quot;) [1] â€œC:/PROGRA~1/R/R-3.5.1/library/statsâ€ åˆ—å‡ºå¥—ä»¶statsä¸­,æ‰€æœ‰çš„æª”æ¡ˆ dir(system.file(package = &quot;stats&quot;)) [1] â€œCOPYRIGHTS.modregâ€ â€œdemoâ€ â€œDESCRIPTIONâ€ [4] â€œhelpâ€ â€œhtmlâ€ â€œINDEXâ€ [7] â€œlibsâ€ â€œMetaâ€ â€œNAMESPACEâ€ [10] â€œRâ€ â€œSOURCES.tsâ€ ä¸Šé¢å¯ä»¥çœ‹åˆ°å¥—ä»¶ä¸­åŒ…å«å­ç›®éŒ„demoï¼Œå¦‚æœé‚„è¦æŸ¥çœ‹demoä¸­çš„æª”æ¡ˆå…§å®¹: dir(system.file(&quot;demo&quot;, package = &quot;stats&quot;)) [1] â€œglm.vr.Râ€ â€œlm.glm.Râ€ â€œnlm.Râ€ â€œsmooth.Râ€ å¦‚æœè¦çœ‹å…¨è·¯å¾‘ï¼Œå¯ä»¥: dir(system.file(&quot;demo&quot;, package = &quot;stats&quot;), full.names = TRUE) [1] â€œ/usr/lib64/R/library/stats/demo/glm.vr.Râ€ [2] â€œ/usr/lib64/R/library/stats/demo/lm.glm.Râ€ [3] â€œ/usr/lib64/R/library/stats/demo/nlm.Râ€ [4] â€œ/usr/lib64/R/library/stats/demo/smooth.Râ€ 5.4 åœ¨Rä¸­å»ºç«‹æª”æ¡ˆåç¨± ç”šéº¼æ˜¯æª”æ¡ˆåç¨±?ä¸æ˜¯ character string è€Œæ˜¯ system-specific character stringã€‚ä¾‹å¦‚,Rå‡½æ•¸file.path()çš„åŸ·è¡Œçµæœå°±æ˜¯system-specific file names. workingdir &lt;- &quot;projects&quot; projectdir &lt;- &quot;warandpeace&quot; datadir &lt;- &quot;data&quot; file.path(workingdir, projectdir, datadir) [1] â€œprojects/warandpeace/dataâ€ ä¸Šé¢æ˜¯windows 10ç³»çµ±ä¸Šçš„çµæœ,æ¯”è¼ƒ Linux-based OS,å‰‡ç‚º: [1] â€œprojects/warandpeace/dataâ€ æ³¨æ„æ–œç·šéƒ½ä¸€æ¨£ã€‚ 5.4.1 Note about Windows åˆ©ç”¨å‡½æ•¸ file.path()åˆ—å‡ºçš„æª”æ¡ˆè·¯å¾‘åˆ†éš”æ˜¯æ–œç·š,è€Œä¸æ˜¯åæ–œç·š (ä¾‹å¦‚for example C:\\Program Files\\R\\R-3.5.1)? æ±‚åŠ©æ–‡ä»¶èªª: The components are by default separated by â€˜/â€™ (not â€˜â€™) on Windows. Note: DOS å’Œ Windows ä¹Ÿæ”¯æ´æ–œç·š. 5.4.2 å’Œå·¥ä½œå€ç›¸é—œçš„æŒ‡ä»¤ dir(), list.files, list.dirs getwd() setwd() list.files(R.home()) ## Only files starting with a-l or r ## Note that a-l is locale-dependent, but using case-insensitive ## matching makes it unambiguous in English locales dir(&quot;../..&quot;, pattern = &quot;^[a-lr]&quot;, full.names = TRUE, ignore.case = TRUE) list.dirs(R.home(&quot;doc&quot;)) list.dirs(R.home(&quot;doc&quot;), full.names = FALSE) ###æ‡‰ç”¨ç¯„ä¾‹ 5.4.2.1 åˆ—å‡ºç›®å‰å·¥ä½œç›®éŒ„ä¸Šçš„æª”æ¡ˆ x &lt;- dir() for (item in x) { show(item) #print(item) } æˆ–è€…,åƒ…åˆ—å‡ºå‰å¹¾å€‹æª”æ¡ˆ x&lt;-dir() head(x) 5.5 è®€æª” 5.5.0.1 åƒ…åƒ…æŸ¥çœ‹æª”æ¡ˆå…§å®¹ æ¸¬è©¦ä¸­æ–‡çš„æª”æ¡ˆ æ¸¬è©¦æª”æ¡ˆ æ³¨æ„æª”æ¡ˆå…§å®¹ç¬¬ä¸€è¡Œä¸æ˜¯è³‡æ–™ã€‚ file.show(\"resources/wh.csv\")æœƒæ‰“é–‹excel ä¹Ÿå¯ä»¥åˆ©ç”¨æ®¼å±¤æŒ‡ä»¤: system(\"cat resources/wh.csv\")ï¼Œä½†æ˜¯å¦‚æœå…§å®¹æ˜¯ä¸­æ–‡,é¡¯ç¤ºçµæœæœƒè®Šæˆäº‚ç¢¼ã€‚ cat(readChar(&quot;resources/wh.csv&quot;, 1e5)) Warning in readChar(\"resources/wh.csv\", 1e+05): åœ¨é UTF-8 MBCS èªå€ä¸­åªèƒ½ä»¥ä½å…ƒ çµ„ç‚ºå–®ä½è®€å– # this is a test file height,weight,sex 156,56, m 167,., f 189,70, m 180,, f åˆ©ç”¨useBytes ä¸æœƒå‡ºç¾è­¦å‘Š cat(readChar(&quot;resources/wh.csv&quot;, useBytes=TRUE,1e5)) # this is a test file height,weight,sex 156,56, m 167,., f 189,70, m 180,, f åƒæ•¸æœ‰useBytes,ä½†æ˜¯ä¸ç®¡TRUE/FALSEï¼Œéƒ½æ˜¯ä¸­æ–‡äº‚ç¢¼ res &lt;- readLines(system.file(&quot;DESCRIPTION&quot;, package=&quot;MASS&quot;)) length(res) 5.5.1 ä¸€èˆ¬çš„é–‹æª”/é—œæª”éç¨‹ å¤§é«”ä¸Šæ¯å€‹èªè¨€çš„é–‹æª”å’Œé—œæª”æ¡ˆçš„éç¨‹ï¼Œéƒ½æœƒåˆ©ç”¨åˆ°ä½œæ¥­ç³»çµ±ï¼Œå› æ­¤æœƒæœ‰é–‹æª”å‹•ä½œï¼Œå¾ä½œæ¥­ç³»çµ±å¾—åˆ°ä¸€å€‹æ•¸å­—ï¼Œé€™è£¡ç¨±ç‚ºæª”æ¡ˆæŒ‡æ¨™ï¼Œç„¶å¾Œåˆ©ç”¨é€™å€‹æŒ‡æ¨™ï¼Œè®€å…¥æ–‡å­—æˆ–å¯«å…¥æ–‡å­—ï¼Œç„¶å¾Œæœ‰ä¸€å€‹é—œé–‰æª”æ¡ˆçš„å‹•ä½œå‘Šè¨´ä½œæ¥­ç³»çµ±ï¼Œè™•ç†æª”æ¡ˆçµæŸã€‚ åœ¨Rèªè¨€ä¸­ï¼Œé–‹æª”ä¸æ˜¯open(),è€Œæ˜¯fileï¼š con = file(filepath, &quot;r&quot;) é–‹å§‹è®€å¯«æ“ä½œ close(con) 5.5.1.1 csv read.csv(&quot;filename.csv&quot;, #name of file header = TRUE, #are there column names in 1st row? sep = &quot;,&quot;, #what separates rows? as.is = !stringsAsFactors, #é—œæ‰å­—å…ƒè½‰factor colClasses = NA # to convert everything to character data set to &quot;character&quot; na.string = &quot;NA&quot; # could be &quot;.&quot; for SAS files skip = 0, #è¦è·³éçš„å‰å¹¾è¡Œæ•¸ç›®&gt;0 strip.white = TRUE, #æ“ æ‰ç©ºç™½,ä¾‹å¦‚ &quot; 0.1&quot; = &quot;0.1&quot; fill = TRUE, #fill in rows that have unequal numbers of columns comment.char = &quot;#&quot;, #è¨»è§£ä¸è®€å…¥ stringsAsFactors = FALSE #æ¯”as.is å¸¸ç”¨,é—œæ‰å­—å…ƒè½‰factor ) read.csv()æœ€ç°¡å–®çš„ç”¨æ³•æ˜¯ç›´æ¥çµ¦æª”æ¡ˆåç¨±,ä¾‹å¦‚ rst = read.csv(&#39;resources/wh.csv&#39;) Error in read.table(file = file, header = header, sep = sep, quote = quote, : more columns than column names Error in dec = dec, fill = fill, comment.char = comment.char, ...): more columns than column names ä½†æ˜¯wh.csv å‰é¢æœ‰å¹¾è¡Œæ˜¯è¨»è§£ readLines(&#39;resources/wh.csv&#39;,n=3) [1] \"# this is a test file\" \"height,weight,sex\" \"156,56, m\" å› æ­¤åŠ ä¸Šskip åƒæ•¸ rst = read.csv(&#39;resources/wh.csv&#39;,skip=1) head(rst) height weight sex 1 156 56 m 2 167 . f 3 189 70 m 4 180 f ä¹Ÿå¯ä»¥åˆ©ç”¨åƒæ•¸comment.char rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;) head(rst) height weight sex 1 156 56 m 2 167 . f 3 189 70 m 4 180 f ä½†æ˜¯æ³¨æ„åˆ°weighté€™å€‹æ¬„ä½è¢«è½‰ç‚ºå­—ä¸²,å› ç‚ºæœ‰ä¸€å€‹ â€œ.â€ ã€‚æœ‰äº›å¥—è£è»Ÿé«”çš„CSVè¼¸å‡ºå°‡NAè½‰ç‚ºâ€œ.â€,å› æ­¤ rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) head(rst) height weight sex 1 156 56 m 2 167 NA f 3 189 70 m 4 180 NA f 5.6 write csv 5.6.1 data.frame to CSV rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) write.csv(rst, file = &quot;MyData.csv&quot;) readLines(&quot;MyData.csv&quot;,n=3) # note: readLines()ä¸æ˜¯readline() [1] \"\\\"\\\",\\\"height\\\",\\\"weight\\\",\\\"sex\\\"\" \"\\\"1\\\",156,56,\\\" m\\\"\" [3] \"\\\"2\\\",167,NA,\\\" f\\\"\" å¦‚æœrow namesä¸è¦å¯«é€²csv,å¯ä»¥åˆ©ç”¨åƒæ•¸ row.names=FALSEã€‚ rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) write.csv(rst, file = &quot;MyData.csv&quot;,row.names=FALSE) readLines(&quot;MyData.csv&quot;,n=3) [1] \"\\\"height\\\",\\\"weight\\\",\\\"sex\\\"\" \"156,56,\\\" m\\\"\" [3] \"167,NA,\\\" f\\\"\" rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) write.csv(rst, file = &quot;MyData.csv&quot;,row.names=FALSE) readLines(&quot;MyData.csv&quot;,n=3) è¼¸å‡ºæ˜¯: [1] â€œ\"height\",\"weight\",\"sex\"â€ [2] â€œ156,56,\" m\"â€ [3] â€œ167,NA,\" f\"â€ å¯ä»¥çœ‹å‡ºä¾†æ¯ä¸€è¡Œéƒ½æœ‰é›™å¼•è™Ÿè¡¨ç¤ºå­—ä¸²ã€‚ å°ç…§æ–‡å­—æª”(mData.csv) â€œheightâ€,â€œweightâ€,â€œsexâ€ 156,56,\" m\" 167,NA,\" f\" 189,70,\" m\" 180,NA,\" f\" ä¸Šé¢sidebarä¸­,é¡¯ç¤ºçš„çš„sexæ¬„ä½,å¯ä»¥çœ‹è¦‹\" m\" ä¹Ÿå°±æ˜¯æœ‰ç©ºç™½,å•åˆ©ç”¨read.csv è®€å…¥æ™‚,æœƒæ˜¯ç”šéº¼æƒ…æ³? å¦‚æœè¦æŒ‡å®šNAçš„å€¼,å¯ä»¥åˆ©ç”¨æ¬„ä½=â€â€,å¦å‰‡é å®šæ˜¯NA rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) write.csv(rst, file = &quot;MyData.csv&quot;,row.names=FALSE, na=&quot;&quot;) cat(readLines(&quot;MyData.csv&quot;), sep = &#39;\\n&#39;) \"height\",\"weight\",\"sex\" 156,56,\" m\" 167,,\" f\" 189,70,\" m\" 180,,\" f\" Note: åƒè€ƒrmarkdown æè¦ ::: todo cat ::: å¦‚æœè¼¸å‡ºæ™‚,å­—ä¸²ä¸è¦é›™å¼•è™Ÿ,å‰‡å¯ä»¥ç”¨quote=FALSE rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) write.csv(rst, file = &quot;MyData.csv&quot;,row.names=FALSE, quote=F) # system(&quot;cat myData.csv&quot;) # é€™å€‹ä¸è¡Œ cat(readLines(&#39;MyData.csv&#39;), sep = &#39;\\n&#39;) height,weight,sex 156,56, m 167,NA, f 189,70, m 180,NA, f å¦‚æœè¦æ›´å¤šçš„è¼¸å‡ºæ§åˆ¶å¯ä»¥åƒè€ƒå¯ä»¥write.table(). write.csv()å‡½æ•¸,å¯¦éš›ä¸Šæœƒå†å‘¼å«write.table()å‡½æ•¸ã€‚ä¾‹å¦‚,æ¬„ä½åç¨±ä¹Ÿä¸è¦è¼¸å‡ºçš„è©±,å¯ä»¥åˆ©ç”¨write.table()ï¼Œè¦è¨­å®šçš„åƒæ•¸å¦‚ä¸‹: sep=â€,â€ å’Œ col.names=FALSE,å‰è€…æ˜¯CSVçš„ä¸»è¦åˆ†éš”å­—å…ƒ,å¾Œè€…å‰‡æ˜¯ä¸è¦æ¬„ä½åç¨±ã€‚ write.table(rst, file = &quot;MyData.csv&quot;,row.names=FALSE, na=&quot;&quot;,col.names=FALSE, sep=&quot;,&quot;) cat(readLines(&#39;MyData.csv&#39;), sep = &#39;\\n&#39;) 156,56,\" m\" 167,,\" f\" 189,70,\" m\" 180,,\" f\" 5.7 Rèªè¨€çš„æª”æ¡ˆæ ¼å¼ å¦‚æœä¸è€ƒæ…®å­˜æª”æ ¼å¼ï¼Œé‚£éº¼å¯ä»¥åˆ©ç”¨ save(v1,v2,...file=&quot;myfile.RData&quot;) ... load(file=&quot;myfie.RData&quot;) "],
["functions.html", "Chapter 6 Functions 6.1 Introduction 6.2 Function fundamentals 6.3 Lexical scoping 6.4 Lazy evaluation 6.5 ... (dot-dot-dot) 6.6 Exiting a function 6.7 Function forms (skip) 6.8 Invoking a function 6.9 Quiz answers", " Chapter 6 Functions 6.1 Introduction ç°¡å–®æ¸¬è©¦ ### Quiz {-} Answer the following questions to see if you can safely skip this chapter. You can find the answers in ??. What are the three components of a function? What does the following code return? x &lt;- 10 f1 &lt;- function(x) { function() { x + 10 } } f1(1)() How would you usually write this code? `+`(1, `*`(2, 3)) How could you make this call easier to read? mean(, TRUE, x = c(1:10, NA)) Does the following code throw an error when executed? Why/why not? f2 &lt;- function(a, b) { a * 10 } f2(10, stop(&quot;This is an error!&quot;)) What is an infix function? How do you write it? Whatâ€™s a replacement function? How do you write it? How do you ensure that cleanup action occurs regardless of how a function exits? Outline Section 6.2 describes the basics of creating a function, the three main components of a function, and the exception to many function rules: primitive functions (which are implemented in C, not R). Section 6.3 shows you how R finds the value associated with a given name, i.e. the rules of lexical scoping. Section 6.4 is devoted to an important property of function arguments: they are only evaluated when used for the first time. Section 6.6 discusses the two primary ways that a function can exit, and how to define an exit handler, code that is run on exit, regardless of what triggers it. Section ?? shows you the various ways in which R disguises ordinary function calls, and how you can use the standard prefix form to better understand whatâ€™s going on. 6.2 Function fundamentals å¹¾å€‹é‡è¦è§€å¿µ å‡½æ•¸ä¹Ÿæ˜¯ç‰©ä»¶,å°±åƒæ˜¯vectors ä¹Ÿæ˜¯ç‰©ä»¶ã€‚ ç”±ä¸‰å€‹éƒ¨ä»½çµ„æˆ: arguments, body, and environment. There are exceptions to every rule, and in this case, there is a small selection of â€œprimitiveâ€ base functions that are implemented purely in C. 6.2.1 First-class functions åœ¨Rä¸­,å‡½æ•¸ä¹Ÿæ˜¯ç‰©ä»¶,é€™ç¨®ç‰¹æ€§ä¹Ÿå«åš â€œfirst-class functionsâ€. å¦‚ä¸‹: f01 &lt;- function(x) { sin(1 / x ^ 2) } åŒ¿åå‡½æ•¸: lapply(mtcars, function(x) length(unique(x))) Filter(function(x) !is.numeric(x), mtcars) integrate(function(x) sin(x) ^ 2, 0, pi) åœ¨listä¸­,ä¹Ÿå¯ä»¥æ”¾å…¥: funs &lt;- list( half = function(x) x / 2, double = function(x) x * 2 ) funs$double(10) [1] 20 åœ¨Rèªè¨€ä¸­,å‡½æ•¸æœ‰æ™‚å«åšclosureå› ç‚º,Rå‡½æ•¸åŒ…å«(enclose)å®ƒå€‘çš„ç’°å¢ƒ environments. typeof(f01) [1] \"closure\" 6.2.2 Function components 1å€‹å‡½æ•¸æœ‰3å€‹éƒ¨åˆ†: formals(), åƒæ•¸ body(), {}å…§éƒ¨. environment(), æ±ºå®šå‡½æ•¸æ€æ¨£æ‰¾å‡ºè®Šæ•¸(names)çš„å…§å®¹ã€‚. Iâ€™ll draw functions as in the following diagram. The black dot on the left is the environment. The two blocks to the right are the function arguments. I wonâ€™t draw the body, because itâ€™s usually large, and doesnâ€™t help you understand the â€œshapeâ€ of the function. The function environment always exists, but it is only printed when the function isnâ€™t defined in the global environment. f02 &lt;- function(x) { # A comment x ^ 2 } formals(f02) $x body(f02) { x^2 } environment(f02) å°±åƒæ‰€ä»¥å…¶ä»–Rçš„ç‰©ä»¶,å‡½æ•¸ä¹Ÿæœ‰å¾ˆå¤š attributes(). å…¶ä¸­ä¸€å€‹ â€œsrcrefâ€, æ˜¯ source referenceçš„ç¸®å¯«ã€‚ attr(f02, &quot;srcref&quot;) function(x) { # A comment x ^ 2 } 6.2.3 Primitive functions ï¼“å€‹çµ„ä»¶çš„è¦å‰‡æœ‰ä¾‹å¤–ï¼Œåƒæ˜¯ Primitive functions, like sum() and [, ç›´æ¥èª¿ç”¨ï¼£èªè¨€ã€‚ sum function (..., na.rm = FALSE) .Primitive(\"sum\") `[` .Primitive(\"[\") çœ‹ä¸€ä¸‹type åˆ†åˆ¥å±¬æ–¼ â€œbuiltinâ€ or â€œspecialâ€: typeof(sum) [1] \"builtin\" typeof(`[`) [1] \"special\" å› æ­¤ï¼Œ formals(), body(), and environment() éƒ½å›å‚³ NULL: formals(sum) NULL body(sum) NULL environment(sum) NULL é€™äº›æ‰€è¬‚çš„åŸå§‹å‡½æ•¸ï¼Œåªå­˜åœ¨æ–¼åŸºæœ¬å¥—ä»¶(base packages) ã€‚. 6.2.4 Exercises Given a function, like \"mean\", match.fun() lets you find a function. Given a function, can you find its name? Why doesnâ€™t that make sense in R? Itâ€™s possible (although typically not useful) to call an anonymous function. Which of the two approaches below is correct? Why? function(x) 3() function(x) 3() (function(x) 3)() [1] 3 A good rule of thumb is that an anonymous function should fit on one line and shouldnâ€™t need to use {}. Review your code. Where could you have used an anonymous function instead of a named function? Where should you have used a named function instead of an anonymous function? What function allows you to tell if an object is a function? What function allows you to tell if a function is a primitive function? This code makes a list of all functions in the base package. objs &lt;- mget(ls(&quot;package:base&quot;), inherits = TRUE) funs &lt;- Filter(is.function, objs) Use it to answer the following questions: Which base function has the most arguments? How many base functions have no arguments? Whatâ€™s special about those functions? How could you adapt the code to find all primitive functions? What are the three important components of a function? When does printing a function not show the environment it was created in? 6.3 Lexical scoping In [Names and values], we discussed assignment, the act of binding a name to a value. Here weâ€™ll discuss scoping, the act of finding the value associated with a name. ä¸‹é¢çš„åŸ·è¡Œçµæœå‚³å›10é‚„æ˜¯20?1 x &lt;- 10 g01 &lt;- function() { x &lt;- 20 x } g01() äº†è§£ç¯„åœè¦å‰‡,æœ‰åŠ©æ–¼å‡½æ•¸çš„æ¨¡çµ„é–‹ç™¼,ç”šè‡³æœ‰åŠ©æ–¼å°‡Rç¿»è­¯åˆ°å…¶ä»–èªè¨€ã€‚ lexical scoping 2: it looks up the values of names based on how a function is defined, not how it is called. â€œLexicalâ€ here is not the English adjective â€œrelating to words or a vocabularyâ€. Itâ€™s a technical CS term that tells us that the scoping rules use a parse-time, rather than a run-time structure. Rçš„â€™s lexical scoping éµå¾ª4å€‹ä¸»è¦è¦å‰‡:: Name masking Functions vs. variables A fresh start Dynamic lookup 6.3.1 Name masking å…§éƒ¨ç¯„åœçš„å®£å‘Š(ç¬¬ä¸€æ¬¡ä½¿ç”¨)è¦†è“‹å¤–éƒ¨ç¯„åœçš„å®£å‘Šã€‚. x &lt;- 10 y &lt;- 20 g02 &lt;- function() { x &lt;- 1 y &lt;- 2 c(x, y) } g02() [1] 1 2 å¦‚æœåœ¨å…§éƒ¨å®£å‘Šæ‰¾ä¸åˆ°,å°±æ‰¾å¤–ä¸€å±¤ï¼Œä¸€ç›´åˆ°global environmentã€‚ x &lt;- 2 g03 &lt;- function() { y &lt;- 1 c(x, y) } g03() [1] 2 1 ä¸Šé¢çš„è¦å‰‡ä»ç„¶é©ç”¨æ–¼å‡½æ•¸ä¸­çš„å‡½æ•¸. æ¸¬è©¦:ä¸‹é¢çš„Rç¨‹å¼æœƒæœ‰ç”šéº¼çµæœ ? 3 x &lt;- 1 g04 &lt;- function() { y &lt;- 2 i &lt;- function() { z &lt;- 3 c(x, y, z) } i() } g04() åŒæ¨£ä¹Ÿé©ç”¨æ–¼å»ºç«‹å‡½æ•¸çš„å‡½æ•¸( closures).åƒè€ƒ [closures]; é€™è£¡åªæ˜¯ç”¨ä¾†èªªæ˜ä¸Šè¿°è¦å‰‡çš„ä½¿ç”¨ã€‚ g05(), å‚³å›å‡½æ•¸,çŒœçŒœåŸ·è¡Œçµæœ?4 x &lt;- 10 y &lt;- 20 g05 &lt;- function() { y &lt;- 2 function() { c(x, y) } } g06 &lt;- g05() g06() This seems a little magical: how does R know what the value of y is after j() has returned? It works because k preserves the environment in which it was defined and because the environment includes the value of y. Youâ€™ll learn more about how environments work in Environments. 6.3.2 Functions vs. variables æ—¢ç„¶å‡½æ•¸ä¹Ÿåªæ˜¯æ™®é€šçš„ç‰©ä»¶,é‚£éº¼åŒæ¨£çš„åç¨±å°‹æ‰¾è¦å‰‡ä¹Ÿé©ç”¨æ–¼å‡½æ•¸:é€™å€‹ä¾‹å­ä¸­,g07åœ¨å¤–éƒ¨å’Œå…§éƒ¨çš†æœ‰å®šç¾©ã€‚ g07 &lt;- function(x) x + 1 g08 &lt;- function() { g07 &lt;- function(x) x + 100 g07(10) } g08() [1] 110 ä½†æ˜¯å¦‚æœåŒä¸€å€‹åç¨±,åœ¨ä¸åŒç¯„åœæœ‰ä¸ä¸€æ¨£çš„å‹æ…‹å‘¢?ä¾‹å¦‚g9ä¸€å€‹æ˜¯è®Šæ•¸,ä¸€å€‹æ˜¯å‡½æ•¸: g09 &lt;- function(x) x + 100 g10 &lt;- function() { g09 &lt;- 10 g09(g09) } g10() [1] 110 ä¸€èˆ¬ä¾†è¬›,ä¸Šé¢çš„ç”¨æ³•åœ¨èªæ³•ä¸Šæ˜¯æ²’å•é¡Œ,ä½†æ˜¯æœ€å¥½é¿å…ã€‚ 6.3.3 A fresh start ç¬¬ä¸€æ¬¡åŸ·è¡Œå’Œç¬¬äºŒæ¬¡åŸ·è¡Œæœ‰ç”šéº¼ä¸åŒ?5 å‡½æ•¸ exists(x) :æœƒå°‹æ‰¾è®Šæ•¸åç¨±xæ˜¯å¦å­˜åœ¨,å­˜åœ¨å‰‡ç„¡å› TRUE,å¦å‰‡å‚³å› FALSE.) g11 &lt;- function() { if (!exists(&quot;a&quot;)) { a &lt;- 1 } else { a &lt;- a + 1 } a } g11() g11() æ¯æ¬¡åŸ·è¡Œg11()çš„æ™‚å€™,ä¸€å€‹æ–°çš„environmentæœƒè¢«å»ºç«‹,ä¹Ÿå°±æ˜¯é€™å€‹å‡½æ•¸çš„å±€éƒ¨ç©ºé–“ã€‚ é€™å€‹å±€éƒ¨ç©ºé–“æœƒåœ¨å‡½æ•¸çµæŸçš„æ™‚å€™æ¶ˆå¤±ã€‚ 6.3.4 Dynamic lookup ä½†æ˜¯å¦‚æœå‡½æ•¸åŸ·è¡Œçš„æ™‚å€™ç”¨å€’åœ¨å±€éƒ¨ç’°å¢ƒæ‰¾ä¸åˆ°çš„è®Šæ•¸çš„æ™‚å€™,æœƒç›®å‰çš„ç¸½é«”ç’°å¢ƒ(ä¹Ÿå°±æ˜¯å‡½æ•¸æ‰€åœ¨çš„ç’°å¢ƒ)æ‰¾è®Šæ•¸å€¼ã€‚ g12 &lt;- function() x + 1 x &lt;- 15 g12() [1] 16 x &lt;- 20 g12() [1] 21 ä¸Šé¢çš„ç¸½é«”ç’°å¢ƒåŒ…å«äº†å…©å€‹è®Šæ•¸,ä¸€å€‹æ˜¯å‡½æ•¸g12(),ä¸€å€‹æ˜¯è®Šæ•¸x: - g12() - x å¦‚æœè¦æª¢æŸ¥å‡½æ•¸çš„è®Šæ•¸åƒè€ƒæ˜¯ä¸æ˜¯æœ‰å•é¡Œ,å¯ä»¥ä½¿ç”¨å·¥å…· codetools::findGlobals(). This function lists all the external dependencies (unbound symbols) within a function: codetools::findGlobals(g12) [1] \"+\" \"x\" Another way to solve the problem would be to manually change the environment of the function to the emptyenv(), an environment which contains nothing: environment(g12) &lt;- emptyenv() g12() Error in x + 1: æ²’æœ‰é€™å€‹å‡½æ•¸ \"+\" 6.3.5 Exercises What does the following code return? Why? Describe how each of the three câ€™s is interpreted. c &lt;- 10 c(c = c) What are the four principles that govern how R looks for values? What does the following function return? Make a prediction before running the code yourself. f &lt;- function(x) { f &lt;- function(x) { f &lt;- function() { x ^ 2 } f() + 1 } f(x) * 2 } f(10) 6.4 Lazy evaluation In R, function arguments are lazily evaluated: theyâ€™re only evaluated if accessed. For example, this code doesnâ€™t generate an error because x is never used: h01 &lt;- function(x) { 10 } h01(stop(&quot;This is an error!&quot;)) [1] 10 This is an important feature because it allows you to do things like include potentially expensive computations in function arguments that will only be evaluated if needed. 6.4.1 Forcing evaluation To compel the evaluation of an argument, use force(): h02 &lt;- function(x) { force(x) 10 } h02(stop(&quot;This is an error!&quot;)) Error in force(x): This is an error! It is usually not necessary to force evaluation. Itâ€™s needed primarily for certain functional programming techniques which weâ€™ll cover in detail in [function operators]. Here, I want to show you the basic issue. Take this small but surprisingly tricky function. It takes a single argument x, and returns a function that returns x when called. capture1 &lt;- function(x) { function() { x } } Thereâ€™s a subtle issue with this function: the value of x will be captured not when you call capture(), but when you call the function that capture() returns: x &lt;- 10 h03 &lt;- capture1(x) h04 &lt;- capture1(x) h03() [1] 10 x &lt;- 20 h04() [1] 20 Even more confusingly this only happens once: the value is locked in after you have called h03()/h04() for the first time. x &lt;- 30 h03() [1] 10 h04() [1] 20 This behaviour is a consequence of lazy evaluation. The x argument is evaluated once h03()/h04() is called, and then its value is cached. We can avoid the confusion by forcing x: capture2 &lt;- function(x) { force(x) function() { x } } x &lt;- 10 h05 &lt;- capture2(x) x &lt;- 20 h05() [1] 10 6.4.2 Promises (skip) Lazy evaluation is powered by a data structure called a promise, or (less commonly) a thunk. Weâ€™ll come back to this data structure in metaprogramming because itâ€™s one of the features of R that makes it most interesting as a programming language. A promise has three components: The expression, like x + y which gives rise to the delayed computation. The environment where the expression should be evaluated. The value, which is computed and cached when the promise is first accessed by evaluating the expression in the specified environment. The value cache ensures that accessing the promise multiple times always returns the same value. For example, you can see in the following code that runif(1) is only evaluated once: h06 &lt;- function(x) { c(x, x, x) } h06(runif(1)) [1] 0.0808 0.0808 0.0808 You can also create promises â€œby handâ€ using delayedAssign(): delayedAssign(&quot;x&quot;, {print(&quot;Executing code&quot;); runif(1)}) x [1] \"Executing code\" [1] 0.834 x [1] 0.834 Youâ€™ll see this idea again in [advanced bindings]. 6.4.3 Default arguments h07 &lt;- function(x = 1, y = x * 2) { c(x, y) } h07() [1] 1 2 6.4.4 Missing arguments åˆ¤æ–·åƒæ•¸å…§å®¹ä¾†è‡ªä½¿ç”¨è€…æˆ–è€…é è¨­çš„å‡½æ•¸: missing(): h09 &lt;- function(x = 10) { list(missing(x), x) } str(h09()) # é è¨­ List of 2 $ : logi TRUE $ : num 10 str(h09(10)) # ä½¿ç”¨è€… List of 2 $ : logi FALSE $ : num 10 6.5 ... (dot-dot-dot) todo: 6.6 Exiting a function Most functions exit in one of two ways6: either returning a value, indicating successful completion, or throwing an error, indicating failure. This section describes return values (implicit vs. explicit; visible vs. invisible), briefly discusses errors, and introduces exit handlers, which allow you to run code when a function exits, regardless of how it exits. 6.6.1 Implicit vs. explict returns There are two ways that a function can return a value: Implicitly, where the last evaluated expression becomes the return value: j01 &lt;- function(x) { if (x &lt; 10) { 0 } else { 10 } } f(5) [1] 52 f(15) [1] 452 Explicitly, by calling return(): j02 &lt;- function(x) { if (x &lt; 10) { return(0) } else { return(10) } } 6.6.2 Invisible values Most functions return visibly: calling the function in an interactive context causes the result to be automatically printed. j03 &lt;- function() 1 j03() [1] 1 However, itâ€™s also possible to return an invisible() value, which is not automatically printed. j04 &lt;- function() invisible(1) j04() You can verify that the value exists either by explicitly printing it or by wrapping in parentheses: print(j04()) [1] 1 (j04()) [1] 1 Alternatively, use withVisible() to return the value and a visibility flag: str(withVisible(j04())) List of 2 $ value : num 1 $ visible: logi FALSE The most common function that returns invisibly is &lt;-: a &lt;- 2 (a &lt;- 2) [1] 2 And this is what makes it possible to chain assignment: a &lt;- b &lt;- c &lt;- d &lt;- 2 In general, any function called primarily for its side effects (like &lt;-, print(), or plot()) should return an invisible value (typically the value of the first argument). 6.6.3 Errors If a function can not complete its assigned task, it should throw an error with stop(), which immediately terminates the execution of the function. j05 &lt;- function() { stop(&quot;I&#39;m an error&quot;) return(10) } j05() Error in j05(): I'm an error Errors indicate that something has gone wrong, and force the user to handle them. Some languages (like C, go, and rust) rely on special return values to indicate problems, but in R you should always throw an error. Youâ€™ll learn more about errors, and how to handle them, in [Conditions]. 6.6.4 Exit handlers Sometimes a function needs to make a temporary change to global state and you want to ensure those changes are restored when the function completes. Itâ€™s painful to make sure you cleanup before any explicit return, and what happens if thereâ€™s an error? Instead, you can set up an exiting handler that is called when the function terminates, regardless of whether it returns a value or throws an error. To setup an exiting handler, call on.exit() with the code to be run. It will execute when the function exits, regardless of what causes it to exit: j06 &lt;- function(x) { cat(&quot;Hello\\n&quot;) on.exit(cat(&quot;Goodbye!\\n&quot;), add = TRUE) if (x) { return(10) } else { stop(&quot;Error&quot;) } } f(TRUE) [1] 4 f(FALSE) [1] 2 Always set add = TRUE when using on.exit(). If you donâ€™t, each call to on.exit() will overwrite the previous exiting handler. Even when only registering a single handler, itâ€™s good practice to set add = TRUE so that you donâ€™t get an unpleasant surprise if you later add more exit handlers on.exit() is important because it allows you to place clean-up actions next to actions with their cleanup operations. cleanup &lt;- function(dir, code) { old_dir &lt;- setwd(dir) on.exit(setwd(old), add = TRUE) old_opt &lt;- options(stringsAsFactors = FALSE) on.exit(options(old_opt), add = TRUE) } When coupled with lazy evaluation, this leads to a very useful pattern for running a block of code in an altered environment: with_dir &lt;- function(dir, code) { old &lt;- setwd(dir) on.exit(setwd(old), add = TRUE) force(code) } getwd() [1] \"D:/RStudio/mybook\" with_dir(&quot;~&quot;, getwd()) [1] \"C:/Users/linchao/Documents\" See the withr package for a collection of functions of this nature. In R 3.4 and prior, on.exit() expressions are always run in the order in which they are created: f &lt;- function() { on.exit(message(&quot;a&quot;), add = TRUE) on.exit(message(&quot;b&quot;), add = TRUE) } f() a b This can make cleanup a little tricky if some actions need to happen in a specific order; typically you want the most recent added expression to be run first. In R 3.5 and later, you can control this by setting after = FALSE: f &lt;- function() { on.exit(message(&quot;a&quot;), add = TRUE, after = FALSE) on.exit(message(&quot;b&quot;), add = TRUE, after = FALSE) } f() b a 6.6.5 Exercises What does load() return? Why donâ€™t you normally see these values? What does write.table() return? What would be more useful? How does the chdir parameter of source() compare to in_dir()? Why might you prefer one approach to the other? Write a function that opens a graphics device, runs the supplied code, and closes the graphics device (always, regardless of whether or not the plotting code worked). We can use on.exit() to implement a simple version of capture.output(). capture.output2 &lt;- function(code) { temp &lt;- tempfile() on.exit(file.remove(temp), add = TRUE, after = TRUE) sink(temp) on.exit(sink(), add = TRUE, after = TRUE) force(code) readLines(temp) } capture.output2(cat(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, sep = &quot;\\n&quot;)) Warning in file.remove(temp): ç„¡æ³•ç§»é™¤æª”æ¡ˆ 'C: \\Users\\linchao\\AppData\\Local\\Temp\\RtmpSMXp1y\\file3e7c291a104' ï¼ŒåŸå› æ˜¯ 'Permission denied' [1] \"a\" \"b\" \"c\" Compare capture.output() to capture.output2(). How do the functions differ? What features have I removed to make the key ideas easier to see? How have I rewritten the key ideas to be easier to understand? 6.7 Function forms (skip) \"To understand computations in R, two slogans are helpful: Everything that exists is an object. Everything that happens is a function call.\" â€” John Chambers While everything that happens in R is a result of a function call, not all calls look the same. Function calls come in four varieties: In prefix form, the function name comes before its arguments, like foofy(a, b, c). These constitute of the majority of function calls in R. In infix form, the function name comes inbetween its arguments, like x + y. Infix forms are used for many mathematical operators, as well as user-defined functions that begin and end with %. A replacement function assigns into what looks like a prefix function, like names(df) &lt;- c(\"a\", \"b\", \"c\"). Special forms like [[, if, and for, donâ€™t have a consistent structure and provide some of the most important syntax in R. While four forms exist, you only need to use one, because any call can be written in prefix form. Iâ€™ll demonstrate this property, and then youâ€™ll learn about each of the forms in turn. 6.7.1 Rewriting to prefix form An interesting property of R is every infix, replacement, or special form can be rewritten in prefix form. Rewriting in prefix form is useful because it helps you better understand the structure of the language, and it gives you the real name of every function. Knowing the real name of non-prefix functions is useful because it allows you to modify them for fun and profit. The following example shows three pairs of equivalent calls, rewriting an infix form, replacement form, and a special form into prefix form. x + y `+`(x, y) names(df) &lt;- c(&quot;x&quot;, &quot;y&quot;, &quot;z&quot;) `names&lt;-`(df, c(&quot;x&quot;, &quot;y&quot;, &quot;z&quot;)) for(i in 1:10) print(i) `for`(i, 1:10, print(i)) Knowing the function name of a non-prefix function allows you to override its behaviour. For example, if youâ€™re ever feeling particularly evil, run the following code while a friend is away from their computer. It will introduce a fun bug: 10% of the time, 1 will be added to any numeric calculation inside of parentheses. `(` &lt;- function(e1) { if (is.numeric(e1) &amp;&amp; runif(1) &lt; 0.1) { e1 + 1 } else { e1 } } replicate(50, (1 + 2)) [1] 3 3 4 3 3 3 3 3 3 3 4 3 3 3 3 4 3 3 3 3 3 3 3 3 4 3 3 3 4 3 3 3 3 3 3 3 3 3 [39] 3 3 3 3 4 3 3 3 3 3 3 3 rm(&quot;(&quot;) Of course, overriding built-in functions like this is a bad idea, but, as youâ€™ll learn about in [metaprogramming], itâ€™s possible to apply it only to selected code blocks. This provides a clean and elegant approach to writing domain specific languages and translators to other languages. A more useful technique is to use this knowledge when using functional programming tools. For example, you could use sapply() to add 3 to every element of a list by first defining a function add(), like this: add &lt;- function(x, y) x + y sapply(1:10, add, 3) [1] 4 5 6 7 8 9 10 11 12 13 But we can also get the same effect more simply by relying on the existing + function: sapply(1:5, `+`, 3) [1] 4 5 6 7 8 Weâ€™ll explore this idea in detail in [functionals]. 6.7.2 Prefix form {prefix-form} The prefix form is the most common form in R code, and indeed in the majority of programming languages. Prefix calls in R are a little special because you can specify arguments in three ways: By position, like help(mean). Using partial matching, like help(to = mean). By name, like help(topic = mean). As illustrated by the following chunk, arguments are matched by exact name, then with unique prefixes, and finally by position. k01 &lt;- function(abcdef, bcde1, bcde2) { list(a = abcdef, b1 = bcde1, b2 = bcde2) } str(k01(1, 2, 3)) List of 3 $ a : num 1 $ b1: num 2 $ b2: num 3 str(k01(2, 3, abcdef = 1)) List of 3 $ a : num 1 $ b1: num 2 $ b2: num 3 # Can abbreviate long argument names: str(k01(2, 3, a = 1)) List of 3 $ a : num 1 $ b1: num 2 $ b2: num 3 # But this doesn&#39;t work because abbreviation is ambiguous str(k01(1, 3, b = 1)) Error in k01(1, 3, b = 1): å¼•æ•¸ 3 æœ‰å¤šå€‹èˆ‡ä¹‹ç›¸å°æ‡‰çš„æ­£å¼å¼•æ•¸ Generally, only use positional matching for the first one or two arguments; they will be the most commonly used, and most readers will know what they are. Avoid using positional matching for less commonly used arguments, and never use partial matching. See the tidyverse style guide, http://style.tidyverse.org/syntax.html#argument-names, for more advice. 6.7.3 Infix functions Infix functions are so called because the function name comes inbetween its arguments, and hence infix functions have two arguments. R comes with a number of built-in infix operators: :, ::, :::, $, @, ^, *, /, +, -, &gt;, &gt;=, &lt;, &lt;=, ==, !=, !, &amp;, &amp;&amp;, |, ||, ~, &lt;-, and &lt;&lt;-. You can also create your own infix functions that start and end with %, and base R uses this to additionally define %%, %*%, %/%, %in%, %o%, and %x%. Defining your own infix function is simple. You create a two argument function and bind it to a name that starts and ends with %: `%+%` &lt;- function(a, b) paste0(a, b) &quot;new &quot; %+% &quot;string&quot; [1] \"new string\" The names of infix functions are more flexible than regular R functions: they can contain any sequence of characters except â€œ%â€. You will need to escape any special characters in the string used to define the function, but not when you call it: `% %` &lt;- function(a, b) paste(a, b) `%/\\\\%` &lt;- function(a, b) paste(a, b) &quot;a&quot; % % &quot;b&quot; [1] \"a b\" &quot;a&quot; %/\\% &quot;b&quot; [1] \"a b\" Râ€™s default precedence rules mean that infix operators are composed from left to right: `%-%` &lt;- function(a, b) paste0(&quot;(&quot;, a, &quot; %-% &quot;, b, &quot;)&quot;) &quot;a&quot; %-% &quot;b&quot; %-% &quot;c&quot; [1] \"((a %-% b) %-% c)\" There are two special infix functions that can be called with a single argument: + and -. -1 [1] -1 +10 [1] 10 6.7.4 Replacement functions Replacement functions act like they modify their arguments in place, and have the special name xxx&lt;-. They must have arguments named x and value, and must return the modified object. For example, the following function allows you to modify the second element of a vector: `second&lt;-` &lt;- function(x, value) { x[2] &lt;- value x } Replacement functions are used by placing the function call on the LHS of &lt;-: x &lt;- 1:10 second(x) &lt;- 5L x [1] 1 5 3 4 5 6 7 8 9 10 I say they â€œactâ€ like they modify their arguments in place, because, as discussed in [Modify-in-place], they actually create a modified copy. We can see that by using tracemem(): x &lt;- 1:10 tracemem(x) #&gt; &lt;0x7ffae71bd880&gt; second(x) &lt;- 6L #&gt; tracemem[0x7ffae71bd880 -&gt; 0x7ffae61b5480]: #&gt; tracemem[0x7ffae61b5480 -&gt; 0x7ffae73f0408]: second&lt;- If you want to supply additional arguments, they go inbetween x and value: `modify&lt;-` &lt;- function(x, position, value) { x[position] &lt;- value x } modify(x, 1) &lt;- 10 x [1] 10 5 3 4 5 6 7 8 9 10 When you write modify(x, 1) &lt;- 10, behind the scenes R turns it into: x &lt;- `modify&lt;-`(x, 1, 10) Combining replacement with other functions requires more complex translation. For example, this: x &lt;- c(a = 1, b = 2, c = 3) names(x) [1] \"a\" \"b\" \"c\" names(x)[2] &lt;- &quot;two&quot; names(x) [1] \"a\" \"two\" \"c\" Is translated into: `*tmp*` &lt;- x x &lt;- `names&lt;-`(`*tmp*`, `[&lt;-`(names(`*tmp*`), 2, &quot;two&quot;)) rm(`*tmp*`) (Yes, it really does create a local variable named tmp, which is removed afterwards.) 6.7.5 Special forms Finally, there are a bunch of language features that are usually written in special ways, but also have prefix forms. These include parentheses: (x) (`(`(x)) {x} (`{`(x)). The subsetting operators: x[i] (`[`(x, i)) x[[i]] (`[[`(x, i)) And the tools of control flow: if (cond) true (`if`(cond, true)) if (cond) true else false (`if`(cond, true, false)) for(var in seq) action (`for`(var, seq, action)) while(cond) action (`while`(cond, action)) repeat expr (`repeat`(expr)) next (`next`()) break (`break`()) Finally, the most complex is the â€œfunctionâ€ function: function(arg1, arg2) {body} (`function`(alist(arg1, arg2), body, env)) Knowing the name of the function that underlies the special form is useful for getting documentation. ?( is a syntax error; ?`(` will give you the documentation for parentheses. Note that all special forms are implemented as primitive functions (i.e. in C); that means printing these functions is not informative: `for` .Primitive(\"for\") 6.8 Invoking a function å¦ä¸€å€‹do.call()çš„åƒè€ƒ Suppose you had a list of function arguments: args &lt;- list(1:10, na.rm = TRUE) How could you then send that list to mean()? In base R, you need do.call(): do.call(mean, args) [1] 5.5 # Equivalent to mean(1:10, na.rm = TRUE) [1] 5.5 6.8.1 Exercises Rewrite the following code snippets into prefix form: 1 + 2 + 3 1 + (2 + 3) if (length(x) &lt;= 5) x[[5]] else x[[n]] Clarify the following list of odd function calls: x &lt;- sample(replace = TRUE, 20, x = c(1:10, NA)) y &lt;- runif(min = 0, max = 1, 20) cor(m = &quot;k&quot;, y = y, u = &quot;p&quot;, x = x) Explain why the following code fails: modify(get(&quot;x&quot;), 1) &lt;- 10 #&gt; Error: target of assignment expands to non-language object Create a replacement function that modifies a random location in a vector. Write your own version of + that will paste its inputs together if they are character vectors but behaves as usual otherwise. In other words, make this code work: 1 + 2 #&gt; [1] 3 &quot;a&quot; + &quot;b&quot; #&gt; [1] &quot;ab&quot; Create a list of all the replacement functions found in the base package. Which ones are primitive functions? (Hint use apropros()) What are valid names for user-created infix functions? Create an infix xor() operator. Create infix versions of the set functions intersect(), union(), and setdiff(). You might call them %n%, %u%, and %/% to match conventions from mathematics. 6.9 Quiz answers The three components of a function are its body, arguments, and environment. f1(1)() returns 11. Youâ€™d normally write it in infix style: 1 + (2 * 3). Rewriting the call to mean(c(1:10, NA), na.rm = TRUE) is easier to understand. No, it does not throw an error because the second argument is never used so itâ€™s never evaluated. See infix and replacement functions. You use on.exit(); see on exit for details. 20.â†©ï¸ Functions that automatically quote one or more arguments (sometimes called NSE functions) can override the default scoping rules to implement other varieties of scoping. Youâ€™ll learn more about that in metaprogramming.â†©ï¸ g04() returns c(1, 2, 3).â†©ï¸ g06() returns c(10, 2).â†©ï¸ g11() æ¯æ¬¡è¢«èª¿ç”¨éƒ½æ˜¯å‚³å› 1ã€‚.â†©ï¸ Functions can exit in other more esoteric ways like signalling a condition that is caught by an exiting handler, invoking a restart, or pressing â€œQâ€ in an interactive browser.â†©ï¸ "],
["è³‡æ–™æ¢ç´¢.html", "Chapter 7 è³‡æ–™æ¢ç´¢ 7.1 å¸¸ç”¨å‡½æ•¸ 7.2 ä¾†è‡ªwooldridge çš„è³‡æ–™é›† 7.3 t-test 7.4 by å‡½æ•¸t.test() 7.5 åˆ†çµ„ 7.6 plot", " Chapter 7 è³‡æ–™æ¢ç´¢ 7.1 å¸¸ç”¨å‡½æ•¸ Mean Median Quartile Percentile Range Interquartile Range Box Plot Variance Standard Deviation Covariance Correlation Coefficient Central Moment Skewness Kurtosis mean(mtcars$mpg) [1] 20.1 median(mtcars$mpg) [1] 19.2 min(mtcars$mpg) [1] 10.4 max(mtcars$mpg) [1] 33.9 quantile(mtcars$mpg) 0% 25% 50% 75% 100% 10.4 15.4 19.2 22.8 33.9 quantile(mtcars$mpg,c(0.2)) 20% 15.2 require(moments) skewness(mtcars$mpg) [1] 0.64 kurtosis(mtcars$mpg) [1] 2.8 x &lt;- rnorm(100) quantile(x, probs = c(0, 0.25, 0.5, 0.75, 1)) # quartile quantile(x, probs = seq(0, 1, by= 0.01)) # decile ecdf(x) å•é¡Œï¼šecdf()çš„çµæœå’Œquantile()çš„çµæœæ˜¯å¦ä¸€æ¨£ï¼Ÿ ##åŒ¯å…¥å…¶ä»–æ ¼å¼çš„è³‡æ–™ å®‰è£package : foreignï¼Œä»¥stata ç‚ºä¾‹(åˆ©ç”¨å…¶ä¸­çš„å‡½æ•¸read.dta())ï¼š if (!file.exists(&#39;resources/ceosal1.RData&#39;)){ ceosal1&lt;-read.dta(&quot;http://fmwww.bc.edu/ec-p/data/wooldridge/ceosal1.dta&quot;) save(ceosal1, file=&#39;resources/ceosal1.RData&#39;) } 7.2 ä¾†è‡ªwooldridge çš„è³‡æ–™é›† base cheat sheet è³‡æ–™ affairs load(&#39;resources/affairs.RData&#39;) # åŸå§‹è³‡æ–™kidæ˜¯æ•´æ•¸ï¼ŒåŠ å…¥æ¨™ç±¤æˆç‚ºfactor haskids &lt;- factor(affairs$kids,labels=c(&quot;no&quot;,&quot;yes&quot;)) mlab &lt;- c(&quot;very unhappy&quot;,&quot;unhappy&quot;,&quot;average&quot;,&quot;happy&quot;, &quot;very happy&quot;) marriage &lt;- factor(affairs$ratemarr, labels=mlab) # Frequencies for having kids: table(haskids) haskids no yes 171 430 # Marriage ratings (share): prop.table(table(marriage)) marriage very unhappy unhappy average happy very happy 0.0266 0.1098 0.1547 0.3228 0.3860 # Contigency table: counts (display &amp; store in var.) (countstab &lt;- table(marriage,haskids)) haskids marriage no yes very unhappy 3 13 unhappy 8 58 average 24 69 happy 40 154 very happy 96 136 # Share within &quot;marriage&quot; (i.e. within a row): prop.table(countstab, margin=1) haskids marriage no yes very unhappy 0.188 0.812 unhappy 0.121 0.879 average 0.258 0.742 happy 0.206 0.794 very happy 0.414 0.586 # Share within &quot;haskids&quot; (i.e. within a column): prop.table(countstab, margin=2) haskids marriage no yes very unhappy 0.0175 0.0302 unhappy 0.0468 0.1349 average 0.1404 0.1605 happy 0.2339 0.3581 very happy 0.5614 0.3163 å¦‚æœä¸çŸ¥é“å‡½æ•¸prop.table() çœ‹ä¸€ä¸‹è³‡æ–™çµæ§‹ str(x&lt;-table(haskids)) 'table' int [1:2(1d)] 171 430 - attr(*, \"dimnames\")=List of 1 ..$ haskids: chr [1:2] \"no\" \"yes\" ä¸Šé¢çš„çµæ§‹é¡¯ç¤ºï¼Œ int [1:2(1d)] 171 430 : æ•´æ•¸å‘é‡ï¼Œé•·åº¦ç”±1åˆ°2ï¼Œæ˜¯å€‹1ç¶­å‘é‡ã€‚å…ƒç´ 1åˆ°2çš„å…§å®¹åˆ†åˆ¥æ˜¯171,430ã€‚ å¯ä»¥ç”±dimnames(x)å¾—åˆ°ä¸€å€‹list,è£¡é¢åªæœ‰ä¸€å€‹å…ƒç´ ï¼Œé€™å€‹å…ƒç´ åˆæ˜¯ä¸€å€‹char list(é•·åº¦ç‚º2)ã€‚ å› æ­¤å¯ä»¥è©¦è©¦çœ‹ x/sum(x) haskids no yes 0.285 0.715 çµæœæ‡‰è©²å’Œprop.table()ä¸€æ¨£ã€‚ é‚£éº¼2 way å‘¢ï¼Ÿ ä¹Ÿæ˜¯å…ˆçœ‹çµæ§‹ï¼š str(countstab &lt;- table(marriage,haskids)) 'table' int [1:5, 1:2] 3 8 24 40 96 13 58 69 154 136 - attr(*, \"dimnames\")=List of 2 ..$ marriage: chr [1:5] \"very unhappy\" \"unhappy\" \"average\" \"happy\" ... ..$ haskids : chr [1:2] \"no\" \"yes\" countstab/rowSums(countstab) haskids marriage no yes very unhappy 0.188 0.812 unhappy 0.121 0.879 average 0.258 0.742 happy 0.206 0.794 very happy 0.414 0.586 countstab/colSums(countstab) haskids marriage no yes very unhappy 0.0175 0.0302 unhappy 0.0186 0.3392 average 0.1404 0.1605 happy 0.0930 0.9006 very happy 0.5614 0.3163 #??countstab/colsum(countstab) ceosal1 load(&#39;resources/ceosal1.RData&#39;) # sample average: mean(ceosal1$salary) [1] 1281 # sample median: median(ceosal1$salary) [1] 1039 #standard deviation: sd(ceosal1$salary) [1] 1372 # summary information: summary(ceosal1$salary) Min. 1st Qu. Median Mean 3rd Qu. Max. 223 736 1039 1281 1407 14822 # correlation with ROE: cor(ceosal1$salary, ceosal1$roe) [1] 0.115 boxplot(ceosal1$roe,horizontal = T) boxplot(ceosal1$roe~ceosal1$consprod) 7.3 t-test 7.3.1 Manually enter raw data from Wooldridge, Table C.3: SR87&lt;-c(10,1,6,.45,1.25,1.3,1.06,3,8.18,1.67,.98,1,.45, 5.03,8,9,18,.28,7,3.97) SR88&lt;-c(3,1,5,.5,1.54,1.5,.8,2,.67,1.17,.51,.5,.61,6.7, 4,7,19,.2,5,3.83) 7.3.2 Calculate Change (the parentheses just display the results): (Change &lt;- SR88 - SR87) [1] -7.00 0.00 -1.00 0.05 0.29 0.20 -0.26 -1.00 -7.51 -0.50 -0.47 -0.50 [13] 0.16 1.67 -4.00 -2.00 1.00 -0.08 -2.00 -0.14 7.3.3 Ingredients to CI formula (avgCh&lt;- mean(Change)) [1] -1.15 (n &lt;- length(Change)) [1] 20 (sdCh &lt;- sd(Change)) [1] 2.4 (se &lt;- sdCh/sqrt(n)) [1] 0.537 (c &lt;- qt(.975, n-1)) [1] 2.09 7.3.4 Confidence intervall: c( avgCh - c*se, avgCh + c*se ) [1] -2.278 -0.031 é©—è­‰ v.n &lt;- length(Change) v.mean &lt;- sum(Change)/v.n v.std &lt;-sqrt(sum((Change-v.mean)^2)/(v.n-1)) v.se &lt;- v.std/sqrt(v.n) rst&lt;-list(v.n,v.mean,v.std,v.se) rst [[1]] [1] 20 [[2]] [1] -1.15 [[3]] [1] 2.4 [[4]] [1] 0.537 ç·´ç¿’ï¼šé»‘ç™½ç¨®ï¼Œç”¨åŒä¸€å€‹CVæ‰¾å·¥ä½œã€‚ audit load(&#39;resources/audit.dta&#39;) head(audit) w b y 1 1 1 0 2 1 1 0 3 1 1 0 4 1 1 0 5 1 1 0 6 0 0 0 yæ˜¯å‰å…©å€‹æ¬„ä½ç›¸æ¸›ã€‚ä»¥ç¬¬1ç­†è³‡æ–™ç‚ºä¾‹ï¼Œå…©å€‹éƒ½æ˜¯1ï¼Œæ²’å·®åˆ¥(y=0)ã€‚ 7.3.5 by hand t statistic for H0: mu=0: è‡ªç”±åº¦(d.f.)ç‚º n-1 =240 çš„tåˆ†é…ï¼Œå…¶è‡¨ç•Œå€¼Critical values(å¦‚ä¸‹): alpha.one.tailed = c(0.1, 0.05, 0.025, 0.01, 0.005, .001) CV &lt;- qt(1 - alpha.one.tailed, n-1) cbind(alpha.one.tailed, CV) alpha.one.tailed CV [1,] 0.100 1.29 [2,] 0.050 1.65 [3,] 0.025 1.97 [4,] 0.010 2.34 [5,] 0.005 2.60 [6,] 0.001 3.12 7.4 by å‡½æ•¸t.test() H0: y=5, H1:y&gt;5, ä¿¡è³´å€é–“0.99 t.test(y, mu=5, alternative=â€œgreaterâ€, conf.level=0.99) åˆ©ç”¨å‡½æ•¸ç®—ï¼š # ex.C.3: two-sided CI t.test(audit$y) # ex.C.5 &amp; C.7: 1-sided test: t.test(audit$y, alternative=&quot;less&quot;) One Sample t-test data: audit$y t = -4.2768, df = 240, p-value = 2.739e-05 alternative hypothesis: true mean is not equal to 0 95 percent confidence interval: -0.1939385 -0.0716217 **èªªæ˜ï¼šmu +/- c.level*(se) è¦‹æ‰‹ç®—ä¾‹ ** sample estimates: mean of x -0.1327801 One Sample t-test data: audit$y t = -4.2768, df = 240, p-value = 1.369e-05 alternative hypothesis: true mean is less than 0 95 percent confidence interval: -Inf -0.08151529 sample estimates: mean of x -0.1327801 7.5 åˆ†çµ„ ç›®çš„ï¼šåˆ†çµ„æ±‚çµ±è¨ˆé‡ å¤§ç¶±æ˜¯ï¼šå…ˆæ¢ç´¢ä¸€ä¸‹æˆ‘å€‘å¯èƒ½ç”¨åˆ°çš„Rèªè¨€æŠ€å·§ï¼Œç„¶å¾Œæ˜¯å¯«æˆå‡½æ•¸ã€‚ 7.5.1 æ–¹æ³•1: åˆ©ç”¨ forè¿´åœˆ å¦‚æœä¸åˆ†çµ„ age = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group) summary(dframe) age group Min. : 5.2 Min. :1.0 1st Qu.:26.7 1st Qu.:1.0 Median :33.2 Median :1.0 Mean :29.2 Mean :1.4 3rd Qu.:35.1 3rd Qu.:2.0 Max. :36.8 Max. :2.0 data.frame çš„recordç¯©é¸ï¼Œå¯ä»¥åˆ©ç”¨é‚è¼¯å€¼ç´¢å¼•ä¾†ç¯©é¸åˆ†çµ„ï¼Œé€™è£¡çš„ç¯„ä¾‹éƒ½æ˜¯æ±‚å¾—ä¸€çµ„(ä»¥ç¬¬ä¸€åˆ†é¡ç‚ºä¾‹)ï¼š ft&lt;-factor(dframe$group) gn&lt;-length(levels(ft)) # nlevels(ft) gf&lt;-ft==levels(ft)[1] # ç¬¬ä¸€çµ„ g1&lt;-dframe[gf,] g1 age group 1 23.1 1 2 25.8 1 3 29.5 1 5 33.6 1 6 34.9 1 10 36.8 1 é™¤äº†ä¸Šé¢çš„ç¯©é¸æ–¹å¼ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨%in% ft&lt;-factor(dframe$group) gn&lt;-length(levels(ft)) # nlevels(ft) gf&lt;-as.numeric(levels(ft)[1]) # ç¬¬ä¸€çµ„ g1&lt;-dframe[group %in% gf,] # ä¸æ˜¯ gf %in% group rst&lt;-summary(g1) rst[4,1] [1] \"Mean :30.6 \" rst[4,2] [1] \"Mean :1 \" æœ€å¾Œçš„ç¨‹å¼ç¢¼ï¼š ft&lt;-factor(dframe$group) rst &lt;- as.list(numeric(nlevels(ft))) names(rst)&lt;-levels(ft) for (gi in levels(ft) ){ gf&lt;-as.numeric(gi) g1&lt;-dframe[group %in% gf,] t&lt;-summary(g1) rst[gi]=t[4,1] } print(rst) $`1` [1] \"Mean :30.6 \" $`2` [1] \"Mean :27.1 \" å‡½æ•¸summary()çš„çµæœæ˜¯ä¸€å€‹tableï¼Œä½†æ˜¯è€Œä¸”è£¡é¢çš„å…ƒç´ æ˜¯ã€Œå­—ä¸²ã€ï¼Œä¾‹å¦‚ age group Min. : 5.212 Min. :1.0 1st Qu.:26.742 1st Qu.:1.0 Median :33.212 Median :1.0 Mean :29.216 Mean :1.4 3rd Qu.:35.142 3rd Qu.:2.0 Max. :36.780 Max. :2.0 ä½†æ˜¯åœ¨å¾ˆå¤šæƒ…æ³ä¸‹ï¼Œæˆ‘å€‘å¸Œæœ›å¯ä»¥è‡ªå·±å¯ä»¥æ§åˆ¶çš„æ ¼å¼ä¾¿æ–¼é€²æ­¥åˆ†æã€‚ä¾‹å¦‚ï¼Œè¦ä¸€å€‹çŸ©é™£ï¼Œæ­¤æ™‚å¯ä»¥åˆ©ç”¨sub()ï¼š as.numeric(sub(â€™.*:â€˜,â€™â€™, summary(dframe)[4,1])) 7.5.2 æ–¹æ³•2: å‡½æ•¸aggregate() aggregate(dframe$age, by=list(dframe$group), FUN=mean) Group.1 x 1 1 30.6 2 2 27.1 aggregate(dframe$age, by=list(dframe$group), FUN=mean)[2] x 1 30.6 2 27.1 aggregate()å‚³å›data.frameï¼Œè½‰çŸ©é™£åˆ©ç”¨as.matrix() ç·´ç¿’ï¼š ä¸Šé¢çš„ç¯„ä¾‹æ˜¯æ¯çµ„æ±‚å¾—ä¸€å€‹å€¼ï¼Œå¦‚æœæ˜¯å¤šå€‹å‘¢ï¼Ÿä¾‹å¦‚åˆ©ç”¨aggregate()æ±‚å¾—æ¯çµ„min,max,median,q25,q75 ? 7.5.3 æ–¹æ³•3: å‡½æ•¸ tapply f1&lt;-function(im) { c(min(im),median(im),mean(im),max(im)) } rst&lt;-tapply(dframe$age,dframe$group,FUN = f1)#çµæœæ˜¯listå…©å€‹å…ƒç´ ï¼Œåˆ†åˆ¥å°æ‡‰f1çš„è¨ˆç®—çµæœ rstm&lt;-unlist(rst) # unlist æœƒæŠŠrst è®Šæˆ1ç¶­å‘é‡ rstm&lt;-matrix(rstm,ncol=2) # hard code2 , try `length(levels(factor(dframe$group)))` rownames(rstm)&lt;-c(&quot;min&quot;,&quot;median&quot;,&quot;mean&quot;,&quot;max&quot;) colnames(rstm)&lt;-paste(&quot;çµ„åˆ¥:&quot;,levels(factor(dframe$group))) rstm çµ„åˆ¥: 1 çµ„åˆ¥: 2 min 23.1 5.21 median 31.6 34.00 mean 30.6 27.11 max 36.8 35.21 7.5.3.1 æ–¹æ³•3 åˆ©ç”¨å…¶ä»–å¥—ä»¶ library(dplyr) dt &lt;- data.frame(age=rchisq(20,10), group=sample(1:2,20, rep=T)) grp &lt;- group_by(dt, group) summarise(grp, mean=mean(age), sd=sd(age)) detach(&quot;package:dplyr&quot;, unload=TRUE) 7.6 plot é€™è£¡çš„åˆ†çµ„ä¸èƒ½ç”¨ä¹‹å‰çš„hard code ä¸­æåˆ°çš„æ–¹æ³•ï¼Œå› ç‚ºå„çµ„å¯èƒ½æ•¸é‡ä¸åŒã€‚ v1&lt;-c(1,2,3) v2&lt;-c(4,4) cbind(v1,v2) Warning in cbind(v1, v2): number of rows of result is not a multiple of vector length (arg 2) v1 v2 [1,] 1 4 [2,] 2 4 [3,] 3 4 rbind(v1,v2) ç™¼ç”ŸéŒ¯èª¤ï¼Œæ˜¯å¦åªèƒ½ç”¨æ–¼data.frame å•é¡Œï¼š å¦‚æœæƒ³è¦åˆä½µå…©å€‹å‘é‡ï¼ŒåŒæ™‚å¦‚æœé•·åº¦ä¸ä¸€æ¨£ï¼Œå°±çŸ­çš„å‘é‡å°±è£œNAè¦æ€éº¼åšï¼Ÿç·´ç¿’å¯«æˆå‡½æ•¸ã€‚ v1 v2 [1,] 1 4 [2,] 2 4 [3,] 3 NA ç·´ç¿’: å·²ç¶“çŸ¥é“boxplot()çš„åƒæ•¸å¦‚æœå‚³é€²çŸ©é™£æˆ–è³‡æ–™é›†ï¼Œå°‡å°æ¯ä¸€å€‹æ¬„ä½ä½œåœ– note:boxplotåƒ y~xå›æ­¸å¼,ä¾‹å¦‚ boxplot(formula = Ozone ~ Month, # Y ~ X data = airquality, # è³‡æ–™ xlab = &quot;Month&quot;, ylab = &quot;Ozone (ppb)&quot;, col =&quot;red&quot;) boxplot(matrix(rnorm(100),ncol=2)) ç¾åœ¨è¦åˆ†çµ„å°å¹´é½¡boxplot,è«‹å¯«å‡ºç¨‹å¼ç¢¼ï¼Œè³‡æ–™å¦‚ä¸‹ï¼š age = c(23.0883, 25.8344, 29.4648, 32.7858, 33.6372, 34.935, 35.2115, 35.2115, 5.2115, 36.7803) group = c(1, 1, 1, 2, 1, 1, 2, 2, 2, 1) dframe = data.frame(age=age, group=group) hint: æ¯çµ„é•·åº¦å¯èƒ½ä¸ä¸€æ¨£ï¼Œéœ€è¦è£œNA hint: æœ€ç°¡å–®çš„å¯«æ³• boxplot(age~group) &lt;1&gt; FUN.Name æœƒè·‘åˆ°mathch.fun() é€™å€‹å‡½æ•¸ï¼Œè€Œé€™å€‹å‡½æ•¸æ˜¯ç”¨å­—ä¸²æœå°‹ m2: ç¾åœ¨æƒ³è¦æŠŠrstè½‰æˆdata.frameã€‚ å…ˆçœ‹ä¸€ä¸‹ç¤ºç¯„ï¼Œå¦‚ä½•æŠŠlist è½‰æˆ data.frame # è§£é‡‹çµæœ,å•stringsAsFactors=F æœ‰ä»€éº¼æ•ˆæœï¼Ÿ test1 &lt;- list( c(a=&#39;a&#39;,b=&#39;b&#39;,c=&#39;c&#39;), c(a=&#39;d&#39;,b=&#39;e&#39;,c=&#39;f&#39;)) d1&lt;-as.data.frame(test1) d1 c.a....a...b....b...c....c.. c.a....d...b....e...c....f.. a a d b b e c c f # ok test2 &lt;- list(a = c(1, 2, 3), b = c(4, 5, 6)) d2&lt;-as.data.frame(test2) d2 a b 1 1 4 2 2 5 3 3 6 "],
["r-packages.html", "Chapter 8 R Packages 8.1 åŸºæœ¬ 8.2 library() vs require() 8.3 æ¸¬è©¦debug 8.4 è‡ªè£½ package 8.5 Packing up your data 8.6 What is a package? 8.7 æ€æ¨£è‡ªè¨‚å¥—ä»¶ 8.8 è³‡æ–™æ”¾å…¥å¥—ä»¶", " Chapter 8 R Packages 8.1 åŸºæœ¬ 8.1.1 å¥—ä»¶åœ¨å“ªè£¡ R package and Github å»ºç«‹Rå¥—ä»¶ note: å¯ä»¥DOSæŒ‡ä»¤tree .åˆ—å‡ºç›®éŒ„æ¨¹çµæ§‹ R.home() [1] \"C:/PROGRA~1/R/R-4.0.2\" system.file() [1] \"C:/PROGRA~1/R/R-4.0.2/library/base\" å¦‚æœè¦çŸ¥é“å®‰è£çš„å¥—ä»¶åœ¨é›»è…¦çš„å“ªå€‹åœ°æ–¹: .libPaths() å¦‚æœè¦è‡ªå·±é è¨­æŒ‡å®šå®‰è£å¥—ä»¶ä½ç½®ï¼Œå¯ä»¥åœ¨ä½¿ç”¨è€…æ–‡ä»¶å¤¾ä¸Šæ‰¾åˆ°.Rprofile ç„¶å¾Œå¯«ä¸Šé€™ä¸€è¡Œ: .libPaths(\"C:/myRlibary\") å¥—ä»¶çš„å®‰è£ ç¯„ä¾‹: install.packages(â€˜Rcppâ€™, dependencies = TRUE) ç¬¬2å€‹åƒæ•¸,å¯ä»¥è®“ä¾å­˜çš„æª”æ¡ˆè‡ªå‹•å®‰è£ã€‚ 8.1.2 æœå°‹å¥—ä»¶ä¸­çš„æª”æ¡ˆ system.file(â€œhelpâ€, â€œAnIndexâ€, package = â€œsplinesâ€) çµæœ:[1] â€œC:/PROGRA1/MICROS4/RCLIEN~1/R_SERVER/library/splines/help/AnIndexâ€ è§£é‡‹ï¼šåœ¨å¥—ä»¶splines ä¸­çš„æ ¹ç›®éŒ„ä¸­æœå°‹å­ç›®éŒ„helpï¼Œæ‰¾å‡ºåç¨±ç‚ºAnIndexçš„æª”æ¡ˆï¼Œä¸¦å‚³å›è·¯å¾‘åç¨±ã€‚ ç·´ç¿’ï¼š ä¾‹å¦‚,å¥—ä»¶epuRateçš„å®‰è£ç›®éŒ„ç‚ºD:\\RSTUDIO\\RMD\\RPACK\\EPURATE-MASTER\\INSTï¼Œç›®éŒ„çµæ§‹å¦‚ä¸‹ï¼š D:\\RSTUDIO\\RMD\\RPACK\\EPURATE-MASTER\\INST â””â”€rmarkdown â””â”€templates â”œâ”€basic â”‚ â””â”€skeleton â”œâ”€epurate â”‚ â”œâ”€resources â”‚ â””â”€skeleton â””â”€PCTG â”œâ”€resources â””â”€skeleton åƒè€ƒä¸Šé¢çš„ç›®éŒ„çµæ§‹ï¼Œå‰‡ä¸‹é¢ç¨‹å¼åŸ·è¡Œçš„çµæœcss,header, template åˆ†åˆ¥æ˜¯ä»€éº¼? css &lt;- system.file(&quot;rmarkdown&quot;, &quot;templates&quot;, &quot;epurate&quot; ,&quot;resources&quot;, &quot;style.css&quot;, package = &quot;epuRate&quot;) header &lt;- system.file(&quot;rmarkdown&quot;, &quot;templates&quot;, &quot;epurate&quot; ,&quot;resources&quot;, &quot;header.html&quot;, package = &quot;epuRate&quot;) template &lt;- system.file(&quot;rmarkdown&quot;, &quot;templates&quot;, &quot;epurate&quot; ,&quot;resources&quot;, &quot;template_epurate.html&quot;, package = &quot;epuRate&quot;) hint: css: D:\\RSTUDIO\\RMD\\RPACK\\EPURATE-MASTER\\INST\\rmarkdown\\templates\\eurate\\resouces\\style.css å•é¡Œï¼š system.file(&#39;rmarkdown&#39;) [1] \"\" ç‚ºä»€éº¼å‚³å›ç©ºå€¼ : \"\" ? hint æ²’æœ‰æŒ‡å®šå¥—ä»¶åç¨±ï¼Œå› æ­¤é è¨­ç‚ºbaseï¼Œè€Œbaseçš„æ ¹ç›®éŒ„ä¸­ï¼Œæ‰¾ä¸åˆ°å­ç›®éŒ„æˆ–æª”æ¡ˆç‚ºrmarkdownçš„æª”æ¡ˆã€‚ ä¸‹é¢é©—è­‰é©—è­‰é€™å¥è©±ã€Œæ‰¾ä¸åˆ°å­ç›®éŒ„æˆ–æª”æ¡ˆç‚ºrmarkdownçš„æª”æ¡ˆã€ list.dirs(system.file()) [1] \"C:/PROGRA~1/R/R-4.0.2/library/base\" [2] \"C:/PROGRA~1/R/R-4.0.2/library/base/demo\" [3] \"C:/PROGRA~1/R/R-4.0.2/library/base/help\" [4] \"C:/PROGRA~1/R/R-4.0.2/library/base/html\" [5] \"C:/PROGRA~1/R/R-4.0.2/library/base/Meta\" [6] \"C:/PROGRA~1/R/R-4.0.2/library/base/R\" list.files(system.file()) [1] \"CITATION\" \"demo\" \"DESCRIPTION\" \"help\" \"html\" [6] \"INDEX\" \"Meta\" \"R\" note: list.fileså‚³å›çš„ä¸åƒ…æ˜¯æª”æ¡ˆåç¨±ï¼Œé‚„æœ‰å­ç›®éŒ„åç¨±ã€‚ system.file()å‚³å›å¥—ä»¶baseçš„æ ¹ç›®éŒ„ list.dirs(system.file()) å‚³å›ä¸Šè¿°æ ¹ç›®éŒ„çš„æ‰€æœ‰å­ç›®éŒ„ã€‚ é©—è­‰system.file()çš„æœå°‹ç¯„åœåŒ…æ‹¬å­ç›®éŒ„å’Œæª”æ¡ˆåç¨±ã€‚ä¸‹é¢çš„åƒæ•¸ï¼Œä¸€å€‹æ˜¯å­ç›®éŒ„htmlä¸€å€‹æ˜¯æª”æ¡ˆINDEXï¼Œéƒ½å‚³å›è·¯å¾‘åç¨±ã€‚ system.file(&quot;html&quot;) [1] \"C:/PROGRA~1/R/R-4.0.2/library/base/html\" system.file(&quot;INDEX&quot;) [1] \"C:/PROGRA~1/R/R-4.0.2/library/base/INDEX\" 8.1.3 å“ªå€‹å‡½æ•¸å±¬æ–¼å“ªå€‹å¥—ä»¶? å¯ä»¥ç›´æ¥æ‰“å…¥å‡½æ•¸åç¨±ä½†æ˜¯ä¸è¦æœ‰æ‹¬è™Ÿï¼Œçœ‹æœ€å¾Œä¸€è¡Œ: R.home &lt;- function (component = &quot;home&quot;) { rh &lt;- .Internal(R.home()) switch(component, home = rh, bin = if (.Platform$OS.type == &quot;windows&quot; &amp;&amp; nzchar(p &lt;- .Platform$r_arch)) file.path(rh, component, p) else file.path(rh, component), share = if (nzchar(p &lt;- Sys.getenv(&quot;R_SHARE_DIR&quot;))) p else file.path(rh, component), doc = if (nzchar(p &lt;- Sys.getenv(&quot;R_DOC_DIR&quot;))) p else file.path(rh, component), include = if (nzchar(p &lt;- Sys.getenv(&quot;R_INCLUDE_DIR&quot;))) p else file.path(rh, component), modules = if (nzchar(p &lt;- .Platform$r_arch)) file.path(rh, component, p) else file.path(rh, component), file.path(rh, component)) } &lt;bytecode: 0x3183948&gt; &lt;environment: namespace:base&gt; 8.2 library() vs require() 8.3 æ¸¬è©¦debug RTVS debug äº’å‹•R document yæ˜¯å±€éƒ¨è®Šæ•¸ã€‚ x &lt;- 2 g &lt;- function() { y &lt;- 1 c(x, y) } g() [1] 2 1 y Error in eval(expr, envir, enclos): æ‰¾ä¸åˆ°ç‰©ä»¶ 'y' rm(x, g) 8.4 è‡ªè£½ package R åŒ…è£½ä½œ package example R packages book on documentation (Hilary Parkerâ€™s is the classic), and if youâ€™re in the second camp you probably already know what youâ€™re doing (and if not, Hadley Wickhamâ€™s R packages book is an excellent and thorough guide). 8.4.1 è‡ªè£½ package ç¯„ä¾‹ æœ¬ç¯„ä¾‹ä¸­package åªæœ‰ä¸€å€‹data.frame,ä¸€å€‹å‡½æ•¸. åŸ·è¡Œå®Œpackage.seleton()ä»¥å¾Œ,å¿…é ˆåœ¨manå­ç›®éŒ„ä¸­ä¿®æ”¹æ¯å€‹RDæª”æ¡ˆ,titleè£¡é¢å¿…é ˆæœ‰å…§å®¹ã€‚ ç„¶å¾Œæ‰åŸ·è¡Œbuild() ç¯„ä¾‹éœ€è¦çš„æª”æ¡ˆï¼š trees91.csv rm(list = ls()) ufc &lt;- read.csv(&#39;./resource/trees91.csv&#39;) vol.m3 &lt;- function(dbh.cm, height.m, multiplier = 0.5) { vol.m3 &lt;- pi * (dbh.cm / 200) ^ 2 * height.m * multiplier return(vol.m3) } package.skeleton(name = &quot;xxx&quot;, path = &quot;./packages&quot;, force = TRUE) library(devtools) build(&quot;./packages/xxx&quot;) build(&quot;./packages/xxx&quot;, binary = TRUE) 8.5 Packing up your data Rstudio, package devtools , RMD å¸¸è­˜ã€‚ 8.6 What is a package? æœ€å°çš„å¥—ä»¶ä¸€èˆ¬åŒ…æ‹¬ä¸€å€‹æ ¹ç›®éŒ„ï¼Œä¸‹æœ‰ä¸€å€‹å­ç›®éŒ„R\\ï¼Œä¸€å€‹æª”æ¡ˆ DESCRIPTION(packageå«ä»€éº¼åå­ï¼Œä¾è³´æ–¼å“ªäº›å…¶ä»–å¥—ä»¶). ç•¶è¼‰å…¥å¥—ä»¶çš„æ™‚å€™ï¼ŒæœƒåŸ·è¡Œå¥—ä»¶ä¸­ä½æ–¼å­ç›®éŒ„R/ä¸­çš„.Rã€‚ 8.6.1 ä¹Ÿå¯ä»¥åŒ…å«è³‡æ–™ è³‡æ–™ä¸€èˆ¬ä½æ–¼å­ç›®éŒ„ data/ ä¸­ã€‚å‰¯æª”åä¸€èˆ¬æ˜¯.RData, .csv, .Rã€‚ä½†æ˜¯ä¸å—é™åˆ¶ã€‚ æœ‰ä¸‰å€‹æ–¹æ³•å¯ä»¥å¾å¥—ä»¶å­˜å–è³‡æ–™ã€‚ä¾‹å¦‚ï¼Œ åˆ©ç”¨:: ggplot2::diamonds %&gt;% head() library() library(ggplot2) diamonds %&gt;% head() data() data(&quot;diamonds&quot;, package=&quot;ggplot2&quot;) ls() note: 2,3 çš„ä¸åŒæ˜¯ï¼Œå¾Œè€…ç›´æ¥å°å…¥globalç©ºé–“ã€‚ 8.7 æ€æ¨£è‡ªè¨‚å¥—ä»¶ 8.7.1 åˆ©ç”¨devtools å»ºç«‹éª¨æ¶(package skeleton) 8.7.1.1 With (the slightly less easy way) å»ºç«‹å¥—ä»¶éª¨æ¶ devtools::create('~/mypackage'). ç·¨è¼¯ DESCRIPTION. ç¨‹å¼ç¢¼æ”¾å…¥å­ç›®éŒ„ R/. 8.7.2 å·¥ä½œæµç¨‹ 8.7.2.1 æ¸¬è©¦ å¦‚æœç›®å‰çš„å·¥ä½œç›®éŒ„å°±æ˜¯å¥—ä»¶æ ¹ç›®éŒ„ï¼Œé‚£éº¼åŠ å…¥è³‡æ–™å’Œå¯«å®Œç¨‹å¼ç¢¼ä»¥å¾Œï¼Œå°±å¯ä»¥ä½¿ç”¨æŒ‡ä»¤devtools::load_all()ï¼Œæˆ–æ˜¯åˆ©ç”¨Rstudio çš„æŒ‰éµã€‚å¯ä»¥åƒè€ƒé€™è£¡ã€‚ 8.7.2.2 Installed package workflow å¦‚æœå¥—ä»¶å·²ç¶“å®‰è£ï¼Œä¸¦ä¸”è¢«å…¶ä»–çš„å°ˆæ¡ˆä¸­ä½¿ç”¨ï¼Œé‚£éº¼ç¨‹å¼ç¢¼è®Šå‹•çš„è©±ï¼Œå°±å¿…é ˆ3å€‹æ­¥é©Ÿ Edit code (or add data). Re-generate documentation and namespace: devtools::document('/path/to/pkg') Install: devtools::install('/path/to/pkg'). Reload: devtools::reload(inst('pkg')). 8.7.3 Documentation and exports ç•¶å¥—å»ºç«‹ç”¨æŒ‡ä»¤library()è¼‰å…¥æ™‚ï¼Œé è¨­ä¸Šï¼Œæ‰€æœ‰çš„è®Šæ•¸å’Œå‡½æ•¸éƒ½æ˜¯ private ä¸¦ä¸æœƒè¢«åŠ å…¥åˆ° globalç’°å¢ƒã€‚ è€Œæª”æ¡ˆNAMESPACE å‰‡æ˜¯ç”¨ä¾†æŒ‡å®šè¦__public__çš„å‡½æ•¸ã€‚ å¦‚æœä¸æƒ³è¦æ‰‹å‹•ç·¨è¼¯æª”æ¡ˆNAMESPACEï¼Œå‰‡å¯ä»¥ä½¿ç”¨ç‰¹æ®ŠæŒ‡ä»¤ï¼Œç”¢ç”Ÿå¦‚ä¸‹çš„æ ¼å¼ï¼š #&#39; Short description of what this does #&#39; #&#39; Longer description of what this does. Approximately a paragraph. #&#39; #&#39; @param x The first thing #&#39; @param y The second thing. #&#39; @return The thing that comes out of this function #&#39; #&#39; @export (do export this in NAMESPACE) a_function &lt;- function(x,y) { return x+y } ç„¶å¾Œåˆ©ç”¨æŒ‡ä»¤ï¼Œ devtools::document(), æœƒè‡ªå‹•æ›´æ–° NAMESPACE ä¸¦å»ºç«‹å‡½æ•¸ç›¸é—œçš„èªªæ˜æª”ã€‚ä¾‹å¦‚ï¼Œ man/a_function.Rd. é€™æ¨£é€™å€‹å‡½æ•¸ï¼Œå°±åƒå…¶ä»–ä¸€èˆ¬çš„å‡½æ•¸ä¸€æ¨£ï¼Œå¯ä»¥æ±‚åŠ©ï¼Œä¹Ÿå¯ä»¥åœ¨æŒ‡ä»¤library()ä¹‹å¾Œå‘¼å«èª¿ç”¨ã€‚ å¦‚æœåªæ˜¯è‡ªè¡Œæ¸¬è©¦ï¼ŒæŒ‡ä»¤ devtools::load_all()å°±å¯ä»¥äº†ã€‚ ä½†æ˜¯é€šå¸¸è¦æ•£ç™¼ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨ devtools::install() å®‰è£å¥—ä»¶ã€‚ 8.8 è³‡æ–™æ”¾å…¥å¥—ä»¶ æœ€ç°¡å–®çš„æ–¹æ³•ï¼Œç›´æ¥å°‡è³‡æ–™æª” (.RData, .csv, etc.)ç½®æ–¼ data/å­ç›®éŒ„ã€‚ æ¯”è¼ƒä¸æœƒå‡ºéŒ¯çš„æ–¹å¼æ˜¯åˆ©ç”¨usethiså¥—ä»¶ï¼ˆå–ä»£èˆŠç‰ˆ devtools )ã€‚ åŸºæœ¬ä¸Šç”¨åˆ°å…©å€‹å‡½æ•¸ userthis::use_data_raw() userthis::use_data() usethis::use_data_raw()ï¼Œæœƒå»ºç«‹å­ç›®éŒ„data-raw/: åœ¨data-raw/å­ç›®éŒ„ä¸­ï¼Œæ”¾é€²éRæ ¼å¼çš„è³‡æ–™ï¼Œä¾‹å¦‚ï¼Œcsvæª”æ¡ˆã€‚ è™•ç†è³‡æ–™çš„ç¨‹å¼ç¢¼ï¼Œä»»æ„Rscript åç¨±ï¼Œç„¶å¾Œæ‰‹å‹•åŸ·è¡Œï¼Œï¼ˆä¸æœƒè¢«è‡ªå‹•åŸ·è¡Œï¼‰ç½®æ–¼ data-raw/ ï¼Œå¦‚ä¸‹ï¼š experiment1 &lt;- read.csv(&#39;expt1.csv&#39;) usethis::use_data(experiment1) This saves data/experiment1.RData in your package directory (make sure youâ€™ve setwd() to the package directoryâ€¦) æ¸¬è©¦: devtools::load_all() experiment1 %&gt;% head() ## or use data() to put it in the global environment data(&quot;experiment1&quot;) "],
["åŸºæœ¬ç¹ªåœ–.html", "Chapter 9 åŸºæœ¬ç¹ªåœ– 9.1 reference 9.2 basic 9.3 å¤šå€‹åœ–å’Œç–Šåœ– 9.4 åˆ†çµ„ç•«åœ– 9.5 Add texts within the graph 9.6 å‡½æ•¸ç•«åœ– 9.7 plot example", " Chapter 9 åŸºæœ¬ç¹ªåœ– 9.1 reference Quric R ä¸€èˆ¬è¦–çª—ä½œæ¥­ç³»çµ±çš„ç¹ªåœ–ï¼Œæœƒæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶deviceåœ¨é€™å€‹deviceä¸Šï¼Œæœ‰ä¸€å€‹æŠ½è±¡ç‰©ä»¶canvasï¼Œå’Œç¹ªåœ–å·¥å…·ä¾‹å¦‚ï¼Œæ°´å½©ç­†ä¹‹é¡çš„æŠ½è±¡ç‰©ä»¶å¯ä»¥æŒ‡å®šé¡è‰²ï¼Œç·šæ¢ç²—ç´°ç­‰ç­‰ã€‚ 9.2 basic åŸºæœ¬ç¹ªåœ–å‡½æ•¸ï¼Œplot(),hist() ãŠ™ï¸ æ€æ¨£å¿«é€ŸæŸ¥è©¢ï¼Ÿ ??draw ?plot : åƒè€ƒå…¶ä¸­çš„plot.default æŸ¥çœ‹åœ–å½¢é¸é … 9.2.1 plot å¯èƒ½æœ€å¸¸ç”¨çš„ç¹ªåœ–å‡½æ•¸å°±æ˜¯plot(),è€Œé€™å€‹å‡½æ•¸æ¯”è¼ƒå¸¸ç”¨çš„é¸é …æœ‰ï¼š * type: åƒ…åˆ†ä½ˆé»ï¼ˆé è¨­ï¼‰æ˜¯å¦é€£ç·šç­‰åŸºæœ¬æ¨¡æ¿ã€‚ * lty: ç·šæ¢æ¨£å¼line style * lwd: ç·šæ¢å¯¬åº¦line width * col: * pch: mark type description p points l lines o overplotted points and lines b, c points (empty if â€œcâ€) joined by lines s, S stair steps h histogram-like vertical lines n does not produce any points or lines ç¹ªè£½å‘é‡ ä¸­çš„è³‡æ–™ x &lt;- c(1,3,4,7,8,9) y &lt;- c(0,3,6,9,7,8) plot(x,y,main=&#39;plot(x,y)&#39;) ç¹ªè£½data.frame ä¸­çš„è³‡æ–™ plot(mtcars$wt, mtcars$mpg) abline(lm(mtcars$mpg~mtcars$wt)) title(&quot;Regression of MPG on Weight&quot;) attach(mtcars) plot(wt, mpg) abline(lm(mpg~wt)) title(&quot;Regression of MPG on Weight&quot;) plot()å‡½æ•¸ï¼Œæ–°å»ºè¦–çª—ç„¶å¾Œç•«å‡º weight vs. miles per gallon. abline() ä¸æœƒé–‹å•Ÿæ–°è¦–çª—åšåœ–ï¼Œabline()çš„èªæ³•å¦‚ä¸‹: abline(a = NULL, b = NULL, h = NULL, v = NULL, reg = NULL,coef = NULL, untf = FALSE, â€¦) ä»£è¡¨çš„æ„æ€æ˜¯ç•«å‡ºä¸€æ¢ç›´ç·ša+bx ï¼Œå…¶ä¸­aä»£è¡¨æˆªè·å¸¸æ•¸ï¼Œbå‰‡æ˜¯æ–œç‡å¸¸æ•¸ã€‚ä¾‹å¦‚ Y=2X+1ï¼Œå‰‡å°æ‡‰çš„å‡½æ•¸ç‚º abline(a=1,b=2) ã€‚ plot(sin, -pi, 2*pi) 9.2.2 æ›´å¤š require(stats) # for lowess, rpois, rnorm plot(cars) lines(lowess(cars)) 9.2.3 Histograms å‡½æ•¸hist(x)ï¼šå…¶ä¸­ xæ˜¯ä¸€å€‹æ•¸å­—å‘é‡ï¼Œ é¸é …freq=FALSE å‰‡æ˜¯ç•«å‡º probability densities è€Œä¸æ˜¯æ¬¡æ•¸ frequencies. é¸é …ï¼šbreaks= ## å‰‡æ˜¯æ§åˆ¶åˆ†æˆå¹¾ä»½ã€‚ Simple Histogram hist(mtcars$mpg) åˆ†æˆ12ä»½ï¼Œé¡è‰²ç´…è‰²ã€‚ hist(mtcars$mpg, breaks=12, col=&quot;red&quot;) è‡ªè¡Œçµ¦å®šåˆ†å‰²é» hist(mtcars$mpg, breaks=c(4,5,12,50), col=&quot;red&quot;) 9.2.3.1 Add a Normal Curve x &lt;- mtcars$mpg h&lt;-hist(x, breaks=10, col=&quot;red&quot;, xlab=&quot;Miles Per Gallon&quot;, main=&quot;Histogram with Normal Curve&quot;) xfit&lt;-seq(min(x),max(x),length=40) yfit&lt;-dnorm(xfit,mean=mean(x),sd=sd(x)) yfit &lt;- yfit*diff(h$mids[1:2])*length(x) lines(xfit, yfit, col=&quot;blue&quot;, lwd=2) hint: å› ç‚º\\(pdf=\\frac{\\frac{n}{N}}{bin \\quad width}\\) æ‰€ä»¥\\(n=pdf\\times N \\times (bin \\quad width)\\) Histograms can be a poor method for determining the shape of a distribution because it is so strongly affected by the number of bins used. h $breaks [1] 10 12 14 16 18 20 22 24 26 28 30 32 34 $counts [1] 2 1 7 3 5 5 2 2 1 0 2 2 $density [1] 0.0312 0.0156 0.1094 0.0469 0.0781 0.0781 0.0312 0.0312 0.0156 0.0000 [11] 0.0312 0.0312 $mids [1] 11 13 15 17 19 21 23 25 27 29 31 33 $xname [1] \"x\" $equidist [1] TRUE attr(,\"class\") [1] \"histogram\" 9.2.4 Kernel Density Plot æ ¸å¯†åº¦ç•«åœ–(Kernal density plots) ç”¨ä¾†è§€å¯Ÿä¸€å€‹è®Šé‡ï¼Œæ¯”è¼ƒæœ‰æœ‰æ•ˆç‡ï¼ŒæŒ‡ä»¤å¦‚ï¼šplot(density(x)) å…¶ä¸­x æ˜¯ä¸€å€‹æ•¸å­—å‘é‡ã€‚ d &lt;- density(mtcars$mpg) # returns the density data plot(d) # plots the results 9.2.4.1 Filled Density Plot d &lt;- density(mtcars$mpg) plot(d, main=&quot;Kernel Density of Miles Per Gallon&quot;) polygon(d, col=&quot;red&quot;, border=&quot;blue&quot;) 9.2.5 Saving Graphs å¯ä»¥åˆ©ç”¨menuå­˜æª”ï¼Œä¾‹å¦‚File -&gt; Save As. ä¹Ÿå¯ä»¥åˆ©ç”¨å‡½æ•¸ï¼š Function Output to pdf(â€œmygraph.pdfâ€) pdf file win.metafile(â€œmygraph.wmfâ€) | windows metafile png(â€œmygraph.pngâ€) png file jpeg(â€œmygraph.jpgâ€) jpeg file bmp(â€œmygraph.bmpâ€) bmp file postscript(â€œmygraph.psâ€) | pos postscript file 9.3 å¤šå€‹åœ–å’Œç–Šåœ– å‚»ç“œæŒ‡ä»¤ä¾‹å¦‚ (plot, hist, boxplot, etc.)åŸºæœ¬ä¸Šæœƒé–‹å•Ÿæ–°è¦–çª—ï¼Œç„¶å¾Œç•«åœ–ã€‚é€™è£¡è¨è«–å¹¾ç¨®è‡ªè¡Œæ§åˆ¶çš„æ–¹æ³•ï¼š å¤šè¦–çª—(multiple windows)ã€è¦†åœ–(combining figure) å’Œç–Šåœ–(overlay)è¨è«–ã€‚ 9.3.1 å¤šè¦–çª— é–‹å¤šè¦–çª—çš„æ–¹æ³•æ ¹æ“šOSè€Œä¸åŒï¼Œå¦‚ä¸‹ï¼š Function | Pla Platform windows() | Wi Windows X11() Unix quartz() | Mac Mac è¦é—œé–‰è¦–çª—ï¼Œå¯ä»¥ç”¨å‡½æ•¸dev.off() å¦‚æœè¦çŸ¥é“ç›®å‰çš„è¦–çª—æ˜¯é‚£ä¸€å€‹ï¼Œå¯ä»¥åƒè€ƒ dev.cur()ã€‚ Note: å¦‚æœç›®å‰æœ‰å¤šå€‹åœ–çª—ï¼Œå‰‡ä¸€ç›´å‘¼å«é€™å€‹å‡½æ•¸dev.off()ï¼Œæœƒä¾æ¬¡é—œé–‰è¦–çª—ï¼Œç›´åˆ°å‡½æ•¸å‚³å›NULLã€‚ é©—è­‰ä¸Šé¢çš„èªªæ³•å¯ä»¥åˆ©ç”¨ hist(mtcars$mpg) dev.cur() png 2 hist(mtcars$mpg) dev.cur() png 2 ä¸Šé¢çš„ç¯„ä¾‹ï¼Œå¯ä»¥çœ‹åˆ°åœ–è£ç½®çš„ç·¨è™Ÿéƒ½æ˜¯2ï¼Œä¹Ÿå°±æ˜¯å¤šå€‹åœ–åœ¨ä¸€å€‹deviceä¸Šã€‚ã€‚ hist(mtcars$mpg) dev.cur() png 2 hist(mtcars$mpg) dev.cur() png 2 dev.off() null device 1 è¨è«–ä¸‹é¢çš„è¼¸å‡ºçµæœï¼Œæˆ‘åªçœ‹åˆ°ä¸€å€‹è¦–çª—ï¼š hint: ç„¡æ³•åœ¨rmarkdown åŸ·è¡Œï¼Ÿç¢ºèªï¼Œåœ¨rscriptä¸­åŸ·è¡Œæ­£å¸¸ã€‚ X11() hist(mtcars$mpg) dev.cur() X11() hist(mtcars$mpg) dev.cur() æ¸¬è©¦ dev.new() plot(1:1) dev.new() plot(2,2) dev.set(dev.prev()) # go back to first title(main=&quot;test dev 1&quot;) dev.set(dev.next()) # go to second title(main=&quot;test dev 2&quot;) 9.3.2 åˆä½µ Plots åŒæ™‚é¡¯ç¤ºå¤šå€‹plotçš„çµæœï¼Œå¯ä»¥åˆ©ç”¨å‡½æ•¸par() or layout( )ã€‚ å‡½æ•¸par( )çš„é¸é …æœ‰ï¼š mfrow=c(nrows, ncols) å¡«plotçš„æ–¹å‘ç‚ºæ©«è¡Œã€‚ mfcol=c(nrows, ncols) å¡«å…¥çš„æ–¹å‘ç‚ºç›´è¡Œã€‚ è®Šæ•¸&lt;-par() æœƒæŠŠç›®å‰çš„åƒæ•¸æ‹¿å‡ºå­˜åˆ°è®Šæ•¸ã€‚æœ¬ä¾†æ˜¯è¦åœ¨è¨­å®šå®Œæ–°åƒæ•¸ä»¥å¾Œï¼Œåœ¨æ”¾å›å»ï¼Œä½†æ˜¯ï¼Œæœ‰äº›åƒæ•¸æ˜¯ç„¡æ³•ä¿®æ”¹çš„ï¼Œå› æ­¤ä¸è¦ç´€éŒ„äº†ï¼ˆç›´æ¥è‹±ç¿»ä¸­ï¼Œä¸è¦å”¯ç¨ï¼ç¢ºå®šï¼ˆTï¼‰ #### par() about par() âœ”ï¸ç¯„ä¾‹: ç·šæ¢å½¢å¼typeçš„å¹¾ç¨®åŸºæœ¬é¡å‹ ç¯„ä¾‹ #attach(mtcars) par(mfrow=c(2,2)) plot(wt,mpg, main=&quot;Scatterplot of wt vs. mpg&quot;) plot(wt,disp, main=&quot;Scatterplot of wt vs disp&quot;) hist(wt, main=&quot;Histogram of wt&quot;) boxplot(wt, main=&quot;Boxplot of wt&quot;) 1x3 layout # attach(mtcars) par(mfrow=c(1,3)) hist(wt) hist(mpg) hist(disp) #dev.off() note: par(mar) åˆ—å‡ºmargin par(mar=c(1,1,1,1)) æ›´å‹•margin plot.new()å¸¸ç™¼ç”Ÿçš„éŒ¯èª¤ : figure margins too large æœ‰å…©å€‹åŸå› ï¼š1 æ˜¯ç•«å¸ƒéå° 2ï¼Œç•¶å‰ç•«å¸ƒçš„ä¸Šä¸‹å·¦å³è·é›¢éå¤§ é€™è£¡çœ‹çœ‹å¦‚ä½•è§£ç¬¬äºŒå€‹ç™¼ç”ŸåŸå›  é»˜èªçš„ç•«å¸ƒä¸Šé‚Šæ¬¾çš„è·é›¢ç‚ºï¼š é è¨­ç‚º c(5, 4, 4, 2) + 0.1. å°æ‡‰ c(bottom, left, top, right)ï¼Œä¹Ÿå°±æ˜¯é †æ™‚é‡ï¼Œç”±ä¸‹åˆ°å³çµæŸä¸€åœˆã€‚ æˆ‘å€‘å¯ä»¥å°‡å…¶è¨­ç½®ç‚º0ï¼ŒåŒæ™‚å°‡ç›®å‰çš„è¨­å®šç´€éŒ„ï¼Œå¾Œé¢ç¨‹å¼çš„ç¬¬ä¸€è¡Œ op &lt;- par(mar = rep(0, 4)) # op æœƒç´€éŒ„ä¹‹å‰çš„margin = 5.1 4.1 4.1 2.1 plot.new() # ç•«åœ– par(op) # æ”¹å›åŸå…ˆçš„margin æ˜¯ä¸æ˜¯æœ‰éœ€è¦å¯«å€‹æ–°å‡½æ•¸ï¼Œç”¨ä¾†é‡è¨­è£ç½®åƒæ•¸ï¼Ÿ ä¸‹é¢é€™å€‹å‡½æ•¸resetPar()é‡æ–°è¨­å®šdevice: ä¸»è¦è©¦çœ‹é€™ä¸€è¡Œ:par(no.readonly = TRUE)ã€‚ æ„æ€æ˜¯èªªï¼Œä¸è¦ç´€éŒ„ readonlyçš„è¨­å®šã€‚ resetPar &lt;- function() { dev.new() #é‡æ–°é–‹å§‹ä¸€å€‹è£ç½® op &lt;- par(no.readonly = TRUE)#å› ç‚ºæ˜¯æ–°çš„ï¼Œæ‰€ä»¥è£¡é¢çš„è¨­å®šéƒ½æ˜¯é è¨­å€¼ dev.off()# åªæ˜¯æŠŠä¹‹å‰çš„æ–°è£ç½®é—œæ‰ op # å‚³å›é è¨­å€¼ } å…¶ä»–ç”¨æ³• par() # view current settings opar &lt;- par() # make a copy of current settings par(col.lab=â€œredâ€) # red x and y labels hist(mtcars$mpg) # create a plot with these new settings par(opar) # restore original settings æ›´å¤šçš„åœ–å½¢æ§åˆ¶: åœ¨æ•£ä½ˆåœ–ä¸­åŠ å…¥boxplot par(mar=rep(2,4)) # æ•´å€‹åœ–çš„åº§æ¨™ï¼Œæƒ³æˆå·¦ä¸‹è§’(0,0)å³ä¸Šè§’(1,1) par(fig=c(0,0.8,0,0.8))#å·¦ä¸‹(0,0)å³ä¸Š(0.8,0.8) #å·¦ä¸‹(x1,y1)å³ä¸Š(x2,y2) =&gt; c(x1,x2,y1,y2) plot(mtcars$wt, mtcars$mpg, xlab=&quot;Car Weight&quot;, ylab=&quot;Miles Per Gallon&quot;) par(fig=c(0,0.8,0.55,1), new=TRUE) boxplot(mtcars$wt, horizontal=TRUE, axes=FALSE) par(fig=c(0.65,1,0,0.8),new=TRUE) boxplot(mtcars$mpg, axes=FALSE) mtext(&quot;Enhanced Scatterplot&quot;, side=3, outer=TRUE, line=-3) ç·´ç¿’1 è®“ä¸‹é¢å…©å€‹åœ–ä¸é‡ç–Š r boxplot(mtcars$wt, axes=FALSE) par(new=TRUE) boxplot(mtcars$mpg, axes=FALSE) ç·´ç¿’2 è®“disp,mpg çš„histogram ç–Šåœ¨ä¸€èµ·: ç·´ç¿’3 æ¸¬è©¦é€™ç¯‡æ–‡ç«  9.3.2.1 layout() å‡½æ•¸ layout( ) çš„ä½¿ç”¨æ–¹æ³•ç‚º layout(mat) å…¶ä¸­ mat çš„å…ƒç´ ç”¨ä¾†æŒ‡å®šåœ–å½¢è™Ÿç¢¼ã€‚ä¾‹å¦‚åˆ†æˆ4å€‹æ ¼å­,é †åºç‚ºå·¦å³ä¸Šä¸‹(byrow=TRUE) å¦‚layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) å°æ‡‰å¦‚ä¸‹è¡¨ | 1 | 1 | |â€”|â€”| | 2 | 3 | # One figure in row 1 and two figures in row 2 #attach(mtcars) layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE)) hist(wt) hist(mpg) hist(disp) #dev.off() åœ¨layout()å‡½æ•¸ä¸­ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹åœ–å½¢å¤§å°ï¼Œå…¶åƒæ•¸ ç‚ºï¼š widths= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨column å¯¬åº¦ heights= æ•¸å­—å‘é‡ï¼Œç”¨ä¾†ä»£è¡¨row é«˜åº¦ note:Relative widths are specified with numeric values. Absolute widths (in centimetres) are specified with the lcm() function. 9.3.3 ç–Šåœ– æœ‰äº›ç¹ªåœ–æŒ‡ä»¤çš„é¸é …ï¼Œå¯ä»¥åˆ©ç”¨add=Tã€‚ ğŸ’¥ plotæŒ‡ä»¤ä¸æ”¯æ´add=T curve( dnorm(x,0,1), -5 , 5, lwd=1, lty=1) curve( dnorm(x,0,2),add=TRUE, lwd=2, lty=2) curve( dnorm(x,0,3) , add=TRUE, lwd=3, lty=3) # Add the legend legend( &quot;topright&quot;,c(&quot;sigma=1&quot;,&quot;sigma=2&quot;,&quot;sigma=3&quot;) , lwd=1:3, lty=1:3) 9.4 åˆ†çµ„ç•«åœ– 9.4.1 Comparing Groups VIA Kernal Density The sm.density.compare( ) function in the sm package allows you to superimpose the kernal density plots of two or more groups. The format is sm.density.compare(x, factor) where x is a numeric vector and factor is the grouping variable. 9.4.1.1 Compare MPG distributions for cars with 4,6, or 8 cylinders library(sm) attach(mtcars) #create value labels cyl.f &lt;- factor(cyl, levels= c(4,6,8), labels = c(&quot;4 cylinder&quot;, &quot;6 cylinder&quot;, &quot;8 cylinder&quot;)) #plot densities sm.density.compare(mpg, cyl, xlab=&quot;Miles Per Gallon&quot;) title(main=&quot;MPG Distribution by Car Cylinders&quot;) #add legend via mouse click colfill&lt;-c(2:(2+length(levels(cyl.f)))) legend(locator(1), levels(cyl.f), fill=colfill) 9.5 Add texts within the graph The text() function can be used to draw text inside the plotting area. A simplified format of the function is : text(x, y, labels) x and y: æ–‡å­—åº§æ¨™; labels: ä¾‹å¦‚ â€œa labelâ€ pos: ä¸‹å·¦ä¸Šå³ï¼Œ1234 cex: æ”¾å¤§å€æ•¸ï¼Œä¾‹å¦‚ï¼Œ0.65ã€‚ ç¯„ä¾‹ : d&lt;-head(mtcars) plot(d[,&#39;wt&#39;], d[,&#39;mpg&#39;], main=&quot;Milage vs. Car Weight\\n~~~~~~~~~~~~~~~~~~~&quot;, xlab=&quot;Weight&quot;, ylab=&quot;Miles/(US) gallon&quot;, pch=19, col=&quot;darkgreen&quot;) text(d[,&#39;wt&#39;], d[,&#39;mpg&#39;], row.names(d), cex=1,pos=3,col=&quot;red&quot;) 9.5.1 Add text in the margins of the graph åœ¨åœ–å½¢å‘¨åœçµ¦æ–‡å­—: mtext(text, side=3) text : ä¾‹å¦‚â€œa labelâ€ side : å“ªä¸€å´ : é †æ™‚é‡ 1: ä¸‹ 2: å·¦ 3: ä¸Š 4: åˆ ç¯„ä¾‹ : plot(1:10, 1:10, main=&quot;mtext(...) examples\\n~~~~~~~~~~~&quot;) mtext(&quot;Magic function&quot;, side=3) 9.5.2 Add mathematical annotation to a plot plot(1:10, 1:10, main=&quot;text(...) examples\\n~~~~~~~~~~~&quot;) text(4, 9, expression(hat(beta) == (X^t * X)^{-1} * X^t * y)) text(7, 4, expression(bar(x) == sum(frac(x[i], n), i==1, n))) 9.6 å‡½æ•¸ç•«åœ– eq = function(x){x*x} plot(eq(1:1000), type=&#39;l&#39;) å•é¡Œæ˜¯å¦‚æœxåº§æ¨™çš„å¢åŠ ä¸æ˜¯1å–®ä½? x&lt;-seq(1,10,0.1) y&lt;-exp(x) x&lt;-y eq = function(x){x*x} plot(x,eq(x), type=&#39;l&#39;) eq = function(x){x*x} curve(eq, from=1, to=50, xlab=&quot;x&quot;, ylab=&quot;y&quot;) å•é¡Œ:è§£é‡‹ç‚ºä½•éŒ¯èª¤ eq = function(x){x*x} y&lt;-eq(1:50) curve(y, xlab=&quot;x&quot;, ylab=&quot;y&quot;) Error in y(x): æ²’æœ‰é€™å€‹å‡½æ•¸ \"y\" å•é¡Œ:å¦‚ä½•ä¿®æ­£ä¸‹é¢çš„éŒ¯èª¤? eq = function(x){x*x} z&lt;-1:50 curve(eq(z), xlab=&quot;x&quot;, ylab=&quot;y&quot;) solution: 9.7 plot example æ­£å¸¸ polyred = curve(dnorm(x), xlim = c(-4,4)) polygon(polyred$x, polyred$y, col = &quot;red&quot;) â“ curv é«˜éšæŒ‡ä»¤ï¼Ÿ eq = function(x){x*x} y&lt;-eq(1:50) curve(eq, 1,50,xlab=&quot;x&quot;, ylab=&quot;y&quot;,lwd=5,col=&quot;yellow&quot;) polygon(1:50,y,lty=2,col=&quot;red&quot;) eq = function(x){x*x} y&lt;-eq(1:50) curve(eq, 1,50,xlab=&quot;x&quot;, ylab=&quot;y&quot;,lwd=5,col=&quot;yellow&quot;) polygon(c(1:50,50),c(y,0),lty=2,col=&quot;red&quot;) ğŸ’¯ â­• ç¬¬ä¸€å€‹é»å’Œæœ€å¾Œä¸€å€‹é»æœƒé€£åœ¨ä¸€èµ·ã€‚ç„¶å¾Œå¡«è‰²ã€‚ "],
["sample-and-distribution-01.html", "Chapter 10 Sample and Distribution 01 10.1 æ’åˆ—çµ„åˆèˆ‡æ¦‚ç‡çš„è¨ˆç®— 10.2 distribution", " Chapter 10 Sample and Distribution 01 ## éš¨æ©ŸæŠ½æ¨£ å‡½æ•¸sample(x,n,replace=FALSE ). å…¶ä¸­xç‚ºè¦æŠ½å–çš„å‘é‡, nç‚ºæ¨£æœ¬å®¹é‡. replace é è¨­ç‚ºfalse no replacement, ç­‰æ©Ÿç‡: ä¾‹å¦‚å¾52å¼µæ’²å…‹ç‰Œä¸­æŠ½å–5å¼µ: sample(1:52, 5) [1] 45 23 12 37 38 replacement: ä¾‹å¦‚æ‹‹ä¸€æšå‡å‹»çš„ç¡¬å¹£10æ¬¡ sample(c(&quot;H&quot;, &quot;T&quot;), 10, replace=T) [1] \"H\" \"H\" \"H\" \"T\" \"T\" \"H\" \"H\" \"H\" \"H\" \"T\" ç·´ç¿’:ä¸€æ£µéª°å­æ“²10æ¬¡å¯è¡¨ç¤ºç‚º: ä¸ç­‰å¯èƒ½çš„éš¨æ©ŸæŠ½æ¨£: sample(x, n, replace=TRUE, prob=y) prob=yæŒ‡å®šxä¸­å…ƒç´ å‡ºç¾çš„æ¦‚ç‡, å‘é‡yèˆ‡xç­‰é•·åº¦. ä¾‹å¦‚ä¸€å¨ƒå¨ƒæ©Ÿå–å‡ºæˆåŠŸçš„æ¦‚ç‡ç‚º0.6, é‚£éº¼10æ¬¡çš„è©¦é©—ç‚º: sample(c(&quot;sucess&quot;, &quot;fail&quot;), 10, replace=T, prob=c(0.6,0.4)) [1] \"fail\" \"fail\" \"sucess\" \"sucess\" \"sucess\" \"fail\" \"sucess\" \"sucess\" [9] \"fail\" \"fail\" 10.1 æ’åˆ—çµ„åˆèˆ‡æ¦‚ç‡çš„è¨ˆç®— ä¾‹ å¾ä¸€å‰¯52å¼µæ’²å…‹ä¸­å–4å¼µ, æ±‚ä»¥ä¸‹äº‹ä»¶çš„æ¦‚ç‡: 1. æŠ½å–çš„4å¼µä¾æ¬¡ç‚ºç´…å¿ƒAï¼Œæ–¹å¡ŠAï¼Œé»‘æ¡ƒAå’Œæ¢…èŠ±Açš„æ¦‚ç‡; 2. ä¸€æ¬¡æŠ½å–4å¼µç‚ºç´…å¿ƒAï¼Œæ–¹å¡ŠAï¼Œé»‘æ¡ƒAå’Œæ¢…èŠ±Açš„æ¦‚ç‡. his summation expression \\(\\sum_{i=1}^n X_i\\) appears inline. è§£ 1) æŠ½å–çš„4å¼µæ˜¯æœ‰æ¬¡åºçš„, å› æ­¤ä½¿ç”¨æ’åˆ—ä¾†æ±‚è§£. æ‰€æ±‚çš„äº‹ä»¶(è¨˜ç‚ºA)æ¦‚ç‡ç‚º \\(P(A)=\\frac{1}{52 \\times 51 \\times 50 \\times 49}\\) åˆ©ç”¨Rå‡½æ•¸ 1/prod(52:49) [1] 1.54e-07 æ²’æœ‰æ¬¡åºçš„, å¯ä»¥ä½¿ç”¨çµ„åˆæ•¸ä¾†æ±‚è§£. \\[ P(B)=\\frac{1}{(52,4)} \\] å…¶ä¸­ \\((n,m)=\\frac{n!}{m!(n-m)!}\\),å¯ä»¥åˆ©ç”¨å‡½æ•¸choose(),ä¾‹å¦‚ 1/choose(52,4) [1] 3.69e-06 10.2 distribution æ¨™æº–è¡¨æ ¼ä¸Šä¸‹æ²’æœ‰ç·šæ¢,å·¦å³æœ‰ åç¨± Rå‡½æ•¸ é¸é … beta beta shape1, shape2 binomial binom size, prob Cauchy cauchy location=0, scale=1 chi-sqaured (\\(\\chi^2\\)) chisq df, ncp exponential exp rate Fisher (F) f df1, df2, ncp gamma gamma shape, scale=1 geometric geom prob hypergeometric hyper m, n, k lognormal lnorm meanlog=0, sdlog=1 logistic logis location=0, scale=1 multinomial multinom size, prob normal norm mean=0, sd=1 negative binomial nbinom size, prob Poisson pois lambda Studentâ€™s (t) t df uniform unif min=0, max=1 Weibull weibull shape, scale=1 Wilcoxonâ€™s statistics wilcox m, n signrank n å°æ–¼æ‰€çµ¦çš„åˆ†ä½ˆåç¨±ï¼Œæœ‰å››é¡ã€‚ ä»¥funcç‚ºä¾‹ï¼Œ å››é¡å‡½æ•¸çš„å°æ‡‰ç‚º: 1. ã€Œdã€æ¦‚ç‡å¯†åº¦å‡½æ•¸: dfunc(x, p1, p2, â€¦), xç‚ºæ•¸å€¼å‘é‡; 1. ã€Œpã€(ç´¯ç©)åˆ†ä½ˆå‡½æ•¸: pfunc(q, p1, p2, â€¦), qç‚ºæ•¸å€¼å‘é‡; 1. ã€Œqã€åˆ†ä½æ•¸å‡½æ•¸: qfunc(p, p1, p2, â€¦), pç‚ºç”±æ¦‚ç‡æ§‹æˆçš„å‘é‡; 1. ã€Œrã€éš¨æ©Ÿæ•¸å‡½æ•¸: rfunc(n, p1, p2, â€¦), nç‚ºç”Ÿæˆæ•¸æ“šçš„å€‹æ•¸ é€™å››é¡å‡½æ•¸çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯æœ‰è¦å¾‹çš„: å½¢ç‚ºdfuncçš„å‡½æ•¸ç‚ºxï¼Œpfuncçš„å‡½æ•¸ç‚ºqï¼Œqfuncçš„å‡½æ•¸ç‚ºpï¼Œrfuncçš„å‡½æ•¸ç‚ºn note: (ä½†rhyperå’Œrwilcoxæ˜¯ç‰¹ä¾‹ï¼Œä»–å€‘çš„ç¬¬ä¸€å€‹åƒæ•¸ç‚ºnn). éä¸­å¿ƒåƒæ•¸(non-centrality parameter)åƒ…å°CDFå’Œ å°‘æ•¸å…¶å®ƒå¹¾å€‹å‡½æ•¸æœ‰æ•ˆ. \\[ \\frac{{\\sum\\limits_{i = 1}^n {{x_i} - n\\mu } }}{{\\sqrt {n{\\sigma ^2}} }} \\sim N(0,1) \\] \\[ \\bar X = \\frac{{\\sum_{i = 1}^n {{x_i} } }}{n} \\sim N(\\mu, \\sigma^2/n) \\] uniform a~b \\[\\mu = (a+b)/2\\] \\[\\sigma^2=\\frac{(b-a)^2}{12} \\] dataçš„æ¯ä¸€å€‹ROWæœ‰sample size (=i=column) å…±1000æ¬¡(=N=row) N=1000 i=3 #sample size mu=0.5 sigma=1/sqrt(12) data&lt;-matrix(runif(i*N),ncol=i) rs&lt;-rowSums(data) rs&lt;-rs/i z&lt;-(rs-mu)/(sigma/sqrt(i)) hist(z) lines(density(z), col = &#39;red&#39;, lwd = 3) x&lt;-z curve(dnorm(x), col = &#39;blue&#39;, lwd = 3, lty = 3, add = T) rug(sample(z,100)) limite.central &lt;- function (r = runif, distpar = c(0, 1), m = .5, s = 1 / sqrt(12), n = c(1, 3, 10, 30), N = 1000) { for (i in n) { if (length(distpar) == 2) { x &lt;-matrix(r(i * N, distpar[1], distpar[2]), nc = i) } else { x &lt;-matrix(r(i * N, distpar), nc = i) } x &lt;-(apply(x, 1, sum) - i * m) / (sqrt(i) * s) hist(x, col = &#39;light blue&#39;, probability = T, main = paste(&quot;n=&quot;, i), ylim = c(0, max(.4, density(x) $y))) lines(density(x), col = &#39;red&#39;, lwd = 3) curve(dnorm(x), col = &#39;blue&#39;, lwd = 3, lty = 3, add = T) if (N &gt; 100) { rug(sample(x, 100)) } else { rug(x) } } } op &lt;- par(mfrow=c(2,2)) limite.central(rbinom, distpar=c(10 ,0.1), m=1, s=0.9) par(op) apply(x,1,sum) ç¬¬2å€‹åƒæ•¸1è¡¨ç¤ºrow æ–¹å‘,å¦‚æœæ˜¯2è¡¨ç¤ºcolumn å’Œmatlab ç›¸åã€‚ "],
["programming-in-r.html", "Chapter 11 programming in R 11.1 æ¢ä»¶æŒ‡ä»¤ 11.2 è¿´åœˆæŒ‡ä»¤ 11.3 ç¯„ä¾‹ 11.4 Rèªè¨€çš„ meta è¨ˆç®—ã€‚ 11.5 è¨è«– 11.6 ç·´ç¿’", " Chapter 11 programming in R 11.1 æ¢ä»¶æŒ‡ä»¤ 11.1.1 if ä¸€èˆ¬ä¾†è¬›ï¼Œé€šç”¨å¯«æ³•å¦‚ä¸‹ï¼š if(åˆ¤æ–·å¼){ æˆåŠŸ }else{ å¤±æ•— } ä¾‹å¦‚ # å¤šè¡Œå¯«æ³• if(4 &gt; 3){ TRUE }else{ FALSE } å¦å¤–ï¼Œå¦‚æœå€å¡Šå…§åªæœ‰ä¸€è¡Œ if(4 &gt; 3) TRUE else FALSE 11.1.2 ifelseçš„å¯«æ³• ifelse('åˆ¤æ–·å¼','æˆåŠŸ','å¤±æ•—') ä¾‹å¦‚ï¼Œ ifelse(4 &gt; 3, T, F) 11.1.3 switchçš„å¯«æ³• switch(â€˜åˆ¤æ–·å¼`, â€™å‹•ä½œ1â€™, â€˜å‹•ä½œ2â€™, â€¦ ) ** æŒ‡å®šç¬¬å¹¾è¡Œ ** switch(2, 1, 2, #å› ç‚ºåˆ¤æ–·å¼ç‚º2ï¼Œå› æ­¤ï¼ŒåŸ·è¡Œå‹•ä½œ2 3) ** ä¹Ÿå¯ä»¥åˆ©ç”¨å­—ä¸²** switch(&quot;a&quot;, a = 1, b = 2, c = &quot;why&quot;) [1] 1 é€™å€‹switch ä¸¦ä¸æ˜¯ä¸€å€‹èªæ³•ï¼Œè€Œæ˜¯ä¸€å€‹å‡½æ•¸ï¼ŒåŸç†å¤§æ¦‚æ˜¯ ç¬¬1å€‹åƒæ•¸ä»¥å¾Œçš„æ±è¥¿ï¼Œæœƒè¢«è®Šæˆæ˜¯ä¸€å€‹named listã€‚ ä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ alist &lt;-list(a=1,b=2,c=&quot;why&quot;) ç„¶å¾Œåˆ©ç”¨åˆ¤æ–·å¼ æŸ¥æ‰¾è¦è¿”å›å°æ‡‰çš„å€¼ã€‚ 11.2 è¿´åœˆæŒ‡ä»¤ R èªè¨€çš„è¿´åœˆï¼Œå¯ä»¥æ­é… breakå’Œnextï¼Œå‰è€…è·³å‡ºè¿´åœˆï¼Œå¾Œè€…ç¹¼çºŒä¸‹ä¸€å€‹è¿´åœˆã€‚ 11.2.1 for-loop è¨ˆç®— 1+2+3+4. çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ rst &lt;- 0 for(i in c(1:4)){ rst &lt;- rst + i } 11.2.2 while-loop i &lt;- 1 result &lt;- 0 while(i &lt; 5){ rst &lt;- rst + i i &lt;- i + 1 } 11.2.3 repeat-loop i &lt;- 1 rst &lt;- 0 repeat{ if(i &gt; 4) break rst &lt;- rst + i i &lt;- i + 1 } 11.3 ç¯„ä¾‹ 11.3.1 ç¯„ä¾‹ detach_package() è¨è«–å…§å»ºå‡½æ•¸detach_package() ä½¿ç”¨æ–¹æ³•ï¼š detach_package(vegan) detach_package(&quot;vegan&quot;, TRUE) æ³¨æ„ä¸€ä¸‹ç¬¬2å€‹ä½¿ç”¨æ–¹å¼ï¼Œç¬¬2å€‹åƒæ•¸`character.onlyâ€™ï¼š detach_package &lt;- function(pkg, character.only = FALSE) { if(!character.only) #å¦‚æœæ²’æœ‰æŒ‡å®šåƒæ•¸æ˜¯å­—ä¸² { pkg &lt;- deparse(substitute(pkg)) # è½‰å­—ä¸² } search_item &lt;- paste(&quot;package&quot;, pkg, sep = &quot;:&quot;) while(search_item %in% search()) { detach(search_item, unload = TRUE, character.only = TRUE) } } 11.3.2 ç¯„ä¾‹2ï¼š.libPaths() .libPaths function (new) { if (!missing(new)) { new 11.4 Rèªè¨€çš„ meta è¨ˆç®—ã€‚ assign() èªæ³•è§£æï¼šsubstitute(), parse(), deparse() è¡¨é”å¼æ§‹é€ ï¼šquote() è¡¨é”å¼æ±‚å€¼ï¼ševal(), source() è¡¨é”å¼ï¼šexpression() parse(text=&#39;x&lt;-1+2&#39;) expression(x åœ¨Rä¸­è§£ææœ‰ä¸‰ç¨®ä¸åŒçš„è®Šç¨®ï¼š The read-eval-print loop Parsing of text files Parsing of character strings read-eval-print æ˜¯è®€å…¥æ–‡æœ¬ï¼Œç„¶å¾Œé€²è¡Œè§£æï¼Œç„¶å¾Œæ±‚å€¼ï¼Œæœ€å¾Œæ‰“å°ï¼Œé€™å€‹å°±æ˜¯æˆ‘å€‘æ—¥å¸¸çœ‹åˆ°çš„å‘½ä»¤è¡Œæ“ä½œã€‚ è§£ææ–‡ä»¶æ˜¯parseå‡½æ•¸ä¾†å®Œæˆã€‚ è§£æå­—ç¬¦ä¸²å°±æ˜¯parseä¸­ç”¨textåƒæ•¸ä¾†è¡¨ç¤ºã€‚ 11.4.1 deparse ç›¸å°æ–¼parse,deparse æŠŠexpression è½‰ç‚ºå­—ä¸²ã€‚ deparse(expression(1+2)) [1] \"expression(1 + 2)\" 11.4.2 quote quote() çš„åƒæ•¸ä¹Ÿæ˜¯expressionï¼Œè¿”å›é¡åˆ¥classï¼Œå¯ä»¥å†çµ¦eval()è¨ˆç®—ã€‚ quote()çš„åƒæ•¸é›–ç„¶æ˜¯expressionä½†æ˜¯ä¸æœƒé€²è¡Œè¨ˆç®—ï¼Œè€Œæ˜¯tokenåˆ†è§£ã€‚ quote(1+2) 1 + 2 typeof(quote(1+2)) [1] \"language\" class(quote(1+2)) [1] \"call\" 11.4.3 eval 11.4.3.1 parse() å’Œeval() text â€“&gt;parse()â€“&gt; expressionâ€”&gt;eval() #### quote() å’Œeval() expression â€“&gt;quote()â€“&gt; callâ€”&gt;eval() eval(quote(1+2)) [1] 3 ä¸€èˆ¬æ˜¯ç”¨parseå¾å­—ç¬¦ä¸²ï¼ˆæˆ–è€…æ˜¯ç¡¬ç›¤ä¸Šçš„æ–‡ä»¶ï¼‰è§£ææˆä¸€å€‹expressionå°è±¡ï¼Œæ˜¯è¡¨é”å¼åˆ—è¡¨ï¼Œä¸æ˜¯ä¸€å€‹è¡¨é”å¼ã€‚ eval(parse(text=&quot;1+2&quot;)) [1] 3 é¦–å…ˆä½¿ç”¨parse()å‡½æ•¸å°‡å­—ç¬¦ä¸²è½‰åŒ–ç‚ºè¡¨é”å¼ï¼ˆexpressionï¼‰ï¼Œè€Œå¾Œä½¿ç”¨eval()å‡½æ•¸å°è¡¨é”å¼æ±‚è§£ã€‚ ?eval # Evaluate an R expression in a specified environment. # Usage # eval(expr, envir = parent.frame(), # enclos = if(is.list(envir) || is.pairlist(envir)) # parent.frame() else baseenv()) # evalq(expr, envir, enclos) # eval.parent(expr, n = 1) # local(expr, envir = new.env()) 11.4.3.2 substitue() å¦‚æœæ²’æœ‰ç¬¬äºŒå€‹åƒæ•¸ï¼Œæ˜¯å¦substitue()==quote()? (s.e &lt;- substitute(expression(a + b), list(a = 1))) #&gt; expression(1 + b) expression(1 + b) (s.s &lt;- substitute( a + b, list(a = 1))) #&gt; 1 + b 1 + b 11.5 è¨è«– 11.5.1 æ¸¬è©¦ç´€éŒ„ test1&lt;-function (..., list = character() ) { names &lt;- c(as.character(substitute(list(...))[-1L]), list) return (names) } test1(x,y,list=&quot;data&quot;) [1] \"x\" \"y\" \"data\" names &lt;- c(as.character(substitute(list(...))[-1L]), list) * list(â€¦) æŠŠå‚³é€²ä¾†çš„åƒæ•¸æ‰“åŒ…æˆlist * åœ¨åŸ·è¡Œlist(â€¦)çš„æ™‚å€™ï¼Œå¦‚æœå‚³é€²çš„åƒæ•¸æ˜¯é‚„æ²’æœ‰åˆå€¼çš„è®Šæ•¸ï¼Œæœƒå‡ºéŒ¯ï¼Œå› æ­¤ç”¨substitute()æ‰“åŒ…ã€‚ + ç‚ºä»€éº¼ç”¨substitute()å°±ä¸æœƒå‡ºéŒ¯ï¼Œå› ç‚ºå®ƒä¸åŸ·è¡Œé€™å€‹expression(e.g. list(â€¦))ã€‚ -ç‚ºä»€éº¼å¯ä»¥ä¸åŸ·è¡Œï¼Ÿå› ç‚ºsubstitue()æœ‰æŠŠå®ƒè®ŠæˆåŒ¿åå‡½æ•¸(å’Œcallé€™å€‹é¡åˆ¥æœ‰é—œï¼Œè‡ªæ¨è«–ï¼‰ï¼Œé€™æ¨£ç•¶ç„¶ä¸æœƒæœ‰å•é¡Œã€‚ -ç‚ºä»€éº¼æœ‰-1L?æ¥çºŒä¹‹å‰çš„æ¨è«–ï¼Œç¬¬ä¸€å€‹å…ƒç´ æ‡‰è©²æ˜¯åŒ¿åå‡½æ•¸çš„å…§å»ºåç¨±ã€‚ æ‰€ä»¥æ•´å€‹å‡½æ•¸ï¼Œå°±æ˜¯æŠŠä½¿ç”¨è€…æ‰€æœ‰çš„åƒæ•¸ï¼Œæ‰“æˆå­—ä¸²å‘é‡ã€‚å¦‚ç¯„ä¾‹çµæœã€‚ 11.6 ç·´ç¿’ zeros(3,2),ones(2,3) hint: sapply(a,function(x) matrix(x,2,2), simplify=&#39;array&#39;) zeros&lt;-function (nrow,ncol) { rst&lt;-sapply(c(0),function(x) matrix(x,nrow,ncol),simplify=&#39;array&#39;) return(rst[,,1]) } x&lt;-zeros(4,5) x [,1] [,2] [,3] [,4] [,5] [1,] 0 0 0 0 0 [2,] 0 0 0 0 0 [3,] 0 0 0 0 0 [4,] 0 0 0 0 0 "],
["econometrics.html", "Chapter 12 Econometrics 12.1 package recommended", " Chapter 12 Econometrics 12.1 package recommended package foreign å¯ä»¥ç”¨ä¾†å°å…¥å¤–éƒ¨è³‡æ–™ä¾‹å¦‚ï¼Œ * stata çš„è³‡æ–™ dta, * SPSS * SAS * Systat * Mini tab . mtp åˆ©ç”¨foreignè®€å…¥stata çš„è³‡æ–™æª”ï¼š require(foreign) affairs&lt;- read.dta(&quot;http://fmwww.bc.edu/ec-p/data/wooldridge/affairs.dta&quot;) save(affairs,file=&#39;./resources/affairs.RData&#39;) æ¸¬è©¦ rm(affairs) load(&#39;./resources/affairs.RData&#39;) head(affairs) id male age yrsmarr kids relig educ occup ratemarr naffairs affair vryhap 1 4 1 37 10.0 0 3 18 7 4 0 0 0 2 5 0 27 4.0 0 4 14 6 4 0 0 0 3 6 1 27 1.5 0 3 18 4 4 3 1 0 4 11 0 32 15.0 1 1 12 1 4 0 0 0 5 12 0 27 4.0 1 3 17 1 5 3 1 1 6 16 1 57 15.0 1 5 18 6 5 0 0 1 hapavg avgmarr unhap vryrel smerel slghtrel notrel 1 1 0 0 0 0 1 0 2 1 0 0 0 1 0 0 3 1 0 0 0 0 1 0 4 1 0 0 0 0 0 0 5 0 0 0 0 0 1 0 6 0 0 0 1 0 0 0 "],
["simulate-1.html", "Chapter 13 simulate 1", " Chapter 13 simulate 1 èº«é«˜ å¥³ç”Ÿ ç”·ç”Ÿ 1 0 å¹³å‡ 180 170 æ¨™æº–å·® 10 10 fn_num&lt;-100 fh&lt;-rnorm(fn_num,180,10) fm&lt;-rnorm(200-fn_num,170,10) height&lt;-c(fh,fm) sex&lt;-c(rep(1,fn_num),rep(0,200-fn_num)) r1&lt;-tapply(height, sex,mean) r1 0 1 171 181 fn_num_set&lt;-sample(1:199,1000,replace=T) #å…ˆæŠ½å‡ºfemaleçš„å€‹æ•¸ rst&lt;-matrix(rep(0,2000),ncol=2) #æ¯ä¸€æ¬¡æŠ½æ¨£ç”·ç”Ÿ/å¥³ç”Ÿçš„å¹³å‡å€¼ for(idx in 1:1000) { fn_num &lt;-fn_num_set[idx] fh&lt;-rnorm(fn_num,180,10) fm&lt;-rnorm(200-fn_num,170,10) height&lt;-c(fh,fm) sex&lt;-c(rep(1,fn_num),rep(0,200-fn_num)) r1&lt;-tapply(height, sex,mean) rst[idx,1]=r1[1] rst[idx,2]=r1[2] } summary(rst) V1 V2 Min. :151 Min. :165 1st Qu.:169 1st Qu.:179 Median :170 Median :180 Mean :170 Mean :180 3rd Qu.:171 3rd Qu.:181 Max. :181 Max. :200 ä¸‹é¢é€™å€‹,å¥½åƒåœ¨rmarkdown ç•«ä¸å‡ºä¾† unknown reason !! alist&lt;-list(rst[,1],rst[,2]) dinfo&lt;-lapply(alist,density) t1&lt;-sapply(dinfo,function(item){range(item$x)}) rx&lt;-range(t1) t2&lt;-sapply(dinfo,function(item){range(item$y)}) ry&lt;-range(t2) plot(dinfo[[1]], xlim = rx, ylim = ry, main = &quot;&quot;) for(i in 1:length(dinfo)) { lines(dinfo[[i]], xlim = rx, ylim = ry, col = i) } è½‰å‡½æ•¸ ç¸½é«”è€Œè¨€ï¼Œè½‰æˆå‡½æ•¸çš„è€ƒæ…®å°±æ˜¯å¦‚ä½•é¿å…hard codingã€‚ plot.multi.density&lt;-function (alist) { dinfo&lt;-lapply(alist,density)#æ¯çµ„è³‡æ–™ï¼Œæ±‚density # æ¯çµ„è³‡æ–™çš„xç¯„åœ t1&lt;-sapply(dinfo,function(item){range(item$x)}) rx&lt;-range(t1) # æ¯çµ„è³‡æ–™çš„yç¯„åœ t2&lt;-sapply(dinfo,function(item){range(item$y)}) ry&lt;-range(t2) plot(dinfo[[1]],xlim = rx, ylim = ry, main = &quot;&quot;) for(i in 1:length(dinfo)) { lines(dinfo[[i]],xlim = rx, ylim = ry, col = i) } } è¨è«–ï¼šä¸Šé¢å‡½æ•¸çš„é™åˆ¶ï¼Ÿ ç¬¬ä¸€å€‹é™åˆ¶ï¼Œå…ˆçœ‹çœ‹æœ‰æ²’æœ‰é è¨­çµ„åˆ¥ å•é¡Œï¼šå¦‚æœè¦åŠ ä¸Šå€åŸŸé¡è‰²ï¼Ÿ ç°¡å–®ä¸€é»çš„è©±ï¼Œå¯ä»¥ç”¨é¸é …type=â€œhâ€, (plot, lineå…©å€‹å‡½æ•¸éƒ½åƒ) æ‡‰ç”¨è‡ªå·±çš„å‡½æ•¸ alist&lt;-list(rst[,1],rst[,2]) plot.multi.density(alist) ä¸Šé¢çš„å‡½æ•¸ï¼Œé è¨­åƒæ•¸æ˜¯å‚³å…¥ä½¿ç”¨è€…æŒ‡å®šçš„listï¼Œè£¡é¢æœ‰ä½¿ç”¨è€…æŒ‡å®šçš„çµ„åˆ¥ ä½†æ˜¯å¦‚æœå› ç‚ºéœ€è¦ï¼Œç™¼ç¾å‚³å…¥çŸ©é™£æ¯”è¼ƒæ–¹ä¾¿ï¼ˆä¾‹å¦‚æ¯ä¸€å€‹æ¬„ä½ä»£è¡¨æ¯ä¸€çµ„çš„æ¨¡æ“¬çµæœï¼Œé‚£æ¨£æ€æ¨£é¿å…hard coding? elist&lt;-vector(&quot;list&quot;,ncol(rst))#æŒ‡å®šå¤§å°çš„list,å¦‚æœç©ºé›†åˆelist&lt;-list() for(i in 1:ncol(rst)){ elist[[i]]&lt;-rst[,i] #æ³¨æ„é›™æ‹¬è™Ÿ } ä¹‹å‰æœ‰æéï¼Œå¤§éƒ¨åˆ†çš„æ–‡ä»¶éƒ½æ˜¯èªªå–®/é›™æ‹¬è™Ÿçš„å·®åˆ¥æ˜¯å‰è€…æ‹¿åˆ°çš„ä»ç„¶æ˜¯list,å¾Œè€…æ‹¿åˆ°çš„æ˜¯å…§å®¹ã€‚ ä½†æ˜¯ä»¥ç¨‹å¼èªè¨€çš„çœ¼å…‰ä¾†çœ‹ï¼Œæˆ‘å€‘å…ˆèªªå‡¡æ˜¯é™£åˆ—ï¼Œå…¶å…ƒç´ çš„å‹æ…‹éƒ½åªèƒ½æ”¾ä¸€æ¨£ï¼ˆä¹Ÿå°±æ˜¯å¤§å°å›ºå®šï¼‰ï¼Œä½†æ˜¯ç¾åœ¨listçš„å…ƒç´ å‹æ…‹å¯ä»¥ä¸å–®ä¸€ï¼Œå› æ­¤ï¼Œç·¨è­¯å™¨ç„¡æ³•çŸ¥é“å¦‚ä½•æŒ‡æ´¾å¤§å°ï¼Œè§£æ±ºè¾¦æ³•å°±æ˜¯æ¯ä¸€å€‹å…ƒç´ å…¶å¯¦éƒ½æ˜¯ä¸€å€‹æŒ‡æ¨™ã€‚ ï¼ˆtodo: éœ€è¦ä¸€å€‹åœ–ï¼‰ 13.0.1 åˆ©ç”¨å¥—ä»¶sm The sm package also includes a way of doing multiple density plots. The data must be in a data frame. library(sm) rstdf&lt;-data.frame(rst) colnames(rstdf)&lt;-c(&quot;male&quot;,&quot;female&quot;) sm.density.compare(rstdf$male, rstdf$female) # Add a legend (the color numbers start from 2 and go up) #legend(&quot;topright&quot;, levels(data$cond), fill=2+(0:nlevels(data$cond))) 13.0.2 sm ç¯„ä¾‹ sm.density.compare(iris$Sepal.Length, iris$Species, xlab=&quot;Species&quot;) title(main=&quot;Distributions of Species&quot;) x &lt;- seq(from = 110, to = 174, by = 0.5) y1 &lt;- dnorm(x, mean = 145, sd = 9) y2 &lt;- dnorm(x, mean = 138, sd = 8) plot(x, y1, type=&quot;l&quot;, lwd=2, col=&quot;red&quot;, main=&quot;Systolic Blood Pressure Before and After Treatment&quot;, xlab = &quot;Systolic Blood Pressure (mmHg)&quot;, ylab = &quot;Frequency&quot;, yaxt=&quot;n&quot;, xlim = c(110, 175), ylim = c(0, 0.05)) lines(x, y2) polygon(c(110,x,175),c(0,y2,0), col=&quot;firebrick3&quot;, border = &quot;black&quot;) polygon(c(117,x,175),c(0,y1,0), col=&quot;dodgerblue4&quot;, border = &quot;black&quot;) ylab=c(seq(from=0, to=175, by=25)) y=c(seq(from=0, to=0.05, length.out = 8)) axis(2,at=y,labels=ylab, las=1)#ä¸‹å·¦ï¼ˆ2ï¼‰ï¼Œåœ¨yå‘é‡ä¸Šæ¨™ylab,las æ–‡å­—å’Œåº§æ¨™çš„è§’åº¦ text(x = 120, y = 0.045, &quot;- Pre-Treatment BP&quot;, col = &quot;dodgerblue4&quot;, cex = 0.9) text(x = 120, y = 0.04, &quot; - Post-Treatment BP&quot;, col = &quot;firebrick3&quot;, cex = 0.9) points(109, 0.0445, pch = 15, col = &quot;dodgerblue4&quot;) points(109, 0.0395, pch = 15, col = &quot;firebrick3&quot;) å…¶ä»–æ¸¬è©¦ x &lt;- seq(-2, 2, 0.05) y1 &lt;- pnorm(x) y2 &lt;- pnorm(x,1,1) plot(x,y1,type=&quot;l&quot;,col=&quot;red&quot;) lines(x,y2,col=&quot;green&quot;) plot( x, y1, type=&quot;l&quot;, col=&quot;red&quot; ) par(new=TRUE) plot( x, y2, type=&quot;l&quot;, col=&quot;green&quot; ) note: add=TRUE æœ‰æ™‚å€™ä¸ä½œç”¨ï¼Œä¾‹å¦‚plot hist( y1 ,col=&quot;red&quot; ) hist( y2, add=TRUE,col=&quot;blue&quot; ) "],
["rbook-æè¦.html", "Chapter 14 rbook æè¦ 14.1 book 14.2 æ›´å¤š_output.yml ç¯„ä¾‹ 14.3 .travis.yml 14.4 ç´€éŒ„ 14.5 ç”¢ç”ŸPDF æ–‡ä»¶ 14.6 ä¸­æ–‡ 14.7 Rstudio chinese 14.8 å…±ç”¨è¨­å®š 14.9 å®¢è£½block 14.10 è¨è«–", " Chapter 14 rbook æè¦ markdown å¯ä»¥ä½¿ç”¨ç”¨ä¸€èˆ¬çš„æ–‡å­—ç·¨è¼¯å™¨,åœ¨æ–‡å­—ä¸­æ’å…¥MDæŒ‡ä»¤,ç”¨ä¾†ç¿»è­¯æˆHTML,PDF,WORDç­‰æ–‡ä»¶æ ¼å¼ã€‚ åœ¨RSTUDIOä¸­,å¯ä»¥å»ºç«‹web book. æˆ–åƒ…åƒ…æ˜¯ä¸€å€‹webç¶²ç«™(static)ã€‚ ç›¸é—œæŒ‡ä»¤å’Œæµç¨‹å¯ä»¥åƒè€ƒé€™è£¡ å¦‚æœæœ‰å…±ç”¨çš„yaml ,å¯ä»¥åƒè€ƒé€™è£¡ ç¨‹å¼å“¡æœƒæ¯”è¼ƒæƒ³çŸ¥é“ç›¸é—œçš„çš„æµç¨‹: The script is converted to Rmd through knitr::spin(); then rmarkdown::render() will render the Rmdã€‚ ä¹Ÿå°±æ˜¯èªª,knitræœƒå…ˆåˆ¤æ–·CHUNKéœ€è¦çš„å¼•æ“æ˜¯èª°,å¦‚æœæ˜¯R,å°±å‚³çµ¦rmakrown::render()ã€‚ Convert Rmd to R script `knitr::purl(â€œ03-purl.Rmdâ€)â€™ # output: 03-purl.R 14.0.1 æˆ‘æ¯”è¼ƒå¸¸ç”¨çš„æ ¼å¼ é€™è£¡ç¨å¾®è§£é‡‹ä¸€ä¸‹RMDæ–‡ä»¶è¡¨é ­ä¸­çš„yaml: --- title: &quot;è™•ç†2003(92R)è®Šæ•¸AB v1&quot; author: &quot;lin&quot; date: &quot;08 åæœˆ, 2020, 13:10&quot; header-includes: - \\usepackage{xeCJK} - \\setCJKmainfont{æ¨™æ¥·é«”} output: html_document: toc: yes toc_float: collapsed: false # smooth_scroll: true # df_print: paged highlight: tango css: [&quot;adv-r.css&quot;,&quot;mystyle.css&quot;] word_document: toc: yes pdf_document: latex_engine: xelatex toc: yes knit: myknit --- ä¸Šé¢çš„word_document,å…¶å¯¦å°æ‡‰ rmarkdown::word_document() è€Œä¸‹é¢çš„ toc: yes æ˜¯è¦å‚³å…¥ä¸Šé¢å‡½æ•¸çš„åƒæ•¸.å¯ä»¥å°ç…§?rmarkdown::word_document() ä¾‹å¦‚,å¦‚æœæˆ‘æƒ³è¦æŠŠæˆ‘æ¯”è¼ƒå¸¸ç”¨çš„word æ¨¡æ¿,ç•¶æˆRMD ç”¢ç”ŸWORDæ–‡ä»¶çš„æ¨¡æ¿,å¯ä»¥ æ­¥é©Ÿ1:å…ˆåˆ©ç”¨RMarkdownç”¢ç”Ÿword æ–‡ä»¶,ç„¶å¾Œåœ¨ymlçš„åƒæ•¸ä¸­æŒ‡å®š: --- ... word_document: reference_docx: myword.docx --- 14.0.2 æå–ç¨‹å¼ç¢¼ åƒè€ƒ 14.0.3 æ¯”è¼ƒè©³ç´°çš„ä»‹ç´¹: topic: å¦‚ä½•å…§å«å…¶ä»–å¤–éƒ¨HTMLæ–‡ä»¶(ğŸ‘r markdown cookbook) ````{=html} ```{r, echo=FALSE, results=&#39;asis&#39;} xfun::file_string(&#39;file.html&#39;) ``` ```` ğŸ‘R Markdown: The Definitive Guide æŒ‡ä»¤ rmarkdown::render_site() ç”¨ä¾†å»ºç«‹ç¶²ç«™ã€‚é€™å€‹æŒ‡ä»¤éœ€è¦,ä¸€å€‹æª”æ¡ˆ _site.yml,å…§å®¹å¦‚ä¸‹: name: &quot;my-website&quot; navbar: title: &quot;My Website&quot; left: - text: &quot;Home&quot; href: index.html - text: &quot;About&quot; href: about.html åŒæ™‚æª”æ¡ˆindex.html æ˜¯ç¬¬ä¸€å€‹ç¶²ç«™çš„å…¥é–€ç¶²é ã€‚ 14.1 book æŒ‡ä»¤ bookdown::render_book() éœ€è¦çš„æª”æ¡ˆæœ‰_bookdown.yml'_output.ymlâ€™ã€‚ 14.1.1 _bookdown.yml The _bookdown.yml é‚£äº›æª”æ¡ˆè¦è¢«åŒ…å«é€²ä¾†ã€‚ rmd_files: [&quot;index.Rmd&quot;, &quot;02-literature.Rmd&quot;, &quot;01-intro.Rmd&quot;] 14.1.2 _output.yml The _output.yml ç”¨ä¾†æŒ‡å®šå¦‚ä½•è¼¸å‡º,ä¾‹å¦‚HTMLå’ŒPDFçš„æ ¼å¼ã€‚ç¯„ä¾‹: bookdown::gitbook: lib_dir: assets split_by: section config: toolbar: position: static bookdown::pdf_book: keep_tex: yes bookdown::html_book: css: toc.css splitby: å¾Œé¢å¯ä»¥æ˜¯RMD,æ¯å€‹RMDä¸€å€‹HTMLæª”æ¡ˆã€‚ 14.1.3 index.Rmd é€šå¸¸æ˜¯ä¸€ç³»åˆ—æ–‡ç« è£¡é¢çš„ç¬¬ä¸€å€‹æ–‡ä»¶ã€‚å…¶ä»–rmdæ–‡ä»¶çš„yml é ­éƒ¨éƒ½å¯ä»¥çµ±ä¸€æ”¾åœ¨é€™è£¡ã€‚ ä¸‹é¢æ˜¯ä¸€äº›é¸é …,å¯ä»¥è‡ªè¡Œæ·»åŠ åˆ°ä¸Šé¢: bibliography: [book.bib, packages.bib] biblio-style: apalike link-citations: yes github-repo: rstudio/bookdown-demo bibliography æš«æ™‚æ²’æœ‰åƒè€ƒæ–‡ä»¶æª”,æ‰€ä»¥æˆ‘æ²’æœ‰æ”¾. åƒè€ƒä½ç½®: * HTML Format ä¾†è‡ªrmarkdown from rstudio * pandox 14.2 æ›´å¤š_output.yml ç¯„ä¾‹ ç°¡å–®è¬›,_output.ymlæ”¾çš„æ˜¯è¼¸å‡ºåˆ°å“ªè£¡?gitbook? pdf? æˆ–è€…æ˜¯ç°¡å–®htmlæ ¼å¼ã€‚ 14.2.1 _output.yml ç¯„ä¾‹ bookdown::gitbook: css: style.css config: toc: before: | &lt;li&gt;&lt;a href=&quot;./&quot;&gt;A Minimal Book Example&lt;/a&gt;&lt;/li&gt; after: | &lt;li&gt;&lt;a href=&quot;https://github.com/rstudio/bookdown&quot; target=&quot;blank&quot;&gt;Published with bookdown&lt;/a&gt;&lt;/li&gt; edit: https://github.com/rstudio/bookdown-demo/edit/master/%s download: [&quot;pdf&quot;, &quot;epub&quot;] # bookdown::pdf_book: # latex_engine: &quot;xelatex&quot; # keep_tex: true # includes: # in_header: header.tex bookdown::pdf_book: includes: in_header: latex/preamble.tex before_body: latex/before_body.tex after_body: latex/after_body.tex keep_tex: true dev: &quot;cairo_pdf&quot; latex_engine: xelatex citation_package: natbib pandoc_args: [&quot;--top-level-division=chapter&quot;, &quot;--lua-filter=latex/sidebar.lua&quot;] template: null quote_footer: null toc_unnumbered: false number_sections: true --- output: html_document: highlight: tango number_sections: yes toc: yes --- ä¸Šé¢é€™æ®µYMLæœƒè¢«è§£è­¯åˆ°ä¸‹é¢çš„Rç¨‹å¼ç¢¼ã€‚ çŒœæ¸¬:html_documentå°æ‡‰rmarkdown::html_document ä¾‹å¦‚, number_sections: yes æœƒè¢«ç•¶æˆhtml_document()çš„åƒæ•¸è½‰è­¯: highlight: tango å°æ‡‰åˆ°åƒæ•¸(æ²’æœ‰åœ¨ä¸‹é¢) rmarkdown::html_document( theme= &quot;lumen&quot;, template= template, css= css, toc= toc, toc_float= TRUE, toc_depth= 2, number_sections= number_sections, df_print = &quot;paged&quot;, code_folding = code_folding, includes = includes(before_body = header) ) } 14.3 .travis.yml rmarkdown and travis æ‡‰è©²æ˜¯ç”¨ä¾†æŒ‡å°æ€éº¼å»ºç«‹å°ˆæ¡ˆçš„ä¸€å€‹ymlã€‚ å·²çŸ¥çš„éƒ¨åˆ†æœ‰: directories : å¯ä»¥æŒ‡å®šå­ç›®éŒ„,ç”¨ä¾†æ”¾æš«å­˜æª”æ¡ˆ(ä¸€äº›ç¿»è­¯éç¨‹ç”¢ç”Ÿçš„ä¸­é–“é»¨),å¦å‰‡æ¯å€‹RMDéƒ½æœƒç”¢ç”Ÿä¸€å€‹çµ„ç›®éŒ„ã€‚ language: R sudo: false cache: packages: true directories: - _bookdown_files - $HOME/.npm pandoc_version: 2.1.1 14.4 ç´€éŒ„ before_chapter_script: â€œcommon.Râ€ å‰é¢è¦æœ‰å…©å€‹ç©ºç™½ if(FALSE) { â€™ å…©å€‹åœ°æ–¹å¯ä»¥æ”¾, 1) ä¸€å€‹æ˜¯åœ¨_bookdown.ymlä¸­çš„æœ€å¾Œä¸€è¡Œ: before_chapter_script: â€œcommon.Râ€ 2)ä¸€å€‹æ˜¯åœ¨æ¯å€‹RMDçš„ç¬¬ä¸€å€‹chunkåŸ·è¡Œ source(â€œcommon.Râ€) â€™ } 14.4.1 knitr hook 14.4.1.1 é¡è‰² è¨­å®šè­¦å‘Šè¨Šæ¯ç‚ºç´…è‰² knitr::knit_hooks$set(error = function(x, options) { paste0(&quot;&lt;pre style=\\&quot;color: red;\\&quot;&gt;&lt;code&gt;&quot;, x, &quot;&lt;/code&gt;&lt;/pre&gt;&quot;) }) å…¶ä»–ç¯„ä¾‹ #Color Format colFmt = function(x,color){ outputFormat = opts_knit$get(&quot;rmarkdown.pandoc.to&quot;) if(outputFormat == &#39;latex&#39;) paste(&quot;\\\\textcolor{&quot;,color,&quot;}{&quot;,x,&quot;}&quot;,sep=&quot;&quot;) else if(outputFormat == &#39;html&#39;) paste(&quot;&lt;font color=&#39;&quot;,color,&quot;&#39;&gt;&quot;,x,&quot;&lt;/font&gt;&quot;,sep=&quot;&quot;) else x } æœ‰é—œhook çš„è¨­å®š,åƒè€ƒ knitr hook 14.4.2 terminal output å•é¡Œ:å¦‚æœä»¥è¦çœ‹æª”æ¡ˆå…§å®¹,è€Œä¸æƒ³è¢«ç„¡é—œçš„è¼¸å‡ºç¬¦è™Ÿå¹²æ“¾,ä¾‹å¦‚[1],é‚£éº¼å¦‚æœå†R SCRIPTä¸­å¯ä»¥ä½¿ç”¨ system(\"cat æª”æ¡ˆåç¨±\") ,ä½†æ˜¯åœ¨R Markdownä¸­(å¦‚ä¸‹)ä¸æœƒé¡¯ç¤ºå‡ºçµæœ: rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) write.csv(rst, file = &quot;MyData.csv&quot;,row.names=FALSE, na=&quot;&quot;) system(&quot;cat MyData.csv&quot;) [1] 0 You can use either {r, engine=â€˜bashâ€™, comment=â€™â€˜} cat â€™resources/hw.csvâ€™ or cat(readLines(&#39;resources/wh.csv&#39;), sep = &#39;\\n&#39;) # this is a test file height,weight,sex 156,56, m 167,., f 189,70, m 180,, f 14.5 ç”¢ç”ŸPDF æ–‡ä»¶ ** ä¸­æ–‡å­—å‹å•é¡Œ ** åƒè€ƒ update.packages(ask = FALSE, checkBuilt = TRUE) tinytex::tlmgr_update() ä¸­æ–‡ï¼š ä¸è¦ç®¡é‚£éº¼å¤šç¶²è·¯ä¸Šè¬›çš„ï¼Œå°± devtools::install_github(c(&#39;rstudio/rmarkdown&#39;, &#39;yihui/tinytex&#39;)) tinytex::install_tinytex() å¤§éƒ¨åˆ†å•é¡Œéƒ½æ˜¯ä¸­æ–‡è‡ªè¡Œæ²’æœ‰å®‰è£æˆ–æŒ‡å®šéŒ¯èª¤çš„å•é¡Œï¼š åœ¨RMDæª”æ¡ˆé–‹é ­æŒ‡å®š --- title: &quot;xxx&quot; author: &quot;xxx&quot; date: &quot;2020å¹´8æœˆ10æ—¥&quot; header-includes: - \\usepackage{xeCJK} - \\setCJKmainfont{æ¨™æ¥·é«”} output: html_document: toc: yes df_print: paged word_document: toc: yes pdf_document: latex_engine: xelatex toc: yes --- 14.5.1 Overview åƒè€ƒ æ•´å€‹è½‰æ›éç¨‹å¦‚ä¸‹ï¼š Rmarkdown -&gt; markdown -&gt;pandoc-&gt;pdf,html 14.5.2 meta data ä¸Šçš„pdf è¨­å®š,å¸¸è¦‹ç‰ˆæœ¬ --- title: &quot;Habits&quot; author: lendjwjcen date: 3/1/2017 output: pdf_document --- 14.5.2.1 åŠ å…¥ç›®éŒ„ --- title: &quot;Habits&quot; output: pdf_document: toc: true toc_depth: 2 --- TOCæ·±åº¦é è¨­æ˜¯3ã€‚ yamlçš„è¨»è§£ç¬¦è™Ÿæ˜¯# ã€‚ å¦‚æœè¦ç« ç¯€è™Ÿç¢¼,å‰‡åˆ©ç”¨number_sections option: --- title: &quot;Habits&quot; output: pdf_document: toc: true number_sections: true --- 14.5.2.2 åœ–å½¢é¸é … fig_width å’Œ fig_height æ§åˆ¶åœ–å½¢çš„å¯¬åº¦å’Œé«˜åº¦ (6 x 4.5 is used by default) fig_crop æ§åˆ¶ pdfcrop utility (å¦‚æœæœ‰)æ˜¯å¦è‡ªå‹•ä½¿ç”¨ä¾†ä¿®å‰ªåœ–å‹(default). å¦‚æœæˆ‘å€‘çš„åœ–å½¢è¨­å‚™æ˜¯ postscript, å»ºè­°é—œæ‰é€™å€‹é¸é …ã€‚. fig_caption æ§åˆ¶æ˜¯å¦æœ‰åœ–å‹æ¨™é¡Œ(é è¨­æ˜¯å¦) dev æ§åˆ¶ç”¨ä¾†æç¹ªåœ–å‹çš„è¨­å‚™ (defaults to pdf) ä¾‹å¦‚: --- title: &quot;Habits&quot; output: pdf_document: fig_width: 7 fig_height: 6 fig_caption: true --- 14.5.2.3 Data Frame Printing df-print åƒæ•¸å¯ä»¥ç”¨ä¾†æ”¹é€²data frameçš„è¼¸å‡º,é¸é …åŒ…æ‹¬: é¸é …æè¿° default: åˆ©ç”¨ print.data.frame å‡½æ•¸ kable å…¶å¯¦åˆ©ç”¨çš„æ˜¯ knitr::kable å‡½æ•¸ tibble å‰‡åˆ©ç”¨ tibble::print.tbl_df å‡½æ•¸ã€‚. ä¾‹å¦‚: --- title: &quot;Habits&quot; output: pdf_document: df_print: kable --- 14.5.2.4 Syntax Highlighting æ‰“å…‰å‹æ…‹æœ‰ â€œdefaultâ€, â€œtangoâ€, â€œpygmentsâ€, â€œkateâ€, â€œmonochromeâ€, â€œespressoâ€, â€œzenburnâ€, and â€œhaddockâ€ å¦‚æœä¸è¦æ‰“å…‰,å‰‡è¨­å®šnull: ä¾‹å¦‚: --- title: &quot;Habits&quot; output: pdf_document: highlight: tango --- 14.5.2.5 LaTeX Options æœ‰é—œLaTeXé¸é …çš„è¨­å®šä½ç½®ä¸¦ä¸æ˜¯åœ¨output: pdf_documentçš„å¾ŒçºŒæ®µè½,è€Œæ˜¯åœ¨æœ€é ‚å±¤ã€‚ ä¾‹å¦‚: --- title: &quot;Crop Analysis Q3 2013&quot; output: pdf_document fontsize: 11pt geometry: margin=1in --- 14.5.2.6 åœ¨RMDä¸­æœ‰RMD ```{block2, type=&#39;FOO&#39;} Some text for this block [@citation-key]. - a list item - another item - end the list with a blank line ``` 14.5.2.7 å…¶ä»– Available metadata variables include: Variable Description papersize paper size, e.g. letter, A4 lang Document language code fontsize Font size (e.g. 10pt, 11pt, 12pt) documentclass LaTeX document class (e.g. article) classoption Option for documentclass (e.g. oneside); may be repeated geometry Options for geometry class (e.g. margin=1in); may be repeated linkcolor, urlcolor, citecolor |Color Color for internal, external, and citation links (red, green, magenta, cyan, blue, black) thanks specifies contents of acknowledgments footnote after document title. æ›´å¤šæ§åˆ¶å¯ä»¥åœ¨ here.æ‰¾åˆ° 14.5.3 LaTeX Packages for Citations citationçš„è™•ç†,é è¨­æ˜¯ç¶“ç”± pandoc-citeproc(ä¸åƒ…PDFæ–‡ä»¶,é‚„æœ‰HTML), ä½†æ˜¯å°æ–¼PDFä¾†è¬›,æœ€å¥½é‚„æ˜¯ä½¿ç”¨ LaTeX ä¾†è™•ç†ä¾‹å¦‚ natbib or biblatexã€‚è¨­å®šæ–¹æ³•åƒ…åƒ…æ˜¯è¨­å®š citation_package ç‚º natbib æˆ– biblatex, ä¾‹å¦‚: --- output: pdf_document: citation_package: natbib --- 14.6 ä¸­æ–‡ å»ºç«‹ä¸­æ–‡PDF éœ€è¦å®‰è£ TeXç‰ˆæœ¬å¯ä»¥ä½¿ç”¨tinytexã€‚ install.packages(&#39;tinytex&#39;) tinytex::install_tinytex() 14.7 Rstudio chinese cd /usr/lib/rstudio/bin sudo mkdir Qt sudo mv libQt5* Qt sudo mv qt.conf Qt 14.7.1 LaTeX Engine RStudio é è¨­ä½¿ç”¨ pdflatex. æˆ‘å€‘å¯ä»¥ä½¿ç”¨ latex_engine é¸é …è¨­å®šå…¶ä»–å¼•æ“ä¾‹å¦‚, â€œpdflatexâ€, â€œxelatexâ€, and â€œlualatexâ€. è€Œä¸­æ–‡çš„å¼•æ“ç¯„ä¾‹: --- title: &quot;Habits&quot; output: pdf_document: latex_engine: xelatex --- ä½†æ˜¯åªæœ‰é€™æ¨£é‚„ä¸å¤ ï¼Œå› ç‚ºæˆ‘å€‘éœ€è¦ä¸­æ–‡å­—å‹,é€™æ™‚å¯ä»¥åˆ©ç”¨indcludeé¸é …: ### Include è¦åœ¨æ–‡ä»¶æœ¬èº«(body)å‰é¢å¾Œé¢åŠ ä¸Šä¸€äº›å…§å®¹,å¯ä»¥åˆ©ç”¨includes é¸é …: --- title: &quot;Habits&quot; output: pdf_document: includes: in_header: header.tex before_body: doc_prefix.tex after_body: doc_suffix.tex --- æœ€å¾Œçš„ä¸­æ–‡è¨­å®šå¯ä»¥æ˜¯é€™æ¨£ --- title: &quot;Untitled&quot; author: &quot;lin&quot; date: &quot;î£™&quot; output: pdf_document: latex_engine: xelatex includes: in_header: header.tex header.texçš„å…§å®¹(%æ˜¯è¨»è§£): \\usepackage{xeCJK} % microsoft windows % linux font \\setCJKmainfont{AR PL UMing TW} % microsoft font % \\setCJKmainfont{å¾®è»Ÿæ­£é»‘é«”} % \\setCJKmainfont{Microsoft YaHei} %\\setmainfont{Georgia} % è¨­å®šè‹±æ–‡å­—å‹ %\\setromanfont{Georgia} % å­—å‹ %\\setmonofont{Courier New} 14.7.2 è¨»è¨˜ æœ‰é—œä¸€äº›ä¸­æ–‡å¸¸å¸¸ç™¼ç”Ÿçš„éŒ¯èª¤ï¼š ç„¡æ³•è§£æ±ºå­—å‹éŒ¯èª¤:Package fontspec Error: The font â€œInconsolataâ€ cannot be found æ”¹ç”¨å…¶ä»–å­—å½¢ï¼Œä¾‹å¦‚ä½¿ç”¨æŒ‡ä»¤ fc-list :lang=zh-tw fullname æ–°ç³»çµ±ä¾‹å¦‚linuxå®‰è£å®Œä»¥å¾Œï¼Œå¦‚æœè¦æ¸¬è©¦ä¸­æ–‡æ˜¯å¦å¯ç”¨æ–¼ç”¢ç”Ÿpdfï¼Œæœ€å¥½åˆ©ç”¨ä¸€äº›çŸ­æ–‡ã€‚ ### æ¸¬è©¦ä¸­æ–‡è½‰pdf ä¸‹åˆ—çš„æª”æ¡ˆåç¨±ç‚ºx1.tx,æ¸¬è©¦çš„æ™‚å€™ï¼Œå¯ä»¥åˆ©ç”¨tinytex::xelatex(x1.tex) ç”¨ä¾†é©—è­‰æ˜¯å¦ä¸­æ–‡å¯ä»¥è½‰pdfã€‚ é€™è£¡å…ˆåˆ©ç”¨texå°æª”æ¡ˆæ¸¬è©¦xelatexæ˜¯å¦åŠŸèƒ½æ­£å¸¸ã€‚ \\documentclass{book} \\usepackage{xeCJK} \\setCJKmainfont{AR PL UMing TW} \\begin{document} æ—©å®‰ï¼Œå°ç£ $$b^2-4\\times a \\times c$$ night TeXing. \\end{document} 14.7.3 Custom Templates ä¹Ÿå¯ä»¥åˆ©ç”¨é¸é …template å–ä»£pandoc æ¨¡æ¿ : --- title: &quot;Habits&quot; output: pdf_document: template: quarterly_report.tex --- åƒè€ƒ pandoc templates ä¸Šçš„èªªæ˜ã€‚æˆ–è€…åƒè€ƒ default LaTeX template ä¸­çš„ç¯„ä¾‹ã€‚ 14.7.4 Pandoc Arguments å¦‚æœåœ¨YAMLä¸­æ‰¾ä¸åˆ°ç›¸é—œæ–¼pandocçš„é¸é …,å‰‡å¯ä»¥ç›´æ¥åˆ©ç”¨ pandoc_args. ä¾‹å¦‚: --- title: &quot;Habits&quot; output: pdf_document: pandoc_args: [ &quot;--no-tex-ligatures&quot; ] --- 14.8 å…±ç”¨è¨­å®š å¤šå€‹æ–‡ä»¶å¦‚æœéƒ½æœ‰ä¸€æ¨£çš„è¼¸å‡ºæ ¼å¼,å‰‡å¯ä»¥åˆ©ç”¨æª”æ¡ˆ _output.yaml ä¾‹å¦‚: **_output.yaml** pdf_document: toc: true highlight: zenburn åšç‚ºæ–‡ä»¶ä¸­çš„YAMLçš„æ¯”å°,å¯ä»¥ç™¼ç¾,åªæ˜¯æŠŠoutput: çš„å¾Œé¢æ•´å€‹å±¤ç´šæ¬åˆ°_output.yamlã€‚ --- title: &quot;Habits&quot; output: pdf_document: includes: in_header: header.tex before_body: doc_prefix.tex after_body: doc_suffix.tex --- 14.9 å®¢è£½block å®¢è£½blockåƒè€ƒ([git](https://github.com/rstudio/bookdown/blob/master/inst/examples/02-components.Rmd)) ç›¸é—œtex 14.9.1 è§£é‡‹ç¯„ä¾‹ è³‡æºå­ç›®éŒ„ä¸‹å¯ä»¥æ‰¾åˆ°ç›¸é—œå°ˆæ¡ˆ(customizedBlock)ã€‚ åœ¨RMDä¸­æ‰“å…¥ - RMDæª”æ¡ˆå…§å®¹ : ::: xxx ::: - xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx - yyyy yyyyyyyyyyyyyyyyyyyyy æœƒåœ¨ç”¢ç”Ÿçš„texç”¢ç”Ÿä¸€å€‹environment xxx æª”æ¡ˆpreamble.tex å…§å®¹: \\usepackage{booktabs} \\makeatletter \\newenvironment{kframe}{% \\medskip{} \\setlength{\\fboxsep}{.8em} \\def\\at@end@of@kframe{}% \\ifinner\\ifhmode% \\def\\at@end@of@kframe{\\end{minipage}}% \\begin{minipage}{\\columnwidth}% \\fi\\fi% \\def\\FrameCommand##1{\\hskip\\@totalleftmargin \\hskip-\\fboxsep \\colorbox{shadecolor}{##1}\\hskip-\\fboxsep % There is no \\\\@totalrightmargin, so: \\hskip-\\linewidth \\hskip-\\@totalleftmargin \\hskip\\columnwidth}% \\MakeFramed {\\advance\\hsize-\\width \\@totalleftmargin\\z@ \\linewidth\\hsize \\@setminipage}}% {\\par\\unskip\\endMakeFramed% \\at@end@of@kframe} \\makeatother \\newenvironment{xxx} {\\begin{kframe}} {\\end{kframe}} \\newenvironment{whisper} {\\begin{kframe}} {\\end{kframe}} æ­¤æ™‚pandoc åˆ©ç”¨ output.yml PDFæ‰æœ‰é€™å€‹è‡ªè¨‚BLOCKã€‚ æª”æ¡ˆ(output.yml)å…§å®¹: bookdown::pdf_book: includes: in_header: preamble.tex latex_engine: xelatex citation_package: natbib keep_tex: yes keep_md: yes #pandoc_args: [&quot;--lua-filter=./texclass.lua&quot;] ä¸Šé¢çš„å…§å®¹ä¸­,pandoc_args ç„¡ä½œç”¨ã€‚ æª”æ¡ˆtexclass.luaå…§å®¹ function Div(el) local kls, _ = el.classes:find_if(function (s) return string.match(s, &quot;^tex%-&quot;) end) if kls then local texkls = kls:gsub(&quot;^tex%-&quot;,&quot;&quot;,1) if texkls then return { pandoc.RawBlock(&quot;latex&quot;, &quot;\\\\begin{&quot; .. texkls .. &quot;}&quot;), el, pandoc.RawBlock(&quot;latex&quot;, &quot;\\\\end{&quot; .. texkls .. &quot;}&quot;)} end end end 14.10 è¨è«– hook Verbatim Chunks in R Markdow *HTML widgets R Notebook HTML FOrmat Render option hook example *more dynamic book 14.10.1 publish to github tutorial 14.10.2 inline code inline è®“å…§ç±¤Rç¨‹å¼ç¢¼ä¸ä½œç”¨:æ–¹æ³•æ˜¯å…©é‚Šæ‰“ä¸Š``ã€‚ä¾‹å¦‚: inline(&quot;dd&quot;) ===&gt; `` `r dd` `` cat(readr::read_file(&quot;rmd_topic_1.Rmd&quot;)) ## è¨è«– * [hook](https://github.com/lmmx/devnotes/wiki/Rmarkdown-custom-knit-hook-to-compile-a-multi-part-document) [Verbatim Chunks in R Markdow](https://rmarkdown.rstudio.com/articles_verbatim2.html) *[HTML widgets](https://github.com/rstudio/rmarkdown-book/blob/master/16-widgets.Rmd) * [R Notebook HTML FOrmat](https://rmarkdown.rstudio.com/r_notebook_format.html) * [Render option](http://brooksandrew.github.io/simpleblog/articles/render-reports-directly-from-R-scripts/) [hook example](https://selbydavid.com/2017/06/18/rmarkdown-alerts/) *[more](https://gist.github.com/yihui/2629886) [dynamic book](https://github.com/yihui/knitr-book) ### publish to github [tutorial](http://jmcglone.com/guides/github-pages/) ### inline code ```{r , include = FALSE} chunk `` `r dd` `` ``` ```{r, comment = \"\"} cat(readr::read_file(\"rmd_topic_1.Rmd\")) ``` ```{r} rst = read.csv('resources/wh.csv',comment.char=\"#\",na.string='.') write.csv(rst, file = \"MyData.csv\",row.names=FALSE, quote=F) # system(\"cat myData.csv\") # é€™å€‹ä¸è¡Œ cat(readLines('MyData.csv'), sep = '\\n') cat(readr::read_file(\"MyData.csv\")) ``` mtcas ä¸­çš„è³‡æ–™ç­†æ•¸æœ‰ `r nrow(mtcars)` rst = read.csv(&#39;resources/wh.csv&#39;,comment.char=&quot;#&quot;,na.string=&#39;.&#39;) write.csv(rst, file = &quot;MyData.csv&quot;,row.names=FALSE, quote=F) # system(&quot;cat myData.csv&quot;) # é€™å€‹ä¸è¡Œ cat(readLines(&#39;MyData.csv&#39;), sep = &#39;\\n&#39;) height,weight,sex 156,56, m 167,NA, f 189,70, m 180,NA, f cat(readr::read_file(&quot;MyData.csv&quot;)) height,weight,sex 156,56, m 167,NA, f 189,70, m 180,NA, f mtcas ä¸­çš„è³‡æ–™ç­†æ•¸æœ‰ 32 "]
]
